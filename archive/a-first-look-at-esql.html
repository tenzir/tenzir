<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-blog-archive">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">A First Look at ES|QL | Tenzir</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.tenzir.com/archive/a-first-look-at-esql"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="A First Look at ES|QL | Tenzir"><meta data-rh="true" name="description" content="Elastic just released their new pipeline query language called"><meta data-rh="true" property="og:description" content="Elastic just released their new pipeline query language called"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-08-29T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/mavam"><meta data-rh="true" property="article:tag" content="esql,elastic,tql,kusto,splunk,spl,pipelines,language"><link data-rh="true" rel="icon" href="/img/tenzir-logo-adaptive.svg"><link data-rh="true" rel="canonical" href="https://docs.tenzir.com/archive/a-first-look-at-esql"><link data-rh="true" rel="alternate" href="https://docs.tenzir.com/archive/a-first-look-at-esql" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.tenzir.com/archive/a-first-look-at-esql" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://BVB58VRBDH-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/releases/rss.xml" title="Tenzir RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/releases/atom.xml" title="Tenzir Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="Tenzir" href="/opensearch.xml">



<link rel="alternate" type="application/rss+xml" href="/archive/rss.xml" title="Tenzir RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/archive/atom.xml" title="Tenzir Atom Feed">

<script src="https://plausible.io/js/script.js" aysnc defer="defer" data-domain="docs.tenzir.com"></script><link rel="stylesheet" href="/assets/css/styles.8411515e.css">
<link rel="preload" href="/assets/js/runtime~main.1d9f27ee.js" as="script">
<link rel="preload" href="/assets/js/main.050b0d29.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://tenzir.com" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/tenzir-black.svg" alt="Tenzir" class="themedImage_ToTc themedImage--light_HNdA" width="120"><img src="/img/tenzir-white.svg" alt="Tenzir" class="themedImage_ToTc themedImage--dark_i4oU" width="120"></div></a><a class="navbar__item navbar__link" href="/overview">Docs</a><a class="navbar__item navbar__link" href="/releases">Releases</a><a class="navbar__item navbar__link" href="/changelog">Changelog</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link header-discord-link" aria-label="Discord" href="/discord"></a><a href="https://github.com/tenzir/tenzir" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/overview">v4.32</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/next/overview">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/overview">v4.32</a></li><li><a class="dropdown__link" href="/v4.31/overview">v4.31</a></li><li><a class="dropdown__link" href="/v4.30/overview">v4.30</a></li></ul></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Blog Archive</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/tenzir-platform-is-now-generally-available">Tenzir Platform is Now Generally Available</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/an-interns-reflection">An Intern&#x27;s Reflection</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/reduce-cost-and-noise-with-deduplication">Reduce Cost and Noise with Deduplication</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/introducing-office-hours">Introducing Office Hours</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/switching-fluentbit-from-json-to-msgpack">Switching Fluent Bit from JSON to MsgPack</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/contextualization-made-simple">Contextualization Made Simple</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/enrichment-complexity-in-the-wild">Enrichment Complexity in the Wild</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/matching-yara-rules-in-byte-pipelines">Matching YARA Rules in Byte Pipelines</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/integrating-velociraptor-into-tenzir-pipelines">Integrating Velociraptor into Tenzir Pipelines</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/five-design-principles-for-building-a-data-pipeline-engine">Five Design Principles for Building a Data Pipeline Engine</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/we-need-to-talk-about-the-cost-of-security-operations-infrastructure">We Need to Talk About the Cost of Security Operations Infrastructure</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/archive/a-first-look-at-esql">A First Look at ES|QL</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/slash-your-siem-cloud-and-data-costs-with-tenzir-security-data-pipelines">Slash Your SIEM, Cloud, and Data Costs with Tenzir Security Data Pipelines</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/introducing-tenzir-security-data-pipelines">Introducing Tenzir Security Data Pipelines</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/tenzir-for-splunk-users">Tenzir for Splunk Users</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/native-zeek-log-rotation-and-shipping">Native Zeek Log Rotation &amp; Shipping</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/shell-yeah-supercharging-zeek-and-suricata-with-tenzir">Shell Yeah! Supercharging Zeek and Suricata with Tenzir</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/zeek-and-ye-shall-pipe">Zeek and Ye Shall Pipe</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/mobilizing-zeek-logs">Mobilizing Zeek Logs</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/migrating-from-vast-to-tenzir">Migrating from VAST to Tenzir</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/vast-to-tenzir">Visibility Across Space and Time is now Tenzir</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/from-slack-to-discord">From Slack to Discord</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/the-new-rest-api">The New REST API</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/parquet-and-feather-data-engineering-woes">Parquet &amp; Feather: Data Engineering Woes</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/parquet-and-feather-writing-security-telemetry">Parquet &amp; Feather: Writing Security Telemetry</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/parquet-and-feather-enabling-open-investigations">Parquet &amp; Feather: Enabling Open Investigations</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/a-git-retrospective">A Git Retrospective</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/richer-typing-in-sigma">Richer Typing in Sigma</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archive/apache-arrow-as-platform-for-security-data-engineering">Apache Arrow as Platform for Security Data Engineering</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">A First Look at ES|QL</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-08-29T00:00:00.000Z" itemprop="datePublished">August 29, 2023</time> · <!-- -->8 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/mavam" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/mavam.png" alt="Matthias Vallentin"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/mavam" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Matthias Vallentin</span></a></div><small class="avatar__subtitle" itemprop="description">Founder &amp; CEO</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Elastic <a href="https://www.elastic.co/blog/elasticsearch-query-language-esql" target="_blank" rel="noopener noreferrer">just released</a> their new pipeline query language called
<strong>ES|QL</strong>. This is a conscious attempt to consolidate the language zoo in the
Elastic ecosystem
(<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl.html" target="_blank" rel="noopener noreferrer">queryDSL</a>,
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/eql.html" target="_blank" rel="noopener noreferrer">EQL</a>,
<a href="https://www.elastic.co/guide/en/kibana/current/kuery-query.html" target="_blank" rel="noopener noreferrer">KQL</a>,
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/xpack-sql.html" target="_blank" rel="noopener noreferrer">SQL</a>,
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-scripting-painless.html" target="_blank" rel="noopener noreferrer">Painless</a>,
<a href="https://www.elastic.co/guide/en/kibana/current/timelion.html" target="_blank" rel="noopener noreferrer">Canvas/Timelion</a>).
Elastic said that they worked on this effort for over a year. The
<a href="https://esql-latest.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql.html" target="_blank" rel="noopener noreferrer">documentation</a> is still sparse, but we still tried to read between
the lines to understand what this new pipeline language has to offer.</p><p></p><figure class="markdown-inline-svg">
  <svg viewBox="0 0 782.47 334.465" role="img" aria-hidden="true">eyJ2ZXJzaW9uIjoiMSIsImVuY29kaW5nIjoiYnN0cmluZyIsImNvbXByZXNzZWQiOnRydWUsImVuY29kZWQiOiJ4nO1aW3PayFx1MDAxMn73r3Cxr4ky98u+2WBcdTAwMWLbiSGBdVx1MDAxY5/acslCgIyQiCQwTjb//bRkXHUwMDFiXHRxMWAgbDZylVx1MDAwYvXMqEc9/c3X3aPve/v7heihZ1x1MDAxN/7cL9hDy3SdRmDeXHUwMDE33sTygVx1MDAxZISO70FcdTAwMTNJ7kO/XHUwMDFmWEnPdlx1MDAxNPXCP9+9M3s9I1x1MDAxZGVYfvdxpO3aXduLQuj7P7jf3/+e/M/oiuxhlPRNpKkmTfPCXHUwMDBi30uUaqU5XCKEsVFcdTAwMDcnLIGiyG5Aa9N0QzttiUVcdTAwMDXr+KRuuWU0aJ66XHUwMDE3XHUwMDAzt2Kx/nE9Vdp0XFy3XHUwMDE2PbiPb2Ra7X5gp61hXHUwMDE0+Fx1MDAxZPuz04jaz1x1MDAwNsjIR+NcdTAwMWFm2IZcdIyaXHUwMDAzv99qe3ZcdTAwMTi/Olx1MDAxYUn9nmk50Vx1MDAwM8gwSqWm10pcdTAwMWWSSoaxKpXexyOIQDnlRd/1g1j5XHUwMDFm2I7/Uu23ptVpwVx1MDAxNLzGqE9cdTAwMTSYXtgzXHUwMDAzWI603/3Ta2GiXGastVZYKM04xel7tm2n1Y6SPjzVbyfGxlx1MDAxNFx1MDAwYiQ5yqxFrLV32khW/O/UxIHZtU/jIV7fdbNG8lx1MDAxYU9GXHUwMDFha7iNXHUwMDFijjLOkz6q32uYj0uNhSZcdTAwMTJRmLFcImLU7jpeJ/8417c6U7yj6XtRzflm55YjXHUwMDE2XHUwMDFmm13HTdZpJE48XHUwMDE1XGZ5VCuMyVx1MDAwZVxcp+Ulblx1MDAwNpO1gzFnjlx1MDAxY8DEqEPk99JWXHUwMDBitJiOZ1x1MDAwN5Nm8Vx1MDAwM6fleKZbn6JcdTAwMTFezy6PlsTIrMmtXHUwMDE52nEryJVKhD/eLIc5jFhe+lxmOszBylJQpVx1MDAxNkbdgV+6e7Bub0rlsONdXHUwMDBlr6tHXHUwMDFl/2vnUccyXHUwMDE2fVx0dU3aoFS+XHUwMDAydcKQMeik1ERcdTAwMGIlU83zQKc0YohKlq7Er4+5f7Zccrl/toQ4jPPSZ8RcdTAwMTHwXGYtuEx9/yXAXHJvmpVuUK25Z6dnJ5Wreuns5sHbfcCJLdJcdTAwMWNFXHUwMDA2je1KlVx1MDAxNkwxmmJoLuJgY1Tw91x1MDAxZlx1MDAwMtzH99tGXFxW4yYhx1x1MDAxNclLnyHHJIJ4hpHUSi9BLrgptVx1MDAwNt7VtVuvfzk8872K/Ov8fOchRzUxXHUwMDE0QVx1MDAxNOe4XHUwMDBlXHUwMDBiXHUwMDAyUSBmSGQxsPZQU1x1MDAxYVx1MDAxNHNNKSGSU41Sr1x1MDAxZWGQTkBQaEklxPybxuBY41x1MDAwNFxupaaYyVeikKgx6Vx1MDAxY1x1MDAxMH7t28FDqbZ1KE7qXVxikIRPXHUwMDA15CNSbFLu4MrFfcnpXGbDoFY+Lt5XrzMv9oTa5FHj/MCEQVx1MDAwNSUq761cdTAwMDQjQyDOxlx1MDAwMqeRl3GDTounODVYzsEnMZJ3ectusIY51+X/UELZWqxcdTAwMTn6oVx1MDAwZlx09XTkp94yXHUwMDFk+euBx3Oeh1x0ZN1Eion8IDYp53lpmjVgyCUpWyhXX1x1MDAwZYqKUIVI1kFcdTAwMTeFYs93slx1MDAxNYn4Sn/tp26Q3Ix+//1mau+3445cdTAwMTZfqYulg/dyXHUwMDBmKbhmXHUwMDE4XHUwMDE1/W7XieCtqvGMJkxcdTAwMWaZQXToeFxyx2vl22yvMaMlXHUwMDE5dVx1MDAxMFx1MDAwNP592zYn1lx1MDAxOcbl21biUKZnh62YMy6RWIJDrft+0VKVO8SPdPfzYfeudfx+5zlcdTAwMTQjWHhcdTAwMDGeiFx1MDAxOcRcZpiLVHfyXHUwMDAwzVxygSXO7k3rZlJcdTAwMGUzUFRLgoWckT5OXHUwMDEyKYXwhinyU5NHLVx1MDAwNU2tuWlcdTAwMTY92n4se7R0MDuXO6lt0Wt57jlhr1x1MDAxMn267pBvXHUwMDE1dbFcYndiKVxyjuJcdTAwMTgrz51EXHUwMDE4XGJSXG5Gp3CnUFx1MDAwNlZcdTAwMTRcIrRpXHUwMDFlXHUwMDA1bEykpGNcdTAwMDN/M+jLXGbKXHUwMDE1JVpcYqGy3va0nVIp89JRsVx1MDAxYkJlMMz6+Vx1MDAxMzYurFdKKNfKn1N8Lb4yXvbLkiiXM484sFx1MDAwNMBSwtHi1Valq93B1zNyUVx1MDAxYVx1MDAwNiX7pIPOW+Xdr7ZCUmdQKjiVwKdaZCpcdTAwMWPJLoWYoaTAYFx1MDAwN1xuQWRmy187lVJDSJhcdTAwMDCjPJdQzKFSSJWFQlx1MDAxY22cTF9AMoH4I53Cpun0fPt0er4uOp3OlCkkRcZh85DUVDPYM8nix45XzauK2S5eXt1/lYHfZe/PO3rdx46v4LdcdTAwMTmIJNRQXHUwMDFjgkQhVVx1MDAxY6nlwlx1MDAwNmhEYFxuXHUwMDAyiJxcdTAwMGLIVVxif5S7Y8j4lVx1MDAxOFx1MDAwZp7TXGaeXHUwMDE5SKpph5Fac1wiXHT6ySWi2E1WyktX46pcdTAwMDU5cFx1MDAxOTbbXGbTv522rPE1WtBJpl+JVyGymVxyYqJcdMdULFx1MDAwZeJq66J0eV1cdTAwMWOSPmuV7mr9ty3ywdp5Xlx1MDAwNZBcdTAwMWFcdTAwMDBcdTAwMDZIszhcdTAwMDfjXG49XHUwMDA2Y4aRXHUwMDAxXHUwMDExXHUwMDA2iPlcdTAwMGIwXlx1MDAwM69yXHUwMDFh86pcdTAwMTY8qTgvwqtcdTAwMDQ4lWKcPVx1MDAxONp+klxuwSfW22PV2vZZtbYtVlV85olcdTAwMGLmYGai9OKHnGUzOij2qWX1blx1MDAxYlx1MDAxZtmJqLTfftQ7T6pSXHUwMDE5iFx1MDAxMCw5p1x1MDAxM6TKKDa0ppRCkLtBUoVMi6tcdTAwMTlJPbRcdTAwMTGMxtpGpCpcdTAwMTiXXHUwMDA0QoGfiEVcdTAwMTVXrFYqXHUwMDE4/fKcOrmqiTxd0LWR6sxcdTAwMTJcdTAwMDWmSCCl1Fx1MDAxMiXfIa87d2bXPGhcckW9XHUwMDExfji58b+1d55UNTFiS1x1MDAwM1x1MDAxYZTCWUQkKCbCIFx1MDAxNI0nj2s/O0XaYFJrXHUwMDA2oS6Oq8tTvl+YUvJVSFx1MDAxMMLXXtpaMjCWXHUwMDE4Z06KNk2oVWBBN570lll1Uu/r67+HzeZcdTAwMTeOjztccvNrp1o+6J+5qExcdTAwMTep/0I6ZPCJY34qRD6FenYwxWHfYONl4TTzgvidMDKWlv0u/b5Y+qVcdTAwMWEx2Fx1MDAxOaTIOttzwYHNKTgwSjSimVwi7dpqvytDcb3sNcXb4ivjZ5PstSxJ72jxXHUwMDE3vG3myiuuXHUwMDE44XSJL/9Is1x1MDAxZDjBhzD6cncxXGKOXHUwMDFhxc9XtrvzfEpcdTAwMTVk/lxuaSZhpbVcdTAwMTQ8x6hcZlx1MDAxYiDb4KdIXHUwMDA0x1x1MDAxYiHXmDCIzCGMSstcdTAwMDLz0lOFXHUwMDE5kCn5qdmpVlx1MDAxOKXHXHUwMDA3mybToulccszwXd3pXHUwMDAyX/netjl1pvrXU2s1uKn4g083Z43Lh9My+lx1MDAxNFxcRpgs+lnS+KF7Qq1cdTAwMTJcdTAwMTmYsXHOfXY3yPPYrO+84y/vJFx1MDAxZifl39z68rEq4kKKuOQ6ZY9VfOZcdTAwMDFcdTAwMWLFlGKNN8CtilxivdppzFq5ddLX4ivjZf9cdTAwMWVm3XuaW8Hs9WpcdTAwMTFYXHUwMDFiWlx1MDAxZlFcXFx1MDAxODj2/eFcdTAwMTSfbyZXYe9cdPWxz9uxZb//2Pvxf9J+rVx1MDAxNCJ9<defs><style>@font-face{font-family:&quot;Virgil&quot;;src:url(https://excalidraw.com/Virgil.woff2)}@font-face{font-family:&quot;Cascadia&quot;;src:url(https://excalidraw.com/Cascadia.woff2)}</style></defs><text x="64.1" fill="#1e1e1e" dominant-baseline="text-before-edge" font-family="Virgil, Segoe UI Emoji" font-size="100" style="white-space:pre" text-anchor="middle" transform="translate(197.406 107.809)">ES</text><text x="8.4" fill="#f3d337" dominant-baseline="text-before-edge" font-family="Virgil, Segoe UI Emoji" font-size="100" style="white-space:pre" text-anchor="middle" transform="translate(342.406 107.809)">|</text><text x="65.2" fill="#1e1e1e" dominant-baseline="text-before-edge" font-family="Virgil, Segoe UI Emoji" font-size="100" style="white-space:pre" text-anchor="middle" transform="translate(377.406 107.809)">QL</text><text x="63.658" fill="#1e1e1e" dominant-baseline="text-before-edge" font-family="Virgil, Segoe UI Emoji" font-size="28" style="white-space:pre" text-anchor="middle" transform="translate(310.227 10)">queryDSL</text><path fill="none" stroke="#ced4da" strokeLineCap="round" stroke-width="2" d="M364.19 56.574c-7.37 19.03-9.85 35.32-17.74 54.51m18.2-52.05c-6.17 14.52-9.75 31.65-15.99 53.73"></path><text x="27.692" fill="#1e1e1e" dominant-baseline="text-before-edge" font-family="Virgil, Segoe UI Emoji" font-size="28" style="white-space:pre" text-anchor="middle" transform="translate(22.769 43.426)">EQL</text><path fill="none" stroke="#ced4da" strokeLineCap="round" stroke-width="2" d="M93.28 75.818c16.84 10.92 37.11 19.79 68.42 44.09m-66.66-45.1c14.44 10.48 30.33 20.54 69.03 46.28"></path><text x="26.838" fill="#1e1e1e" dominant-baseline="text-before-edge" font-family="Virgil, Segoe UI Emoji" font-size="28" style="white-space:pre" text-anchor="middle" transform="translate(654.743 52.685)">KQL</text><path fill="none" stroke="#ced4da" strokeLineCap="round" stroke-width="2" d="M642.07 72.6c-46.61 19.73-93.6 43.43-118.12 52.92M642.1 71.24c-33.36 14.58-65.72 29.83-116.89 53.79"></path><text x="26.768" fill="#1e1e1e" dominant-baseline="text-before-edge" font-family="Virgil, Segoe UI Emoji" font-size="28" style="white-space:pre" text-anchor="middle" transform="translate(718.934 258.571)">SQL</text><path fill="none" stroke="#ced4da" strokeLineCap="round" stroke-width="2" d="M696.108 281.482c-51.51-23.56-105.91-44.2-168.24-69.22m167.44 68.12c-54.34-23.03-108.24-46.68-169.46-68.47"></path><text x="54.74" fill="#1e1e1e" dominant-baseline="text-before-edge" font-family="Virgil, Segoe UI Emoji" font-size="28" style="white-space:pre" text-anchor="middle" transform="translate(10 274.04)">Painless</text><path fill="none" stroke="#ced4da" strokeLineCap="round" stroke-width="2" d="M188.137 212.677c-32.5 22.28-63.67 46.39-84.31 57.22m86.63-56.2c-24.65 15.1-51.15 33.26-84.91 56.45"></path><text x="108.038" fill="#1e1e1e" dominant-baseline="text-before-edge" font-family="Virgil, Segoe UI Emoji" font-size="28" style="white-space:pre" text-anchor="middle" transform="translate(301.487 289.465)">Canvas/Timelion</text><path fill="none" stroke="#ced4da" strokeLineCap="round" stroke-width="2" d="M365.005 218.663c10.41 23.66 21.71 45.94 28.82 62.82m-28.76-64.02c10.45 21.75 21.06 45.51 30.05 62.09"></path></svg></figure><p></p><p>The reason why we are excited about this announcement is because we have <em>also</em>
designed and implemented a pipeline language over the past 8 months that we just
<a href="/archive/introducing-tenzir-security-data-pipelines">launched at BlackHat</a>. First,
we see the release of ES|QL as a confirmation for pipeline model. In our <a href="/archive/tenzir-for-splunk-users">blog
post about Splunk&#x27;s Search Processing Language
(SPL)</a>, we briefly mentioned why SQL might not be
the best choice for analysts, and why thinking about one operator at a time
provides an easier user experience. Second, we&#x27;d like to look under the hood of
ES|QL to compare and reflect on our own Tenzir Query Language (TQL).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="walk-through-by-example">Walk-through by Example<a href="#walk-through-by-example" class="hash-link" aria-label="Direct link to Walk-through by Example" title="Direct link to Walk-through by Example">​</a></h2><p>So, ES|QL, how does it feel?</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  FROM employees</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| EVAL hired_year = TO_INTEGER(DATE_FORMAT(hire_date, &quot;YYYY&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| WHERE hired_year &gt; 1984</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| STATS avg_salary = AVG(salary) BY languages</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| EVAL avg_salary = ROUND(avg_salary)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| EVAL lang_code = TO_STRING(languages)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| ENRICH languages_policy ON lang_code WITH lang = language_name</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| WHERE NOT IS_NULL(lang)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| KEEP avg_salary, lang</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| SORT avg_salary ASC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| LIMIT 3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This syntax reads very straight-forward. Splunk users will immediately grasp
what it does, as there is a remarkable similarity in operator naming. Let&#x27;s go
through each pipeline operator individually:</p><ul><li><a href="https://esql-latest.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-from.html" target="_blank" rel="noopener noreferrer"><code>FROM</code></a> generates a table with up to 10k rows from a data stream,
index, or alias. We asked ourselves why there is a hard-baked 10k limit?
Shouldn&#x27;t that be the job of <a href="https://esql-latest.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-limit.html" target="_blank" rel="noopener noreferrer"><code>LIMIT</code></a>? The limit feels a
technical limitation rather than a conscious design decision. In TQL, we have
unbounded streams but also follow the single responsibility principle: one
operator has exactly one job.</li><li><a href="https://esql-latest.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-eval.html" target="_blank" rel="noopener noreferrer"><code>EVAL</code></a> appends new or replaces existing columns. We named this
operator <code>extend</code> because we found the
Splunk-inspired command name &quot;eval&quot; too generic for this use case.<sup id="fnref-1-6c378c"><a href="#fn-1-6c378c" class="footnote-ref">1</a></sup></li><li><a href="https://esql-latest.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-where.html" target="_blank" rel="noopener noreferrer"><code>WHERE</code></a> filters the input with an expression. We have the same
<code>where</code> in TQL.</li><li><a href="https://esql-latest.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-stats-by.html" target="_blank" rel="noopener noreferrer"><code>STATS</code></a> groups its input via <code>BY</code> and applies aggregation
functions on select fields of each group.  Elastic went with Splunk
nomenclature for this central operation, perhaps also to make the transition
from Splunk to Elastic as easy as possible.</li><li><a href="https://esql-latest.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-enrich.html" target="_blank" rel="noopener noreferrer"><code>ENRICH</code></a> adds data from existing indexes. It&#x27;s effectively a
join operation, and the <code>ON</code> keywords makes it possible to select the join
field. Interestingly, the word &quot;join&quot; doesn&#x27;t appear on the documentation. We
hypothesize that this was a conscious choice, as a database join may feel
intimidating for beginning and intermediate users.</li><li><a href="https://esql-latest.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-keep.html" target="_blank" rel="noopener noreferrer"><code>KEEP</code></a> selects a set of columns from the input and drops all
others. It is the inverse of <a href="https://esql-latest.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-drop.html" target="_blank" rel="noopener noreferrer"><code>DROP</code></a>. In TQL, we call these
projection operators <code>select</code> and also <code>drop</code>.</li><li><a href="https://esql-latest.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-sort.html" target="_blank" rel="noopener noreferrer"><code>SORT</code></a>
sorts rows by one or more fields. <code>SORT height DESC, first_name ASC</code> sorts the
field <code>height</code> in descending order and the field <code>first_name</code> in ascending
order. The syntax of our <code>sort</code> is identical.
Controlling the position of null values works with <code>NULLS FIRST</code> and <code>NULLS
LAST</code>. In TQL, we went Kusto-like with <code>nulls-first</code> and <code>nulls-last</code>.</li><li><a href="https://esql-latest.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-limit.html" target="_blank" rel="noopener noreferrer"><code>LIMIT</code></a> restricts the number of output rows. In TQL, we have
<code>head</code> and <code>tail</code> for this purpose.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sources-transformations--but-sinks">Sources, Transformations, ... but Sinks?<a href="#sources-transformations--but-sinks" class="hash-link" aria-label="Direct link to Sources, Transformations, ... but Sinks?" title="Direct link to Sources, Transformations, ... but Sinks?">​</a></h2><p>ES|QL differentiates two types of commands (which we call <em>operators</em> in TQL):</p><ol><li><a href="https://esql-latest.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-source-commands.html" target="_blank" rel="noopener noreferrer">Source commands</a></li><li><a href="https://esql-latest.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-processing-commands.html" target="_blank" rel="noopener noreferrer">Processing commands</a></li></ol><p>In TQL, an operator is a <em>source</em>, a <em>transformation</em>, or a <em>sink</em>. Some
operators can be of multiple categories, like <code>shell</code>.</p><p>Maybe this is still coming, but ES|QL doesn&#x27;t appear to offer sinks. We
hypothesize that users should consume pipeline output uniformly as JSON through
a REST API.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="syntax">Syntax<a href="#syntax" class="hash-link" aria-label="Direct link to Syntax" title="Direct link to Syntax">​</a></h2><p>Syntactically, the <a href="https://esql-latest.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-syntax.html" target="_blank" rel="noopener noreferrer">ES|QL language</a> is similar to TQL. The
following points stood out:</p><ul><li>The <code>|</code> (pipe) symbol separates commands that describe the dataflow.</li><li>Comments work as in C++: <code>//</code> for single line and <code>/*</code> and <code>*/</code> for multi-line
comments.</li><li>Expressions can occur in <code>WHERE</code>, <code>STATS</code>, and other commands. The following
relational operators exist:<ul><li>Arithmetic comparisons via <code>&lt;</code>, <code>&lt;=</code>, <code>==</code>, <code>&gt;=</code>, <code>&gt;</code></li><li>Set membership via <code>IN</code></li><li>Glob-like wildcard search via <code>LIKE</code></li><li>Regular expressions via <code>RLIKE</code></li></ul></li><li>Date-time literals make it easier to express dates (<code>seconds</code>, <code>hours</code>, etc.)
and timespans (e.g., <code>1 day</code>). We found that expressing numeric values across
multiple orders of magnitude is common, e.g., when dealing with GBs. This is
why we also offer SI literals in TQL, allowing you to write large numbers as
<code>1 Mi</code> or <code>1 M</code>.</li><li>ES|QL features multiple scalar <a href="https://esql-latest.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-functions.html" target="_blank" rel="noopener noreferrer">functions</a>.
that perform value-to-value transformations. Functions can occur in <code>ROW</code>,
<code>EVAL</code>, and <code>WHERE</code>.</li><li>Similarly, <a href="https://esql-latest.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-agg-functions.html" target="_blank" rel="noopener noreferrer">aggregation functions</a> perform a vector-to-scalar
transformation per group in <code>STATS</code>.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="engine">Engine<a href="#engine" class="hash-link" aria-label="Direct link to Engine" title="Direct link to Engine">​</a></h2><p>ES|QL comes with its own executor, i.e., it&#x27;s not transpiled into any of the
existing engines. A running pipelines is a <em>task</em> and there exists an
<a href="https://esql-latest.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-task-management.html" target="_blank" rel="noopener noreferrer">API</a> for querying their state, which may return something like:</p><figure data-rehype-pretty-code-figure=""><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span data-line=""><span style="color:#E6EDF3">{</span></span>
<span data-line=""><span style="color:#7EE787">  &quot;node&quot;</span><span style="color:#E6EDF3"> : </span><span style="color:#A5D6FF">&quot;2j8UKw1bRO283PMwDugNNg&quot;</span><span style="color:#E6EDF3">,</span></span>
<span data-line=""><span style="color:#7EE787">  &quot;id&quot;</span><span style="color:#E6EDF3"> : </span><span style="color:#79C0FF">5326</span><span style="color:#E6EDF3">,</span></span>
<span data-line=""><span style="color:#7EE787">  &quot;type&quot;</span><span style="color:#E6EDF3"> : </span><span style="color:#A5D6FF">&quot;transport&quot;</span><span style="color:#E6EDF3">,</span></span>
<span data-line=""><span style="color:#7EE787">  &quot;action&quot;</span><span style="color:#E6EDF3"> : </span><span style="color:#A5D6FF">&quot;indices:data/read/esql&quot;</span><span style="color:#E6EDF3">,</span></span>
<span data-line=""><span style="color:#7EE787">  &quot;description&quot;</span><span style="color:#E6EDF3"> : </span><span style="color:#A5D6FF">&quot;FROM test | STATS MAX(d) by a, b&quot;</span><span style="color:#E6EDF3">,</span></span>
<span data-line=""><span style="color:#7EE787">  &quot;start_time&quot;</span><span style="color:#E6EDF3"> : </span><span style="color:#A5D6FF">&quot;2023-07-31T15:46:32.328Z&quot;</span><span style="color:#E6EDF3">,</span></span>
<span data-line=""><span style="color:#7EE787">  &quot;start_time_in_millis&quot;</span><span style="color:#E6EDF3"> : </span><span style="color:#79C0FF">1690818392328</span><span style="color:#E6EDF3">,</span></span>
<span data-line=""><span style="color:#7EE787">  &quot;running_time&quot;</span><span style="color:#E6EDF3"> : </span><span style="color:#A5D6FF">&quot;41.7ms&quot;</span><span style="color:#E6EDF3">,</span></span>
<span data-line=""><span style="color:#7EE787">  &quot;running_time_in_nanos&quot;</span><span style="color:#E6EDF3"> : </span><span style="color:#79C0FF">41770830</span><span style="color:#E6EDF3">,</span></span>
<span data-line=""><span style="color:#7EE787">  &quot;cancellable&quot;</span><span style="color:#E6EDF3"> : </span><span style="color:#79C0FF">true</span><span style="color:#E6EDF3">,</span></span>
<span data-line=""><span style="color:#7EE787">  &quot;cancelled&quot;</span><span style="color:#E6EDF3"> : </span><span style="color:#79C0FF">false</span><span style="color:#E6EDF3">,</span></span>
<span data-line=""><span style="color:#7EE787">  &quot;headers&quot;</span><span style="color:#E6EDF3"> : { }</span></span>
<span data-line=""><span style="color:#E6EDF3">}</span></span></code></pre><button type="button" data="{
  &quot;node&quot; : &quot;2j8UKw1bRO283PMwDugNNg&quot;,
  &quot;id&quot; : 5326,
  &quot;type&quot; : &quot;transport&quot;,
  &quot;action&quot; : &quot;indices:data/read/esql&quot;,
  &quot;description&quot; : &quot;FROM test | STATS MAX(d) by a, b&quot;,
  &quot;start_time&quot; : &quot;2023-07-31T15:46:32.328Z&quot;,
  &quot;start_time_in_millis&quot; : 1690818392328,
  &quot;running_time&quot; : &quot;41.7ms&quot;,
  &quot;running_time_in_nanos&quot; : 41770830,
  &quot;cancellable&quot; : true,
  &quot;cancelled&quot; : false,
  &quot;headers&quot; : { }
}" title="Copy code" aria-label="Copy code" class="rehype-pretty-copy" data-feedback-duration="3000" data-name="rehype-pretty-copy-button"><span class="ready"></span><span class="success"></span></button><style>
    :root {
      --copy-icon: url(&quot;data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgdmlld0JveD0iMCAwIDM2IDM2Ij48cmVjdCB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIGZpbGw9Im5vbmUiLz48cGF0aCBmaWxsPSIjYmZjN2Q1IiBkPSJNMjkuNSA3aC0xOUExLjUgMS41IDAgMCAwIDkgOC41djI0YTEuNSAxLjUgMCAwIDAgMS41IDEuNWgxOWExLjUgMS41IDAgMCAwIDEuNS0xLjV2LTI0QTEuNSAxLjUgMCAwIDAgMjkuNSA3TTI5IDMySDExVjloMThaIiBjbGFzcz0iY2xyLWktb3V0bGluZSBjbHItaS1vdXRsaW5lLXBhdGgtMSIvPjxwYXRoIGZpbGw9IiNiZmM3ZDUiIGQ9Ik0yNiAzLjVBMS41IDEuNSAwIDAgMCAyNC41IDJoLTE5QTEuNSAxLjUgMCAwIDAgNCAzLjV2MjRBMS41IDEuNSAwIDAgMCA1LjUgMjlINlY0aDIwWiIgY2xhc3M9ImNsci1pLW91dGxpbmUgY2xyLWktb3V0bGluZS1wYXRoLTIiLz48cGF0aCBmaWxsPSJub25lIiBkPSJNMCAwaDM2djM2SDB6Ii8+PC9zdmc+&quot;);
      --success-icon: url(&quot;data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cmVjdCB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIGZpbGw9Im5vbmUiLz48cGF0aCBmaWxsPSIjMDBkNjAwIiBkPSJNMjEgN0w5IDE5bC01LjUtNS41bDEuNDEtMS40MUw5IDE2LjE3TDE5LjU5IDUuNTl6Ii8+PC9zdmc+&quot;);
    }

    pre:has(code) {
      position: relative;
    }

    button[data=&#x27;&lt;span&gt;&#x27;] {
      width: 0;
      height: 0;
      display: none;
      visibility: hidden;
    }

    pre button.rehype-pretty-copy {
      top: 1px;
      right: 1px;
      padding: 0;
      width: 24px;
      height: 24px;
      display: flex;
      cursor: pointer;
      margin-top: 8px;
      margin-right: 8px;
      position: absolute;
      border-radius: 25%;
      &amp; span {
        width: 100%;
        aspect-ratio: 1 / 1;
        background-repeat: no-repeat;
      }
      &amp; .ready {
        background-image: var(--copy-icon);
      }
      &amp; .success {
        display: none;
        background-image: var(--success-icon);
      }
    }

    &amp;.rehype-pretty-copied { 
      &amp; .success { 
        display: block;
      } &amp; .ready {
        display: none;
      }
    }

    pre button.rehype-pretty-copy.rehype-pretty-copied {
      opacity: 1;
      cursor: default;
      &amp; .ready { display: none; }
      &amp; .success { display: block; }
    }

      pre button.rehype-pretty-copy { opacity: 0; }
      button[data-name=&quot;rehype-pretty-copy-button&quot;]:hover {
        opacity: 1;
      }
    </style></code></pre></figure><h2 class="anchor anchorWithStickyNavbar_LWe7" id="data-model">Data Model<a href="#data-model" class="hash-link" aria-label="Direct link to Data Model" title="Direct link to Data Model">​</a></h2><p>The concept of <a href="https://esql-latest.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/esql-multivalued-fields.html" target="_blank" rel="noopener noreferrer">multi-valued fields</a> exists to bridge the world
between JSON records and 2D tables. This shows the heritage of the type system,
which evolved from document stores as opposed to structured data stores. In
document land, every record may have a different shape (or schema). The term
<em>multi-valued</em> effectively means <em>list</em>, e.g., <code>[1, 2, 3]</code>.</p><p>Noteworthy:</p><ul><li>The order of multi-valued fields is undefined.</li><li>It&#x27;s possible to impose set semantics by using the <code>keyword</code> type. Specifying
this type causes duplicate removal on ingest.</li><li>Other types, like <code>long</code>, do not cause removal of duplicates on ingest.</li></ul><p>The output is still semi-structured in that listness is something dynamic on a
per-value basis. Consider this output:</p><figure data-rehype-pretty-code-figure=""><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span data-line=""><span style="color:#E6EDF3">{</span></span>
<span data-line=""><span style="color:#7EE787">  &quot;columns&quot;</span><span style="color:#E6EDF3">: [</span></span>
<span data-line=""><span style="color:#E6EDF3">    { </span><span style="color:#7EE787">&quot;name&quot;</span><span style="color:#E6EDF3">: </span><span style="color:#A5D6FF">&quot;a&quot;</span><span style="color:#E6EDF3">, </span><span style="color:#7EE787">&quot;type&quot;</span><span style="color:#E6EDF3">: </span><span style="color:#A5D6FF">&quot;long&quot;</span><span style="color:#E6EDF3">},</span></span>
<span data-line=""><span style="color:#E6EDF3">    { </span><span style="color:#7EE787">&quot;name&quot;</span><span style="color:#E6EDF3">: </span><span style="color:#A5D6FF">&quot;b&quot;</span><span style="color:#E6EDF3">, </span><span style="color:#7EE787">&quot;type&quot;</span><span style="color:#E6EDF3">: </span><span style="color:#A5D6FF">&quot;long&quot;</span><span style="color:#E6EDF3">}</span></span>
<span data-line=""><span style="color:#E6EDF3">  ],</span></span>
<span data-line=""><span style="color:#7EE787">  &quot;values&quot;</span><span style="color:#E6EDF3">: [</span></span>
<span data-line=""><span style="color:#E6EDF3">    [</span><span style="color:#79C0FF">1</span><span style="color:#E6EDF3">, [</span><span style="color:#79C0FF">1</span><span style="color:#E6EDF3">, </span><span style="color:#79C0FF">2</span><span style="color:#E6EDF3">]],</span></span>
<span data-line=""><span style="color:#E6EDF3">    [</span><span style="color:#79C0FF">2</span><span style="color:#E6EDF3">,      </span><span style="color:#79C0FF">3</span><span style="color:#E6EDF3">]</span></span>
<span data-line=""><span style="color:#E6EDF3">  ]</span></span>
<span data-line=""><span style="color:#E6EDF3">}</span></span></code></pre><button type="button" data="{
  &quot;columns&quot;: [
    { &quot;name&quot;: &quot;a&quot;, &quot;type&quot;: &quot;long&quot;},
    { &quot;name&quot;: &quot;b&quot;, &quot;type&quot;: &quot;long&quot;}
  ],
  &quot;values&quot;: [
    [1, [1, 2]],
    [2,      3]
  ]
}" title="Copy code" aria-label="Copy code" class="rehype-pretty-copy" data-feedback-duration="3000" data-name="rehype-pretty-copy-button"><span class="ready"></span><span class="success"></span></button><style>
    :root {
      --copy-icon: url(&quot;data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgdmlld0JveD0iMCAwIDM2IDM2Ij48cmVjdCB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIGZpbGw9Im5vbmUiLz48cGF0aCBmaWxsPSIjYmZjN2Q1IiBkPSJNMjkuNSA3aC0xOUExLjUgMS41IDAgMCAwIDkgOC41djI0YTEuNSAxLjUgMCAwIDAgMS41IDEuNWgxOWExLjUgMS41IDAgMCAwIDEuNS0xLjV2LTI0QTEuNSAxLjUgMCAwIDAgMjkuNSA3TTI5IDMySDExVjloMThaIiBjbGFzcz0iY2xyLWktb3V0bGluZSBjbHItaS1vdXRsaW5lLXBhdGgtMSIvPjxwYXRoIGZpbGw9IiNiZmM3ZDUiIGQ9Ik0yNiAzLjVBMS41IDEuNSAwIDAgMCAyNC41IDJoLTE5QTEuNSAxLjUgMCAwIDAgNCAzLjV2MjRBMS41IDEuNSAwIDAgMCA1LjUgMjlINlY0aDIwWiIgY2xhc3M9ImNsci1pLW91dGxpbmUgY2xyLWktb3V0bGluZS1wYXRoLTIiLz48cGF0aCBmaWxsPSJub25lIiBkPSJNMCAwaDM2djM2SDB6Ii8+PC9zdmc+&quot;);
      --success-icon: url(&quot;data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cmVjdCB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIGZpbGw9Im5vbmUiLz48cGF0aCBmaWxsPSIjMDBkNjAwIiBkPSJNMjEgN0w5IDE5bC01LjUtNS41bDEuNDEtMS40MUw5IDE2LjE3TDE5LjU5IDUuNTl6Ii8+PC9zdmc+&quot;);
    }

    pre:has(code) {
      position: relative;
    }

    button[data=&#x27;&lt;span&gt;&#x27;] {
      width: 0;
      height: 0;
      display: none;
      visibility: hidden;
    }

    pre button.rehype-pretty-copy {
      top: 1px;
      right: 1px;
      padding: 0;
      width: 24px;
      height: 24px;
      display: flex;
      cursor: pointer;
      margin-top: 8px;
      margin-right: 8px;
      position: absolute;
      border-radius: 25%;
      &amp; span {
        width: 100%;
        aspect-ratio: 1 / 1;
        background-repeat: no-repeat;
      }
      &amp; .ready {
        background-image: var(--copy-icon);
      }
      &amp; .success {
        display: none;
        background-image: var(--success-icon);
      }
    }

    &amp;.rehype-pretty-copied { 
      &amp; .success { 
        display: block;
      } &amp; .ready {
        display: none;
      }
    }

    pre button.rehype-pretty-copy.rehype-pretty-copied {
      opacity: 1;
      cursor: default;
      &amp; .ready { display: none; }
      &amp; .success { display: block; }
    }

      pre button.rehype-pretty-copy { opacity: 0; }
      button[data-name=&quot;rehype-pretty-copy-button&quot;]:hover {
        opacity: 1;
      }
    </style></code></pre></figure><p>The column <code>b</code> has the list value <code>[1, 2]</code> in the first row and <code>3</code> in the
second. In a strict type system (like TQL), the type of <code>b</code> could be
<code>list&lt;long&gt;</code> but then the second row would have value <code>[3]</code> instead of <code>3</code>. Sum
types (called <code>union</code> or <code>variant</code> in many languages) are another way to
represent heterogeneous data as in the above example. If we described <code>b</code> with
the type <code>union&lt;long, list&lt;long&gt;&gt;</code> instead of <code>long</code>, then it would be perfectly
fine for <code>b</code> to take one value <code>[1, 2]</code> in one row and <code>3</code> in another.</p><p>For TQL, we built our data model on top of data frames. We express structure in
terms of <em>records</em> and <em>lists</em>, and arbitrarily nested combinations of them. It
would be up the user to define set semantics that ensures unique values. We
consider adding such a set type in the future (possible as type constraint or
attribute) as we gain more complete support of the underlying Arrow type system.
Similarly, we plan on adding sum types in the future.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h2><p>The release of ES|QL witnesses a current trend of convergence in terms of query
languages. The pipeline concept now exists for several decades. Splunk was the
first company to successfully commercialize this interface with SPL, but today
there are many players in the market that have a similar language. Microsoft
open-sourced their Kusto language, and we see other vendors embedding it into
their products, such as Cribl Search. Most SIEM vendors also have their own
inhouse pipeline language.</p><p>The data ecosystem has numerous languages for advanced users to offer, such as
<a href="https://dplyr.tidyverse.org/" target="_blank" rel="noopener noreferrer">dplyr</a>, <a href="https://stedolan.github.io/jq/" target="_blank" rel="noopener noreferrer">jq</a>,
<a href="https://pandas.pydata.org/" target="_blank" rel="noopener noreferrer">pandas</a>, and <a href="https://www.pola.rs/" target="_blank" rel="noopener noreferrer">polars</a>. And
new ones are mushrooming everywhere, e.g., <a href="https://prql-lang.org/" target="_blank" rel="noopener noreferrer">PRQL</a>,
<a href="https://zed.brimdata.io/" target="_blank" rel="noopener noreferrer">Zed</a>.</p><p>With our own TQL, we seek to bridge the data and security analytics world, by
offering an intuitive language that is easy to grasp, but that internally maps
to vectorized execution on top of data frames that can be easily shared with other
runtimes.</p><p>If you want to look deeper at ES|QL, check out the branch
<a href="https://github.com/elastic/elasticsearch/tree/feature/esql/x-pack/plugin/esql" target="_blank" rel="noopener noreferrer"><code>feature/esql</code></a>. Find something interesting about pipelines to
discuss? Swing by our <a href="/discord">Discord</a> and start a conversation.</p><div class="footnotes"><hr><ol><li id="fn-1-6c378c">We took the name <code>extend</code> from Kusto. In general, we find that Kusto has
very self-descriptive operator names. During the design of TQL, we compared
many different languages and often favored Kusto&#x27;s choice of name.<a href="#fnref-1-6c378c" class="footnote-backref">↩</a></li></ol></div></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/archive/tags/esql">esql</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/archive/tags/elastic">elastic</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/archive/tags/tql">tql</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/archive/tags/kusto">kusto</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/archive/tags/splunk">splunk</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/archive/tags/spl">spl</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/archive/tags/pipelines">pipelines</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/archive/tags/language">language</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/archive/we-need-to-talk-about-the-cost-of-security-operations-infrastructure"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">We Need to Talk About the Cost of Security Operations Infrastructure</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/archive/slash-your-siem-cloud-and-data-costs-with-tenzir-security-data-pipelines"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Slash Your SIEM, Cloud, and Data Costs with Tenzir Security Data Pipelines</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#walk-through-by-example" class="table-of-contents__link toc-highlight">Walk-through by Example</a></li><li><a href="#sources-transformations--but-sinks" class="table-of-contents__link toc-highlight">Sources, Transformations, ... but Sinks?</a></li><li><a href="#syntax" class="table-of-contents__link toc-highlight">Syntax</a></li><li><a href="#engine" class="table-of-contents__link toc-highlight">Engine</a></li><li><a href="#data-model" class="table-of-contents__link toc-highlight">Data Model</a></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/api">API</a></li><li class="footer__item"><a class="footer__link-item" href="/changelog">Changelog</a></li><li class="footer__item"><a href="https://docs.google.com/presentation/d/1R59T2nuGJg43g6PVKogZbb6DjcJXRYBx3Bih8W-A-oM/present" target="_blank" rel="noopener noreferrer" class="footer__link-item">Release Slides<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/tenzir-vs-cribl">Tenzir vs. Cribl</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/discord">Discord</a></li><li class="footer__item"><a href="https://github.com/tenzir" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/tenzir_company" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/tenzir" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Tenzir</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://tenzir.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://tenzir.com/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/archive">Blog Archive</a></li><li class="footer__item"><a class="footer__link-item" href="/newsletter">Newsletter</a></li><li class="footer__item"><a class="footer__link-item" href="/privacy-statement">Privacy Statement</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Tenzir GmbH.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.1d9f27ee.js"></script>
<script src="/assets/js/main.050b0d29.js"></script>
</body>
</html>