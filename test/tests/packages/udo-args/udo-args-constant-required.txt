i test: running 1 tests (64 jobs) from root project at ./test
i   1× tenzir (v5.20.0+g59a1ea4f1b)
✘ tests/packages/udo-args/udo-args-constant-required.tql
┌─▶ got unexpected exit code 1
│ error: expected a constant expression
│  --> tests/packages/udo-args/udo-args-constant-required.tql:7:29
│   |
│ 7 | argspkg::untyped_positional this.value
│   |                             ^^^^ 
│   |
│   = note: stacktrace:
│            0# tenzir::evaluator::input_or_throw(tenzir::into_location) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:714
│            1# tenzir::evaluator::eval(tenzir::ast::this_ const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:273
│            2# std::__detail::__variant::__gen_vtable_impl<std::__detail::__variant::_Multi_array<std::__detail::__variant::__deduce_visit_result<tenzir::multi_series> (*)(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&)>, std::integer_sequence<unsigned long, 3ul> >::__visit_invoke(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&) at /nix/store/82kmz7r96navanrc2fgckh2bamiqrgsw-gcc-14.3.0/include/c++/14.3.0/variant:1060
│            3# tenzir::evaluator::eval(tenzir::ast::expression const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:702
│            4# std::__detail::__variant::__gen_vtable_impl<std::__detail::__variant::_Multi_array<std::__detail::__variant::__deduce_visit_result<tenzir::multi_series> (*)(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&)>, std::integer_sequence<unsigned long, 7ul> >::__visit_invoke(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&) at /nix/store/82kmz7r96navanrc2fgckh2bamiqrgsw-gcc-14.3.0/include/c++/14.3.0/variant:1060
│            5# tenzir::evaluator::eval(tenzir::ast::expression const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:702
│            6# tenzir::evaluator::eval(tenzir::ast::record const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:53
│            7# std::__detail::__variant::__gen_vtable_impl<std::__detail::__variant::_Multi_array<std::__detail::__variant::__deduce_visit_result<tenzir::multi_series> (*)(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&)>, std::integer_sequence<unsigned long, 0ul> >::__visit_invoke(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&) at /nix/store/82kmz7r96navanrc2fgckh2bamiqrgsw-gcc-14.3.0/include/c++/14.3.0/variant:1060
│            8# tenzir::evaluator::eval(tenzir::ast::expression const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:702
│            9# tenzir::const_eval(tenzir::ast::expression const&, tenzir::diagnostic_handler&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval.cpp:181
│           10# tenzir::plugins::from::(anonymous namespace)::from_plugin2::make(tenzir::operator_factory_plugin::invocation, tenzir::session) const at ./build/clang/relwithdebinfo/./libtenzir/builtins/operators/from_to_2.cpp:111
│           11# _ZN6tenzir6detail14match_functionIRKNS_7variantIJNS_15native_operatorENS_21user_defined_operatorEEEETkNS0_19variant_matcher_forIT_EENS0_8overloadIJZNKS_12operator_def4makeENS_23operator_factory_plugin10invocationENS_7sessionEE3$_0ZNKSB_4makeESD_SE_E3$_1EEELm0EEENS0_21variant_invoke_resultIS9_JT0_EE4typeEOS9_OSJ_ at ./libtenzir/include/tenzir/variant_traits.hpp:284
│           12# tenzir::operator_def::make(tenzir::operator_factory_plugin::invocation, tenzir::session) const at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/registry.cpp:63
│           13# tenzir::compile(tenzir::ast::pipeline&&, tenzir::session) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/exec.cpp:477
│           14# _ZN6tenzir6detail14match_functionIRKNS_7variantIJNS_15native_operatorENS_21user_defined_operatorEEEETkNS0_19variant_matcher_forIT_EENS0_8overloadIJZNKS_12operator_def4makeENS_23operator_factory_plugin10invocationENS_7sessionEE3$_0ZNKSB_4makeESD_SE_E3$_1EEELm1EEENS0_21variant_invoke_resultIS9_JT0_EE4typeEOS9_OSJ_ at ./libtenzir/include/tenzir/variant_traits.hpp:284
│           15# tenzir::operator_def::make(tenzir::operator_factory_plugin::invocation, tenzir::session) const at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/registry.cpp:63
│           16# tenzir::compile(tenzir::ast::pipeline&&, tenzir::session) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/exec.cpp:477
│           17# tenzir::exec2(std::basic_string_view<char, std::char_traits<char> >, tenzir::diagnostic_handler&, tenzir::exec_config const&, caf::actor_system&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/exec.cpp:550
│           18# tenzir::exec_pipeline(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, tenzir::diagnostic_handler&, tenzir::exec_config const&, caf::actor_system&) at ./build/clang/relwithdebinfo/./libtenzir/src/exec_pipeline.cpp:316
│           19# tenzir::plugins::exec::(anonymous namespace)::exec_command_impl(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, tenzir::diagnostic_handler&, tenzir::exec_config const&, caf::actor_system&) at ./build/clang/relwithdebinfo/./libtenzir/builtins/commands/exec.cpp:35
│           20# std::_Function_handler<caf::message (tenzir::invocation const&, caf::actor_system&), tenzir::plugins::exec::(anonymous namespace)::plugin::make_command[abi:cxx11]() const::{lambda(tenzir::invocation const&, caf::actor_system&)#1}>::_M_invoke(std::_Any_data const&, tenzir::invocation const&, caf::actor_system&) at /nix/store/82kmz7r96navanrc2fgckh2bamiqrgsw-gcc-14.3.0/include/c++/14.3.0/bits/std_function.h:290
│           21# tenzir::run(tenzir::invocation const&, caf::actor_system&, std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::function<caf::message (tenzir::invocation const&, caf::actor_system&)>, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, std::function<caf::message (tenzir::invocation const&, caf::actor_system&)> > > > const&) at ./build/clang/relwithdebinfo/./libtenzir/src/command.cpp:386
│           22# main at ./build/clang/relwithdebinfo/./tenzir/tenzir.cpp:518
│           23# __libc_start_call_main in /nix/store/776irwlgfb65a782cxmyk61pck460fs9-glibc-2.40-66/lib/libc.so.6
│           24# __libc_start_main_alias_1 in /nix/store/776irwlgfb65a782cxmyk61pck460fs9-glibc-2.40-66/lib/libc.so.6
│           25# _start in /home/tobim/t/tenzir/hacky-udo-args/build/clang/relwithdebinfo/bin/tenzir
│ 
│ error: expected a constant expression
│   --> tests/packages/udo-args/udo-args-constant-required.tql:15:29
│    |
│ 15 | argspkg::untyped_positional this.value
│    |                             ^^^^ 
│    |
│    = note: stacktrace:
│             0# tenzir::evaluator::input_or_throw(tenzir::into_location) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:714
│             1# tenzir::evaluator::eval(tenzir::ast::this_ const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:273
│             2# std::__detail::__variant::__gen_vtable_impl<std::__detail::__variant::_Multi_array<std::__detail::__variant::__deduce_visit_result<tenzir::multi_series> (*)(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&)>, std::integer_sequence<unsigned long, 3ul> >::__visit_invoke(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&) at /nix/store/82kmz7r96navanrc2fgckh2bamiqrgsw-gcc-14.3.0/include/c++/14.3.0/variant:1060
│             3# tenzir::evaluator::eval(tenzir::ast::expression const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:702
│             4# std::__detail::__variant::__gen_vtable_impl<std::__detail::__variant::_Multi_array<std::__detail::__variant::__deduce_visit_result<tenzir::multi_series> (*)(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&)>, std::integer_sequence<unsigned long, 7ul> >::__visit_invoke(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&) at /nix/store/82kmz7r96navanrc2fgckh2bamiqrgsw-gcc-14.3.0/include/c++/14.3.0/variant:1060
│             5# tenzir::evaluator::eval(tenzir::ast::expression const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:702
│             6# tenzir::evaluator::eval(tenzir::ast::record const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:53
│             7# std::__detail::__variant::__gen_vtable_impl<std::__detail::__variant::_Multi_array<std::__detail::__variant::__deduce_visit_result<tenzir::multi_series> (*)(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&)>, std::integer_sequence<unsigned long, 0ul> >::__visit_invoke(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&) at /nix/store/82kmz7r96navanrc2fgckh2bamiqrgsw-gcc-14.3.0/include/c++/14.3.0/variant:1060
│             8# tenzir::evaluator::eval(tenzir::ast::expression const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:702
│             9# tenzir::const_eval(tenzir::ast::expression const&, tenzir::diagnostic_handler&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval.cpp:181
│            10# tenzir::plugins::from::(anonymous namespace)::from_plugin2::make(tenzir::operator_factory_plugin::invocation, tenzir::session) const at ./build/clang/relwithdebinfo/./libtenzir/builtins/operators/from_to_2.cpp:111
│            11# _ZN6tenzir6detail14match_functionIRKNS_7variantIJNS_15native_operatorENS_21user_defined_operatorEEEETkNS0_19variant_matcher_forIT_EENS0_8overloadIJZNKS_12operator_def4makeENS_23operator_factory_plugin10invocationENS_7sessionEE3$_0ZNKSB_4makeESD_SE_E3$_1EEELm0EEENS0_21variant_invoke_resultIS9_JT0_EE4typeEOS9_OSJ_ at ./libtenzir/include/tenzir/variant_traits.hpp:284
│            12# tenzir::operator_def::make(tenzir::operator_factory_plugin::invocation, tenzir::session) const at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/registry.cpp:63
│            13# tenzir::compile(tenzir::ast::pipeline&&, tenzir::session) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/exec.cpp:477
│            14# _ZN6tenzir6detail14match_functionIRKNS_7variantIJNS_15native_operatorENS_21user_defined_operatorEEEETkNS0_19variant_matcher_forIT_EENS0_8overloadIJZNKS_12operator_def4makeENS_23operator_factory_plugin10invocationENS_7sessionEE3$_0ZNKSB_4makeESD_SE_E3$_1EEELm1EEENS0_21variant_invoke_resultIS9_JT0_EE4typeEOS9_OSJ_ at ./libtenzir/include/tenzir/variant_traits.hpp:284
│            15# tenzir::operator_def::make(tenzir::operator_factory_plugin::invocation, tenzir::session) const at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/registry.cpp:63
│            16# tenzir::compile(tenzir::ast::pipeline&&, tenzir::session) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/exec.cpp:477
│            17# tenzir::exec2(std::basic_string_view<char, std::char_traits<char> >, tenzir::diagnostic_handler&, tenzir::exec_config const&, caf::actor_system&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/exec.cpp:550
│            18# tenzir::exec_pipeline(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, tenzir::diagnostic_handler&, tenzir::exec_config const&, caf::actor_system&) at ./build/clang/relwithdebinfo/./libtenzir/src/exec_pipeline.cpp:316
│            19# tenzir::plugins::exec::(anonymous namespace)::exec_command_impl(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, tenzir::diagnostic_handler&, tenzir::exec_config const&, caf::actor_system&) at ./build/clang/relwithdebinfo/./libtenzir/builtins/commands/exec.cpp:35
│            20# std::_Function_handler<caf::message (tenzir::invocation const&, caf::actor_system&), tenzir::plugins::exec::(anonymous namespace)::plugin::make_command[abi:cxx11]() const::{lambda(tenzir::invocation const&, caf::actor_system&)#1}>::_M_invoke(std::_Any_data const&, tenzir::invocation const&, caf::actor_system&) at /nix/store/82kmz7r96navanrc2fgckh2bamiqrgsw-gcc-14.3.0/include/c++/14.3.0/bits/std_function.h:290
│            21# tenzir::run(tenzir::invocation const&, caf::actor_system&, std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::function<caf::message (tenzir::invocation const&, caf::actor_system&)>, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, std::function<caf::message (tenzir::invocation const&, caf::actor_system&)> > > > const&) at ./build/clang/relwithdebinfo/./libtenzir/src/command.cpp:386
│            22# main at ./build/clang/relwithdebinfo/./tenzir/tenzir.cpp:518
│            23# __libc_start_call_main in /nix/store/776irwlgfb65a782cxmyk61pck460fs9-glibc-2.40-66/lib/libc.so.6
│            24# __libc_start_main_alias_1 in /nix/store/776irwlgfb65a782cxmyk61pck460fs9-glibc-2.40-66/lib/libc.so.6
│            25# _start in /home/tobim/t/tenzir/hacky-udo-args/build/clang/relwithdebinfo/bin/tenzir
│ 
│ error: expected additional positional argument `value`
│   --> tests/packages/udo-args/udo-args-constant-required.tql:20:1
│    |
│ 20 | argspkg::untyped_positional
│    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^ 
│    |
│    = usage: argspkg::untyped_positional value:any
│    = note: parameters:
│              positional:
│                name   type  default  description
│                value  any   -        Any expression is accepted
│    = docs: https://docs.tenzir.com/reference/operators/user_defined_operator
│ 
│ error: expected a constant expression
│   --> tests/packages/udo-args/udo-args-constant-required.tql:28:27
│    |
│ 28 | argspkg::typed_positional this.value
│    |                           ^^^^ 
│    |
│    = note: stacktrace:
│             0# tenzir::evaluator::input_or_throw(tenzir::into_location) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:714
│             1# tenzir::evaluator::eval(tenzir::ast::this_ const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:273
│             2# std::__detail::__variant::__gen_vtable_impl<std::__detail::__variant::_Multi_array<std::__detail::__variant::__deduce_visit_result<tenzir::multi_series> (*)(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&)>, std::integer_sequence<unsigned long, 3ul> >::__visit_invoke(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&) at /nix/store/82kmz7r96navanrc2fgckh2bamiqrgsw-gcc-14.3.0/include/c++/14.3.0/variant:1060
│             3# tenzir::evaluator::eval(tenzir::ast::expression const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:702
│             4# std::__detail::__variant::__gen_vtable_impl<std::__detail::__variant::_Multi_array<std::__detail::__variant::__deduce_visit_result<tenzir::multi_series> (*)(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&)>, std::integer_sequence<unsigned long, 7ul> >::__visit_invoke(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&) at /nix/store/82kmz7r96navanrc2fgckh2bamiqrgsw-gcc-14.3.0/include/c++/14.3.0/variant:1060
│             5# tenzir::evaluator::eval(tenzir::ast::expression const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:702
│             6# tenzir::evaluator::eval(tenzir::ast::record const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:53
│             7# std::__detail::__variant::__gen_vtable_impl<std::__detail::__variant::_Multi_array<std::__detail::__variant::__deduce_visit_result<tenzir::multi_series> (*)(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&)>, std::integer_sequence<unsigned long, 0ul> >::__visit_invoke(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&) at /nix/store/82kmz7r96navanrc2fgckh2bamiqrgsw-gcc-14.3.0/include/c++/14.3.0/variant:1060
│             8# tenzir::evaluator::eval(tenzir::ast::expression const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:702
│             9# tenzir::const_eval(tenzir::ast::expression const&, tenzir::diagnostic_handler&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval.cpp:181
│            10# tenzir::plugins::from::(anonymous namespace)::from_plugin2::make(tenzir::operator_factory_plugin::invocation, tenzir::session) const at ./build/clang/relwithdebinfo/./libtenzir/builtins/operators/from_to_2.cpp:111
│            11# _ZN6tenzir6detail14match_functionIRKNS_7variantIJNS_15native_operatorENS_21user_defined_operatorEEEETkNS0_19variant_matcher_forIT_EENS0_8overloadIJZNKS_12operator_def4makeENS_23operator_factory_plugin10invocationENS_7sessionEE3$_0ZNKSB_4makeESD_SE_E3$_1EEELm0EEENS0_21variant_invoke_resultIS9_JT0_EE4typeEOS9_OSJ_ at ./libtenzir/include/tenzir/variant_traits.hpp:284
│            12# tenzir::operator_def::make(tenzir::operator_factory_plugin::invocation, tenzir::session) const at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/registry.cpp:63
│            13# tenzir::compile(tenzir::ast::pipeline&&, tenzir::session) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/exec.cpp:477
│            14# _ZN6tenzir6detail14match_functionIRKNS_7variantIJNS_15native_operatorENS_21user_defined_operatorEEEETkNS0_19variant_matcher_forIT_EENS0_8overloadIJZNKS_12operator_def4makeENS_23operator_factory_plugin10invocationENS_7sessionEE3$_0ZNKSB_4makeESD_SE_E3$_1EEELm1EEENS0_21variant_invoke_resultIS9_JT0_EE4typeEOS9_OSJ_ at ./libtenzir/include/tenzir/variant_traits.hpp:284
│            15# tenzir::operator_def::make(tenzir::operator_factory_plugin::invocation, tenzir::session) const at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/registry.cpp:63
│            16# tenzir::compile(tenzir::ast::pipeline&&, tenzir::session) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/exec.cpp:477
│            17# tenzir::exec2(std::basic_string_view<char, std::char_traits<char> >, tenzir::diagnostic_handler&, tenzir::exec_config const&, caf::actor_system&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/exec.cpp:550
│            18# tenzir::exec_pipeline(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, tenzir::diagnostic_handler&, tenzir::exec_config const&, caf::actor_system&) at ./build/clang/relwithdebinfo/./libtenzir/src/exec_pipeline.cpp:316
│            19# tenzir::plugins::exec::(anonymous namespace)::exec_command_impl(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, tenzir::diagnostic_handler&, tenzir::exec_config const&, caf::actor_system&) at ./build/clang/relwithdebinfo/./libtenzir/builtins/commands/exec.cpp:35
│            20# std::_Function_handler<caf::message (tenzir::invocation const&, caf::actor_system&), tenzir::plugins::exec::(anonymous namespace)::plugin::make_command[abi:cxx11]() const::{lambda(tenzir::invocation const&, caf::actor_system&)#1}>::_M_invoke(std::_Any_data const&, tenzir::invocation const&, caf::actor_system&) at /nix/store/82kmz7r96navanrc2fgckh2bamiqrgsw-gcc-14.3.0/include/c++/14.3.0/bits/std_function.h:290
│            21# tenzir::run(tenzir::invocation const&, caf::actor_system&, std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::function<caf::message (tenzir::invocation const&, caf::actor_system&)>, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, std::function<caf::message (tenzir::invocation const&, caf::actor_system&)> > > > const&) at ./build/clang/relwithdebinfo/./libtenzir/src/command.cpp:386
│            22# main at ./build/clang/relwithdebinfo/./tenzir/tenzir.cpp:518
│            23# __libc_start_call_main in /nix/store/776irwlgfb65a782cxmyk61pck460fs9-glibc-2.40-66/lib/libc.so.6
│            24# __libc_start_main_alias_1 in /nix/store/776irwlgfb65a782cxmyk61pck460fs9-glibc-2.40-66/lib/libc.so.6
│            25# _start in /home/tobim/t/tenzir/hacky-udo-args/build/clang/relwithdebinfo/bin/tenzir
│ 
│ error: argument `value` must be of type `string` (got `ip`)
│   --> tests/packages/udo-args/udo-args-constant-required.tql:32:27
│    |
│ 32 | argspkg::typed_positional 1.2.3.4
│    |                           ^^^^^^^ 
│    |
│    = usage: argspkg::typed_positional value:string
│    = note: parameters:
│              positional:
│                name   type    default  description
│                value  string  -        Must be a string literal
│    = docs: https://docs.tenzir.com/reference/operators/user_defined_operator
│ 
│ error: expected a constant expression
│   --> tests/packages/udo-args/udo-args-constant-required.tql:36:27
│    |
│ 36 | argspkg::typed_positional this.value
│    |                           ^^^^ 
│    |
│    = note: stacktrace:
│             0# tenzir::evaluator::input_or_throw(tenzir::into_location) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:714
│             1# tenzir::evaluator::eval(tenzir::ast::this_ const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:273
│             2# std::__detail::__variant::__gen_vtable_impl<std::__detail::__variant::_Multi_array<std::__detail::__variant::__deduce_visit_result<tenzir::multi_series> (*)(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&)>, std::integer_sequence<unsigned long, 3ul> >::__visit_invoke(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&) at /nix/store/82kmz7r96navanrc2fgckh2bamiqrgsw-gcc-14.3.0/include/c++/14.3.0/variant:1060
│             3# tenzir::evaluator::eval(tenzir::ast::expression const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:702
│             4# std::__detail::__variant::__gen_vtable_impl<std::__detail::__variant::_Multi_array<std::__detail::__variant::__deduce_visit_result<tenzir::multi_series> (*)(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&)>, std::integer_sequence<unsigned long, 7ul> >::__visit_invoke(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&) at /nix/store/82kmz7r96navanrc2fgckh2bamiqrgsw-gcc-14.3.0/include/c++/14.3.0/variant:1060
│             5# tenzir::evaluator::eval(tenzir::ast::expression const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:702
│             6# tenzir::evaluator::eval(tenzir::ast::record const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:53
│             7# std::__detail::__variant::__gen_vtable_impl<std::__detail::__variant::_Multi_array<std::__detail::__variant::__deduce_visit_result<tenzir::multi_series> (*)(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&)>, std::integer_sequence<unsigned long, 0ul> >::__visit_invoke(tenzir::detail::overload<tenzir::evaluator::eval(tenzir::ast::expression const&)::$_0::operator()() const::{lambda(auto:1&)#1}>&&, std::variant<tenzir::ast::record, tenzir::ast::list, tenzir::ast::meta, tenzir::ast::this_, tenzir::ast::root_field, tenzir::ast::pipeline_expr, tenzir::ast::constant, tenzir::ast::field_access, tenzir::ast::index_expr, tenzir::ast::binary_expr, tenzir::ast::unary_expr, tenzir::ast::function_call, tenzir::ast::lambda_expr, tenzir::ast::underscore, tenzir::ast::unpack, tenzir::ast::assignment, tenzir::ast::dollar_var, tenzir::ast::format_expr>&) at /nix/store/82kmz7r96navanrc2fgckh2bamiqrgsw-gcc-14.3.0/include/c++/14.3.0/variant:1060
│             8# tenzir::evaluator::eval(tenzir::ast::expression const&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval_impl.cpp:702
│             9# tenzir::const_eval(tenzir::ast::expression const&, tenzir::diagnostic_handler&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/eval.cpp:181
│            10# tenzir::plugins::from::(anonymous namespace)::from_plugin2::make(tenzir::operator_factory_plugin::invocation, tenzir::session) const at ./build/clang/relwithdebinfo/./libtenzir/builtins/operators/from_to_2.cpp:111
│            11# _ZN6tenzir6detail14match_functionIRKNS_7variantIJNS_15native_operatorENS_21user_defined_operatorEEEETkNS0_19variant_matcher_forIT_EENS0_8overloadIJZNKS_12operator_def4makeENS_23operator_factory_plugin10invocationENS_7sessionEE3$_0ZNKSB_4makeESD_SE_E3$_1EEELm0EEENS0_21variant_invoke_resultIS9_JT0_EE4typeEOS9_OSJ_ at ./libtenzir/include/tenzir/variant_traits.hpp:284
│            12# tenzir::operator_def::make(tenzir::operator_factory_plugin::invocation, tenzir::session) const at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/registry.cpp:63
│            13# tenzir::compile(tenzir::ast::pipeline&&, tenzir::session) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/exec.cpp:477
│            14# _ZN6tenzir6detail14match_functionIRKNS_7variantIJNS_15native_operatorENS_21user_defined_operatorEEEETkNS0_19variant_matcher_forIT_EENS0_8overloadIJZNKS_12operator_def4makeENS_23operator_factory_plugin10invocationENS_7sessionEE3$_0ZNKSB_4makeESD_SE_E3$_1EEELm1EEENS0_21variant_invoke_resultIS9_JT0_EE4typeEOS9_OSJ_ at ./libtenzir/include/tenzir/variant_traits.hpp:284
│            15# tenzir::operator_def::make(tenzir::operator_factory_plugin::invocation, tenzir::session) const at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/registry.cpp:63
│            16# tenzir::compile(tenzir::ast::pipeline&&, tenzir::session) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/exec.cpp:477
│            17# tenzir::exec2(std::basic_string_view<char, std::char_traits<char> >, tenzir::diagnostic_handler&, tenzir::exec_config const&, caf::actor_system&) at ./build/clang/relwithdebinfo/./libtenzir/src/tql2/exec.cpp:550
│            18# tenzir::exec_pipeline(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, tenzir::diagnostic_handler&, tenzir::exec_config const&, caf::actor_system&) at ./build/clang/relwithdebinfo/./libtenzir/src/exec_pipeline.cpp:316
│            19# tenzir::plugins::exec::(anonymous namespace)::exec_command_impl(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, tenzir::diagnostic_handler&, tenzir::exec_config const&, caf::actor_system&) at ./build/clang/relwithdebinfo/./libtenzir/builtins/commands/exec.cpp:35
│            20# std::_Function_handler<caf::message (tenzir::invocation const&, caf::actor_system&), tenzir::plugins::exec::(anonymous namespace)::plugin::make_command[abi:cxx11]() const::{lambda(tenzir::invocation const&, caf::actor_system&)#1}>::_M_invoke(std::_Any_data const&, tenzir::invocation const&, caf::actor_system&) at /nix/store/82kmz7r96navanrc2fgckh2bamiqrgsw-gcc-14.3.0/include/c++/14.3.0/bits/std_function.h:290
│            21# tenzir::run(tenzir::invocation const&, caf::actor_system&, std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::function<caf::message (tenzir::invocation const&, caf::actor_system&)>, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, std::function<caf::message (tenzir::invocation const&, caf::actor_system&)> > > > const&) at ./build/clang/relwithdebinfo/./libtenzir/src/command.cpp:386
│            22# main at ./build/clang/relwithdebinfo/./tenzir/tenzir.cpp:518
│            23# __libc_start_call_main in /nix/store/776irwlgfb65a782cxmyk61pck460fs9-glibc-2.40-66/lib/libc.so.6
│            24# __libc_start_main_alias_1 in /nix/store/776irwlgfb65a782cxmyk61pck460fs9-glibc-2.40-66/lib/libc.so.6
│            25# _start in /home/tobim/t/tenzir/hacky-udo-args/build/clang/relwithdebinfo/bin/tenzir
│ 
│ error: expected additional positional argument `value`
│   --> tests/packages/udo-args/udo-args-constant-required.tql:41:1
│    |
│ 41 | argspkg::typed_positional
│    | ^^^^^^^^^^^^^^^^^^^^^^^^^ 
│    |
│    = usage: argspkg::typed_positional value:string
│    = note: parameters:
│              positional:
│                name   type    default  description
│                value  string  -        Must be a string literal
│    = docs: https://docs.tenzir.com/reference/operators/user_defined_operator
│ 
│ error: argument `value` must be of type `string` (got `uint64`)
│   = usage: argspkg::typed_positional_mismatching_default [value=string]
│   = note: parameters:
│             named:
│               name   type    default  description
│               value  string  42       Defaults to a number even though a string is required
│   = docs: https://docs.tenzir.com/reference/operators/user_defined_operator
i ran 1 test: 0 passed (0%) / 1 failed (100%)
