"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[26683],{15680:(e,t,a)=>{a.d(t,{xA:()=>o,yg:()=>s});var r=a(96540);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},l=Object.keys(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var p=r.createContext({}),d=function(e){var t=r.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):g(g({},t),e)),a},o=function(e){var t=d(e.components);return r.createElement(p.Provider,{value:t},e.children)},y="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},N=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,l=e.originalType,p=e.parentName,o=i(e,["components","mdxType","originalType","parentName"]),y=d(a),N=n,s=y["".concat(p,".").concat(N)]||y[N]||m[N]||l;return a?r.createElement(s,g(g({ref:t},o),{},{components:a})):r.createElement(s,g({ref:t},o))}));function s(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=a.length,g=new Array(l);g[0]=N;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i[y]="string"==typeof e?e:n,g[1]=i;for(var d=2;d<l;d++)g[d]=a[d];return r.createElement.apply(null,g)}return r.createElement.apply(null,a)}N.displayName="MDXCreateElement"},39209:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>h,contentTitle:()=>f,default:()=>v,frontMatter:()=>s,metadata:()=>c,toc:()=>b});var r=a(15680),n=Object.defineProperty,l=Object.defineProperties,g=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,o=(e,t,a)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,y=(e,t)=>{for(var a in t||(t={}))p.call(t,a)&&o(e,a,t[a]);if(i)for(var a of i(t))d.call(t,a)&&o(e,a,t[a]);return e},m=(e,t)=>l(e,g(t)),N=(e,t)=>{var a={};for(var r in e)p.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&i)for(var r of i(e))t.indexOf(r)<0&&d.call(e,r)&&(a[r]=e[r]);return a};const s={},f="Operators",c={unversionedId:"tql2/operators",id:"tql2/operators",title:"Operators",description:"Tenzir comes with a wide range of built-in pipeline operators.",source:"@site/docs/tql2/operators.md",sourceDirName:"tql2",slug:"/tql2/operators",permalink:"/next/tql2/operators",draft:!1,editUrl:"https://github.com/tenzir/tenzir/tree/main/web/docs/tql2/operators.md",tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Modules",permalink:"/next/tql2/language/modules"},next:{title:"api",permalink:"/next/tql2/operators/api"}},h={},b=[{value:"Modify",id:"modify",level:2},{value:"Filter",id:"filter",level:2},{value:"Analyze",id:"analyze",level:2},{value:"Flow Control",id:"flow-control",level:2},{value:"Input",id:"input",level:2},{value:"Output",id:"output",level:2},{value:"Parsing",id:"parsing",level:2},{value:"Printing",id:"printing",level:2},{value:"Node Inspection",id:"node-inspection",level:2},{value:"Host Inspection",id:"host-inspection",level:2},{value:"Detection",id:"detection",level:2},{value:"Internals",id:"internals",level:2},{value:"Encode &amp; Decode",id:"encode--decode",level:2},{value:"Packages",id:"packages",level:2},{value:"Uncategorized",id:"uncategorized",level:2}],u={toc:b},C="wrapper";function v(e){var t=e,{components:a}=t,n=N(t,["components"]);return(0,r.yg)(C,m(y(y({},u),n),{components:a,mdxType:"MDXLayout"}),(0,r.yg)("h1",y({},{id:"operators"}),"Operators"),(0,r.yg)("p",null,"Tenzir comes with a wide range of built-in pipeline operators."),(0,r.yg)("h2",y({},{id:"modify"}),"Modify"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Operator"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Description"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Example"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/set"}),(0,r.yg)("inlineCode",{parentName:"a"},"set"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Assigns a value to a field, creating it if necessary"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'name = "Tenzir"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/select"}),(0,r.yg)("inlineCode",{parentName:"a"},"select"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Selects some values and discard the rest"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"select name, id=metadata.id"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/drop"}),(0,r.yg)("inlineCode",{parentName:"a"},"drop"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Removes fields from the event"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"drop name, metadata.id"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/enumerate"}),(0,r.yg)("inlineCode",{parentName:"a"},"enumerate"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Adds a field with the number of the event"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"enumerate num"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/unroll"}),(0,r.yg)("inlineCode",{parentName:"a"},"unroll"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Unrolls a field of type list, duplicating the surrounding event"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"unroll names"))))),(0,r.yg)("h2",y({},{id:"filter"}),"Filter"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Operator"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Description"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Example"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/where"}),(0,r.yg)("inlineCode",{parentName:"a"},"where"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Keeps only events matching a predicate"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'where name.starts_with("John")'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/assert"}),(0,r.yg)("inlineCode",{parentName:"a"},"assert"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Same as ",(0,r.yg)("inlineCode",{parentName:"td"},"where"),", but warns if predicate is ",(0,r.yg)("inlineCode",{parentName:"td"},"false")),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'assert name.starts_with("John")'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/taste"}),(0,r.yg)("inlineCode",{parentName:"a"},"taste"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Keeps only N events of each type"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"taste 1"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/head"}),(0,r.yg)("inlineCode",{parentName:"a"},"head"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Keeps only the first N events"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"head 20"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/tail"}),(0,r.yg)("inlineCode",{parentName:"a"},"tail"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Keeps only the last N events"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"tail 20"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/slice"}),(0,r.yg)("inlineCode",{parentName:"a"},"slice"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Keeps a range of events with an optional stride"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"slice begin=10, end=30"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/sample"}),(0,r.yg)("inlineCode",{parentName:"a"},"sample"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Samples events based on load"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"sample 30s, max_samples=2k"))))),(0,r.yg)("h2",y({},{id:"analyze"}),"Analyze"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Operator"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Description"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Example"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/summarize"}),(0,r.yg)("inlineCode",{parentName:"a"},"summarize"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Aggregates events with implicit grouping"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"summarize name, sum(amount)"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/sort"}),(0,r.yg)("inlineCode",{parentName:"a"},"sort"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Sorts the events by one or more expressions"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"sort name, -abs(transaction)"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/reverse"}),(0,r.yg)("inlineCode",{parentName:"a"},"reverse"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Reverses the event order"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"reverse"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/top"}),(0,r.yg)("inlineCode",{parentName:"a"},"top"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Shows the most common values"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"top user"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/rare"}),(0,r.yg)("inlineCode",{parentName:"a"},"rare"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Shows the least common values"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"rare auth.token"))))),(0,r.yg)("h2",y({},{id:"flow-control"}),"Flow Control"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Operator"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Description"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Example"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/every"}),(0,r.yg)("inlineCode",{parentName:"a"},"every"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Restarts a pipeline periodically"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"every 10s { summarize sum(amount) }"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/fork"}),(0,r.yg)("inlineCode",{parentName:"a"},"fork"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Forwards a copy of the events to another pipeline"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'fork { to "copy.json" }'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/language/statements#if"}),(0,r.yg)("inlineCode",{parentName:"a"},"if"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Splits the flow based on a predicate"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"if transaction > 0 { \u2026 } else { \u2026 }"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/load_balance"}),(0,r.yg)("inlineCode",{parentName:"a"},"load_balance"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Routes the data to one of multiple subpipelines"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"load_balance $over { publish $over }"))))),(0,r.yg)("h2",y({},{id:"input"}),"Input"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Operator"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Description"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Example"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/diagnostics"}),(0,r.yg)("inlineCode",{parentName:"a"},"diagnostics"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Retrieves diagnostic events of managed pipelines"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"diagnostics"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/export"}),(0,r.yg)("inlineCode",{parentName:"a"},"export"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Retrieves events from the node"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"export"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/from_velociraptor"}),(0,r.yg)("inlineCode",{parentName:"a"},"from_velociraptor"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Returns results from a Velociraptor server"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'from_velociraptor subscribe="Windows"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/load_file"}),(0,r.yg)("inlineCode",{parentName:"a"},"load_file"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Loads bytes from a file"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'load_file "/tmp/data.json"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/load_google_cloud_pubsub"}),(0,r.yg)("inlineCode",{parentName:"a"},"load_google\u2026"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Listen to a Google Cloud Pub/Sub subscription"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'load_google_cloud_pubsub "\u2026", "\u2026"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/load_http"}),(0,r.yg)("inlineCode",{parentName:"a"},"load_http"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Receives bytes from a HTTP request"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'load_http "example.org", params={n: 5}'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/load_kafka"}),(0,r.yg)("inlineCode",{parentName:"a"},"load_kafka"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Receives bytes from an Apache Kafka topic"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'load_kafka topic="example"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/load_tcp"}),(0,r.yg)("inlineCode",{parentName:"a"},"load_tcp"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Loads bytes from a TCP or TLS connection"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'load_tcp "0.0.0.0:8090" { read_json }'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/metrics"}),(0,r.yg)("inlineCode",{parentName:"a"},"metrics"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Retrieves metrics events from a Tenzir node"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'metrics "cpu"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/subscribe"}),(0,r.yg)("inlineCode",{parentName:"a"},"subscribe"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Subscribes to events of a certain topic"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'subscribe "topic"'))))),(0,r.yg)("h2",y({},{id:"output"}),"Output"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Operator"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Description"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Example"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/publish"}),(0,r.yg)("inlineCode",{parentName:"a"},"publish"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Publishes events to a certain topic"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'publish "topic"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/import"}),(0,r.yg)("inlineCode",{parentName:"a"},"import"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Stores events at the node"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"import"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/discard"}),(0,r.yg)("inlineCode",{parentName:"a"},"discard"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Discards incoming bytes or events"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"discard"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/save_file"}),(0,r.yg)("inlineCode",{parentName:"a"},"save_file"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Saves incoming bytes into a file"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'save_file "/tmp/out.json"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/save_google_cloud_pubsub"}),(0,r.yg)("inlineCode",{parentName:"a"},"save_google_cloud\u2026"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Publishes to a Google Cloud Pub/Sub topic"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'save_google_cloud_pubsub "\u2026", "\u2026"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/save_http"}),(0,r.yg)("inlineCode",{parentName:"a"},"save_http"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Sends incoming bytes over a HTTP connection"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'save_http "example.org/api"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/save_kafka"}),(0,r.yg)("inlineCode",{parentName:"a"},"save_kafka"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Saves incoming bytes to an Apache Kafka topic"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'save_kafka topic="example"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/serve"}),(0,r.yg)("inlineCode",{parentName:"a"},"serve"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Makes events available at ",(0,r.yg)("inlineCode",{parentName:"td"},"/serve")),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'serve "abcde12345"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/to_azure_log_analytics"}),(0,r.yg)("inlineCode",{parentName:"a"},"to_azure_log_analytics"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Sends events to Azure Log Analytics"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"to_azure_log_analytics tenant_id=\u2026"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/to_hive"}),(0,r.yg)("inlineCode",{parentName:"a"},"to_hive"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Writes events using hive partitioning"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'to_hive "s3://\u2026", partition_by=[x]'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/to_splunk"}),(0,r.yg)("inlineCode",{parentName:"a"},"to_splunk"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Sends incoming events to a Splunk HEC"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'to_splunk "https://localhost:8088", \u2026'))))),(0,r.yg)("h2",y({},{id:"parsing"}),"Parsing"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Operator"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Description"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Example"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/read_bitz"}),(0,r.yg)("inlineCode",{parentName:"a"},"read_bitz"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Parses Tenzir's internal wire format"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"read_bitz"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/read_cef"}),(0,r.yg)("inlineCode",{parentName:"a"},"read_cef"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Parses the Common Event Format"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"read_cef"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/read_csv"}),(0,r.yg)("inlineCode",{parentName:"a"},"read_csv"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Parses comma-separated values"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'read_csv null_value="-"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/read_gelf"}),(0,r.yg)("inlineCode",{parentName:"a"},"read_gelf"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Parses the Graylog Extended Log Format"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"read_gelf"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/read_grok"}),(0,r.yg)("inlineCode",{parentName:"a"},"read_grok"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Parses events using a Grok pattern"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'read_grok "%{IP:client} %{WORD:action}"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/read_json"}),(0,r.yg)("inlineCode",{parentName:"a"},"read_json"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Parses JSON objects"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"read_json arrays_of_objects=true"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/read_kv"}),(0,r.yg)("inlineCode",{parentName:"a"},"read_kv"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Parses key-value pairs"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'read_kv r"(\\s+)[A-Z_]+:", r":\\s*"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/read_leef"}),(0,r.yg)("inlineCode",{parentName:"a"},"read_leef"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Parses the Log Event Extended Format"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"read_leef"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/read_lines"}),(0,r.yg)("inlineCode",{parentName:"a"},"read_lines"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Parses each line into a separate event"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"read_lines"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/read_ndjson"}),(0,r.yg)("inlineCode",{parentName:"a"},"read_ndjson"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Parses newline-delimited JSON"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"read_ndjson"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/read_ssv"}),(0,r.yg)("inlineCode",{parentName:"a"},"read_ssv"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Parses space-separated values"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'read_ssv header="name count"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/read_suricata"}),(0,r.yg)("inlineCode",{parentName:"a"},"read_suricata"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Parses Suricata's Eve format"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"read_suricata"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/read_syslog"}),(0,r.yg)("inlineCode",{parentName:"a"},"read_syslog"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Parses syslog"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"read_syslog"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/read_tsv"}),(0,r.yg)("inlineCode",{parentName:"a"},"read_tsv"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Parses tab-separated values"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"read_tsv auto_expand=true"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/read_xsv"}),(0,r.yg)("inlineCode",{parentName:"a"},"read_xsv"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Parses custom-separated values"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'read_xsv ";", ":", "N/A"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/read_yaml"}),(0,r.yg)("inlineCode",{parentName:"a"},"read_yaml"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Parses YAML"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"read_yaml"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/read_zeek_json"}),(0,r.yg)("inlineCode",{parentName:"a"},"read_zeek_json"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Parses Zeek JSON"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"read_zeek_json"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/read_zeek_tsv"}),(0,r.yg)("inlineCode",{parentName:"a"},"read_zeek_tsv"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Parses Zeek TSV"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"read_zeek_tsv"))))),(0,r.yg)("h2",y({},{id:"printing"}),"Printing"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Operator"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Description"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Example"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/write_bitz"}),(0,r.yg)("inlineCode",{parentName:"a"},"write_bitz"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Writes events as Tenzir's internal wire format"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"write_bitz"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/write_json"}),(0,r.yg)("inlineCode",{parentName:"a"},"write_json"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Writes events as JSON"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"write_json ndjson=true"))))),(0,r.yg)("h2",y({},{id:"node-inspection"}),"Node Inspection"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Operator"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Description"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Example"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/config"}),(0,r.yg)("inlineCode",{parentName:"a"},"config"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Returns the node's configuration"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"config"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/fields"}),(0,r.yg)("inlineCode",{parentName:"a"},"fields"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Lists all fields stored at the node"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"fields"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/openapi"}),(0,r.yg)("inlineCode",{parentName:"a"},"openapi"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Returns the OpenAPI specification"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"openapi"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/partitions"}),(0,r.yg)("inlineCode",{parentName:"a"},"partitions"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Retrieves metadata about events stored at the node"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"partitions src_ip == 1.2.3.4"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/plugins"}),(0,r.yg)("inlineCode",{parentName:"a"},"plugins"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Lists available plugins"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"plugins"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/schemas"}),(0,r.yg)("inlineCode",{parentName:"a"},"schemas"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Lists schemas for events stored at the node"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"schemas"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/version"}),(0,r.yg)("inlineCode",{parentName:"a"},"version"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Shows the current version"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"version"))))),(0,r.yg)("h2",y({},{id:"host-inspection"}),"Host Inspection"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Operator"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Description"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Example"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/files"}),(0,r.yg)("inlineCode",{parentName:"a"},"files"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Lists files in a directory"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'files "/var/log/", recurse=true'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/nics"}),(0,r.yg)("inlineCode",{parentName:"a"},"nics"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Lists available network interfaces"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"nics"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/processes"}),(0,r.yg)("inlineCode",{parentName:"a"},"processes"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Lists running processes"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"processes"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/sockets"}),(0,r.yg)("inlineCode",{parentName:"a"},"sockets"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Lists open sockets"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"sockets"))))),(0,r.yg)("h2",y({},{id:"detection"}),"Detection"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Operator"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Description"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Example"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/sigma"}),(0,r.yg)("inlineCode",{parentName:"a"},"sigma"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Matches incoming events against Sigma rules"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'sigma "/tmp/rules/"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/yara"}),(0,r.yg)("inlineCode",{parentName:"a"},"yara"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Matches the incoming byte stream against YARA rules"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'yara "/path/to/rules", blockwise=true'))))),(0,r.yg)("h2",y({},{id:"internals"}),"Internals"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Operator"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Description"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Example"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/api"}),(0,r.yg)("inlineCode",{parentName:"a"},"api"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Calls Tenzir's REST API from a pipeline"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'api "/pipeline/list"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/batch"}),(0,r.yg)("inlineCode",{parentName:"a"},"batch"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Controls the batch size of events"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"batch timeout=1s"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/buffer"}),(0,r.yg)("inlineCode",{parentName:"a"},"buffer"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Adds additional buffering to handle spikes"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'buffer 10M, policy="drop"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/measure"}),(0,r.yg)("inlineCode",{parentName:"a"},"measure"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Returns events describing the incoming batches"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"measure"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/throttle"}),(0,r.yg)("inlineCode",{parentName:"a"},"throttle"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Limits the amount of data flowing through"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"throttle 100M, within=1min"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/cache"}),(0,r.yg)("inlineCode",{parentName:"a"},"cache"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"In-memory cache shared between pipelines"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'cache "w01wyhTZm3", ttl=10min'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/legacy"}),(0,r.yg)("inlineCode",{parentName:"a"},"legacy"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Provides a compatibility fallback to TQL1 pipelines"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'legacy "chart area"'))))),(0,r.yg)("h2",y({},{id:"encode--decode"}),"Encode & Decode"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Operator"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Description"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Example"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/compress"}),(0,r.yg)("inlineCode",{parentName:"a"},"compress"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Compresses a stream of bytes"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'compress "zstd", level=18'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/decompress"}),(0,r.yg)("inlineCode",{parentName:"a"},"decompress"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Decompresses a stream of bytes"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'decompress "brotli"'))))),(0,r.yg)("h2",y({},{id:"packages"}),"Packages"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Operator"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Description"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Example"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/package/add"}),(0,r.yg)("inlineCode",{parentName:"a"},"package::add"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Installs a package"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'package::add "suricata-ocsf"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/package/list"}),(0,r.yg)("inlineCode",{parentName:"a"},"package::list"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Shows installed packages"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"package::list"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/package/add"}),(0,r.yg)("inlineCode",{parentName:"a"},"package::remove"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Uninstalls a package"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'package::remove "suricata-ocsf"'))))),(0,r.yg)("h2",y({},{id:"uncategorized"}),"Uncategorized"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Operator"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Description"),(0,r.yg)("th",y({parentName:"tr"},{align:"left"}),"Example"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/delay"}),(0,r.yg)("inlineCode",{parentName:"a"},"delay"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Delays events relative to a start time"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"delay ts, speed=2.5"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/pass"}),(0,r.yg)("inlineCode",{parentName:"a"},"pass"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Does nothing with the input"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"pass"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/repeat"}),(0,r.yg)("inlineCode",{parentName:"a"},"repeat"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Repeats the input after it has finished"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"repeat 100"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/timeshift"}),(0,r.yg)("inlineCode",{parentName:"a"},"timeshift"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Adjusts timestamps relative to a given start time"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},"timeshift ts, start=2020-01-01"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/python"}),(0,r.yg)("inlineCode",{parentName:"a"},"python"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Executes a Python snippet for each event"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("inlineCode",{parentName:"td"},'python "self.x = self.y"'))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("a",y({parentName:"td"},{href:"/next/tql2/operators/shell"}),(0,r.yg)("inlineCode",{parentName:"a"},"shell"))),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),"Runs a shell command within the pipeline"),(0,r.yg)("td",y({parentName:"tr"},{align:"left"}),(0,r.yg)("code",null,'shell "./process.sh ',"|",' tee copy.txt"'))))))}v.isMDXComponent=!0}}]);