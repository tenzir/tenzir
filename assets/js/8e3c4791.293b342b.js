"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[67389],{15680:(e,t,a)=>{a.d(t,{xA:()=>l,yg:()=>g});var n=a(96540);function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,c=function(e,t){if(null==e)return{};var a,n,c={},m=Object.keys(e);for(n=0;n<m.length;n++)a=m[n],t.indexOf(a)>=0||(c[a]=e[a]);return c}(e,t);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(e);for(n=0;n<m.length;n++)a=m[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(c[a]=e[a])}return c}var s=n.createContext({}),o=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},l=function(e){var t=o(e.components);return n.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},y=n.forwardRef((function(e,t){var a=e.components,c=e.mdxType,m=e.originalType,s=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),p=o(a),y=c,g=p["".concat(s,".").concat(y)]||p[y]||d[y]||m;return a?n.createElement(g,r(r({ref:t},l),{},{components:a})):n.createElement(g,r({ref:t},l))}));function g(e,t){var a=arguments,c=t&&t.mdxType;if("string"==typeof e||c){var m=a.length,r=new Array(m);r[0]=y;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[p]="string"==typeof e?e:c,r[1]=i;for(var o=2;o<m;o++)r[o]=a[o];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}y.displayName="MDXCreateElement"},97697:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>M,contentTitle:()=>u,default:()=>D,frontMatter:()=>g,metadata:()=>h,toc:()=>w});var n=a(15680),c=Object.defineProperty,m=Object.defineProperties,r=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,l=(e,t,a)=>t in e?c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,p=(e,t)=>{for(var a in t||(t={}))s.call(t,a)&&l(e,a,t[a]);if(i)for(var a of i(t))o.call(t,a)&&l(e,a,t[a]);return e},d=(e,t)=>m(e,r(t)),y=(e,t)=>{var a={};for(var n in e)s.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&i)for(var n of i(e))t.indexOf(n)<0&&o.call(e,n)&&(a[n]=e[n]);return a};const g={title:"Enrichment Complexity in the Wild",authors:["mavam"],date:new Date("2023-11-27T00:00:00.000Z"),tags:["enrichment","context","splunk","elastic","azure","sentinel","kusto"],comments:!0},u=void 0,h={permalink:"/archive/enrichment-complexity-in-the-wild",source:"@site/archive/enrichment-complexity-in-the-wild/index.md",title:"Enrichment Complexity in the Wild",description:"Enrichment is a major part of a security data lifecycle and can take on many",date:"2023-11-27T00:00:00.000Z",formattedDate:"November 27, 2023",tags:[{label:"enrichment",permalink:"/archive/tags/enrichment"},{label:"context",permalink:"/archive/tags/context"},{label:"splunk",permalink:"/archive/tags/splunk"},{label:"elastic",permalink:"/archive/tags/elastic"},{label:"azure",permalink:"/archive/tags/azure"},{label:"sentinel",permalink:"/archive/tags/sentinel"},{label:"kusto",permalink:"/archive/tags/kusto"}],readingTime:5.14,hasTruncateMarker:!0,authors:[{name:"Matthias Vallentin",title:"Founder & CEO",url:"https://github.com/mavam",email:"matthias@tenzir.com",imageURL:"https://github.com/mavam.png",key:"mavam"}],frontMatter:{title:"Enrichment Complexity in the Wild",authors:["mavam"],date:"2023-11-27T00:00:00.000Z",tags:["enrichment","context","splunk","elastic","azure","sentinel","kusto"],comments:!0},prevItem:{title:"Contextualization Made Simple",permalink:"/archive/contextualization-made-simple"},nextItem:{title:"Matching YARA Rules in Byte Pipelines",permalink:"/archive/matching-yara-rules-in-byte-pipelines"}},M={authorsImageUrls:[void 0]},w=[{value:"Existing Solutions",id:"existing-solutions",level:2},{value:"Splunk",id:"splunk",level:3},{value:"Elastic",id:"elastic",level:3},{value:"Sentinel",id:"sentinel",level:3},{value:"Search vs. Ingest Time Enrichment",id:"search-vs-ingest-time-enrichment",level:2},{value:"Conclusion",id:"conclusion",level:2}],x={toc:w},f="wrapper";function D(e){var t=e,{components:c}=t,m=y(t,["components"]);return(0,n.yg)(f,d(p(p({},x),m),{components:c,mdxType:"MDXLayout"}),(0,n.yg)("p",null,"Enrichment is a major part of a security data lifecycle and can take on many\nforms: adding GeoIP locations for all IP addresses in a log, attaching asset\ninventory data via user or hostname lookups, or extending alerts with magic\nscore to bump it up the triaging queue. The goal is always to make the data more\n",(0,n.yg)("em",{parentName:"p"},"actionable")," by providing a better ground for decision making."),(0,n.yg)("p",null,"This is the first part of series of blog posts on contextualization. We kick\nthings off by looking at how existing systems do enrichment. In the next blog\npost, we introduce how we address this use case with pipeline-first mindset in\nthe Tenzir stack."),(0,n.yg)("p",null,(0,n.yg)("figure",p({parentName:"p"},{className:"markdown-inline-svg"}),"\n  ",(0,n.yg)("svg",p({parentName:"figure"},{viewBox:"0 0 1175.225 220.277",role:"img","aria-hidden":"true"}),"eyJ2ZXJzaW9uIjoiMSIsImVuY29kaW5nIjoiYnN0cmluZyIsImNvbXByZXNzZWQiOnRydWUsImVuY29kZWQiOiJ4nO1a2XLaSFx1MDAxNH3PV7iY16DpfcmbXHUwMDE3XHUwMDEy73aMY5PMTLlkIUCxkIgkjJ2p/PvclmO0gFx1MDAxMNhxhclcZqmKoZer7r7n3D63W3+/2thoJPcjt/Fmo+HeObbvdSN70nhtym/dKPbCXHUwMDAwqkj6O1x1MDAwZceRk7ZcdTAwMWMkySh+8/vv9mhkZb0sJ1x1MDAxYz70dH136Fx1MDAwNklcZm3/gN9cdTAwMWJcdTAwMWJ/p//nnlx1MDAxNblOYlx1MDAwN33fTTukVdnjMKXl0uMwSFx1MDAxZs1cdTAwMTAlXHUwMDE4KSGmXHK8eFx1MDAwN1x1MDAxZZe4Xajt2X7sZjWmqHFC7vTRJ9tpX+1uqsP9Tfek/fFL9tSe5/vt5N5/mJftXGbGUW5McVx1MDAxMoU37qXXTVx1MDAwNmZcXKXyab84hFx1MDAxNch6ReG4P1xi3Dgu9Fx0R7bjJfemXGahaenDXCK82chK7uBcdTAwMTcl3OJcdTAwMWFLrVxil1x1MDAxY5FpZdpdodJAtkM/jMxAfsOu+ZdccuXadm76MJ6gO22TRHZcdTAwMTCP7FxiXHUwMDFjlLWbPE4xZ3vgev1BUlx1MDAxYW/spiutOdVcdTAwMTRhkY3MPGW01019/le2vJE9dPdMj2Ds+/lcdTAwMTVcbrrfV6hQcW0qWmX45CFUgFHi3mWTyDmdvku2JtdHSciDg9tk3Lnuc3unMW337fu3bJzjUdd+wFx1MDAxMJZcYimCOSGcyWm971x1MDAwNTflsfqhc5PBLi399no+3Fx1MDAwYuPMIb1cdTAwMWHoXHUwMDA0Y4q0kmhpoM+f87pcdTAwMDNdXG6LK6lcYqWMaI6LSCeYWPzFsC6VhZDUXGZIpjHCXFzMXCKf8jLwIfhQpVx1MDAwNOPohZFfqJyFp8CwXFwrwDNcdTAwMWJXXHUwMDE4JG3va4oxVSh9a1x1MDAwZj3/vuDKXHUwMDE0t7COrSDynEGjUL7pe32D4YZcdTAwMDMjdqNcdTAwMDK8XHUwMDEzXHUwMDBmNoVpg6HX7eYjvVx1MDAwM1x1MDAwZrO9wI32lonQYeT1vcD2zyvGXHUwMDAyc3d3p6HKXCI8XHUwMDA3iNg1tWaqfCE/01bzdlwiIculj1x1MDAwNJWCIFxiznh5gk5khM9v9oLtXHUwMDE4XHUwMDFktj3741x1MDAwZWm7Z+tOUI6ExVx1MDAwMHFcYktGgCpFfjJtXHUwMDExipBmXHUwMDE4UcwweVx1MDAxNll/c7XruL05m1x1MDAxMpmzKSlcdTAwMDTszX2ySPrIVI205Fx1MDAxY6uM1z+FqWYjXHUwMDExebQuy9Q4saNky1x1MDAwYrpe0C93cYNuRY1vx8l2OFx1MDAxY3pcdFxm4zT0gqTcXCK1u1x1MDAxOUXhZODaM9NcdTAwMDbLlXUjY664LWffNjLkpD+m3/96Pbe1QJakSGgkXGJRSiGR792UXHUwMDE2RpxcdTAwMTFJuVx1MDAxNFxiYErcJubPMklKgCG15nK4S8dUtoDZXHUwMDEyXHUwMDAzKvYo2JupXdVcdTAwMWMtrlx1MDAxOatdc/Sc9rnWr/J/q4LqQo0vK5VcdTAwMGY4XHUwMDFiMVxuzl86sIrzzslndFx1MDAxY5+6X0JMdi+6PNr8tO6BlVx1MDAxNCU+LodWVFxmrbQ0sFx1MDAxZlx1MDAxNFnRnMjKZtQ+XHUwMDE2jGLCmPiXhdKn7flcdTAwMThLUVx1MDAwNU6qXHUwMDEx01xcLZ9+XHUwMDBlXHUwMDA3waXXbFx1MDAxZu5N7lx1MDAwN59ao919v/l57dNPIahcdTAwMDXbvYY8XHUwMDFia81zQjPtL0GVc1xmXHUwMDE5IMRnIaBhJTZcdTAwMWbC1NOwSVx1MDAxNFxmXHUwMDAyXHUwMDFlTuFcdOB5iWeRikF/QFx1MDAxM8pcdTAwMTQhSEK8n5Hr0FNQqfB8tT5ccmiN1u1Vv3Ovz8lX5ejW4KR/3Im7ucyy0bnGds/rOlx1MDAxM3R38aF71Xz/0aAv1+B95/Ts4OtVc7fV02esN9q8YFxcP6acKzEky3RcdTAwMWaxSr6XfKskzlx1MDAxZotSWcjTXHUwMDA1W4E2/1x1MDAxNVx1MDAwNdLEloJcYkxcdTAwMDVjlEpCmCjsz1xcWFx1MDAxMHCAXHUwMDAyXGYrxVxiXGLJ2u3S0lx1MDAxMLJcdTAwMDFuQCBcdTAwMDaQVTpvXHUwMDBmMnqLYFx1MDAwNkkuQJtcdTAwMTChVL092Fx0uTmIYFJjxlx1MDAxMClcdTAwMWEkXHUwMDAyVFx1MDAxMmWaKCnhL5O1ioZZQFxizlx1MDAxOGZSYkh9XHUwMDBi5ii2hCRcdTAwMDJcdTAwMTJcdTAwMWJcZpPg9eqGWVpcdTAwMTBNYVxciEEmLYvWhEVcdTAwMTWH7Y2agIlY7WxcdTAwMDGoZn1gXFxKU8w1KZqTluJUUIhHjEFcdTAwMTSus0bMbITEQH+mTHzgRXOw+8LaIW2ii8SydumIhNkyWGShNOJcdTAwMTKxoie0ZVSnlEJcdTAwMTNcdTAwMDBcdTAwMTOv1ZZEYXCu0Fx1MDAxMJpA5FJdXHUwMDFjXHUwMDFkaFx1MDAwM2xyLlxyT8RcXLJaZWjMwaJcdTAwMTDQhFxig+tU0Vx1MDAxN+B3hTjWXFxweCCtXHUwMDA1sjFcdTAwMDdcdTAwMGJIXHUwMDE1UUyBd1x1MDAwYq7QXHUwMDE25IFcdTAwMTBrIahwsFpvTEKUxkyA81x1MDAxOKRkRb82kVx1MDAwNYzgWCp4XHUwMDFjgIVQUW9QgGtcdTAwMTFcdTAwMDXVRCWQXG5cdTAwMTfWriksXHUwMDA0Wlx1MDAwNfSjllJcdTAwMDFcdTAwMTVprTlCLZA2SFx1MDAwMbKgq1x1MDAxNKpgz+gwXHUwMDAytiiQXHUwMDE2gaNqh2eQz+GDKYXFhlx1MDAxMVx1MDAxNqDSxOApXHUwMDA2oVlcdTAwMTmmaUTqaSYsJTmgXHUwMDA0Jlx1MDAwNfGKXHUwMDE1p4uRRYlgwDQgNUxXLZHWWFxiolx1MDAxZGyLSoE7cqftqUGAXG6T4HaoXHUwMDAzLoLtWoPgQ9BmXHUwMDFjcVx1MDAwMktIuWK6ZFx1MDAxMuKYXHUwMDAwXHUwMDE4XHSmtZGRXG6pWqc8K/Nwfd9cdTAwMWLFXHUwMDE16k5l/phJPUDuMED2XG6HOoedTYUuXHUwMDBlmmenl2e902RndD1sXHUwMDBl11/fZb/TXHUwMDFlovpG4blcdTAwMTJcdTAwMGVcdTAwMDPnTVx1MDAxNIFtgmRJzFTCQeCkoCQlV1x1MDAxMiOBeJazP0o4iTTsviDx/kVcdTAwMTJu8Z3Gj9RqXHUwMDBieVB17UDwglx1MDAwNEeAqtcrZN++01x1MDAxY4tWKFx001x1MDAxZo4uPu5dXHUwMDFl6sNk3Vx1MDAxOSBZkVx1MDAwMVx1MDAwND/v6LLXc7Sj51x1MDAxZF2CXG5cdTAwMDLRQiWVsPNpoWcpIGfybWZ2XHUwMDBmkI8vnG0vXHUwMDA0XCJWVD3p2PJJXHUwMDE3XGa7XpyEkbk1+DPYsVx1MDAxM/upV1xySTiqumcojL18qVD9/KWuXHUwMDE3XHUwMDA0WsjDxbfduaukMlx1MDAxOc2hO+HZKtZxUcrt+PIq+rzVP9v2O4nqRFx1MDAwMdlbdy5ipErb0Vx1MDAxYVxccFx1MDAxYlx1MDAwMmBcdTAwMDZZ4UtcdTAwMWZ5PfGG2//S3lx1MDAxZnfOd27V+OpoZ0uPL+zj8Yo33CaZeemthldeoGGTJyHM+fJia/6k11x1MDAxZN6YXCJLa4FAISuTu67/XHUwMDFkt0LmuFx1MDAwM5LPn7lcdTAwMDH9QjfcNWH5p95wq0opXGLJOFx1MDAxNpBrL8/PXHUwMDAzt+N/uNtFcmtH9U7ej9pcdTAwMDfOO7n2/CRcdTAwMDJZkDgzRFx1MDAxOaSuOluPtb/ipoJTSOXZi+9RP3JcdTAwMWLJrd8vfbr8//32f/l+O7fLl3WPZlJLyFxil5f1x3y/vVx1MDAxZF1jdaQuXHUwMDAzp/Vuv3lcdTAwMTRurntcXNUlVb9eN9qUm5f48IvfaP/Q0DlcdTAwMTeOXHUwMDBmXHUwMDEwuYlcYrrX3aPWZDL48LZ14+6717lUeL5Mf3jVWJnzaFV8/Vx1MDAwMOMqZmcrLalFtFaUXHUwMDEzxM2lXHUwMDE3mV14vlxiJGW3u1x1MDAwMFx1MDAwYopXc/vPhv6PXHUwMDAxzeNL1Vx1MDAxNGtJ0Oz5tKmrlmlcdTAwMTBKzFupy5zYrfi+heRYo1x1MDAxNfA5o6r3gr5cdTAwMWInzXNv6P5cdTAwMTlsgyiG8rHte1/txExrrmRHhdJcbsn+xFx1MDAxM6GcXmZZ/FnhnGjZXHTNSPZcdTAwMDXU/UR553r/7vOkd9/tvj24/eo6aH9cdTAwMTnqXHUwMDFhr1uQQyOFNUFKq1xmXHUwMDAy/3P4J3FYQSzVguCZMz3D4cqDPlxmOp6DXHUwMDFjJMu8WLQqiVx1MDAxNaEqXHUwMDBmzFVJ3HbtyFx1MDAxOfxCJF52Qlx1MDAxNSR+9V1ONuzRqJ3AajdcdTAwMWXf2Wnceu5ka+71gPmY47k0XHUwMDA0XHUwMDE4yLvpqz7fXn37XHUwMDA3lJOVvSJ9",(0,n.yg)("defs",{parentName:"svg"},(0,n.yg)("style",{parentName:"defs"},'@font-face{font-family:"Virgil";src:url(https://excalidraw.com/Virgil.woff2)}@font-face{font-family:"Cascadia";src:url(https://excalidraw.com/Cascadia.woff2)}@font-face{font-family:"Assistant";src:url(https://app.excalidraw.com//dist/excalidraw-assets/Assistant-Regular.woff2)}')),(0,n.yg)("path",p({parentName:"svg"},{fill:"none",stroke:"#1e1e1e",strokeLineCap:"round",d:"M110 80c51.28-.69 100.5-1.92 180 0m-180 0c63.11.63 127.29.7 180 0m0 0c.75 21.48 2.19 43.89 0 100m0-100c-.56 19.58-.68 41.56 0 100m0 0c-56.8.27-111.65-.08-180 0m180 0c-46.38-2.05-89.94-2.57-180 0m0 0c1.46-38 1.05-77.17 0-100m0 100c-.22-23.62-1.54-45.27 0-100"})),(0,n.yg)("text",p({parentName:"svg"},{x:"39.004",fill:"#1e1e1e",dominantBaseline:"text-before-edge",fontFamily:"Virgil, Segoe UI Emoji",fontSize:"28",style:{whiteSpace:"pre"},textAnchor:"middle",transform:"translate(160.996 112.5)"}),"Enrich"),(0,n.yg)("g",p({parentName:"svg"},{fillRule:"evenodd",strokeLineCap:"round"}),(0,n.yg)("path",p({parentName:"g"},{fill:"none",stroke:"#e9ecef",strokeWidth:".5",d:"M290.696 109.37s0 0 0 0m0 0s0 0 0 0m.39 5.65c1.07-2.17 3.91-4.09 5.25-6.04m-5.25 6.04c1.4-1.17 2.19-2.9 5.25-6.04m-5.51 12.43c2.34-1.88 5.46-5.45 10.5-12.07m-10.5 12.07c3.02-3.8 6.98-8.08 10.5-12.07m-10.76 18.47c3.11-7.49 9.58-9.46 16.4-18.87m-16.4 18.87c5.37-5.09 8.88-10.93 16.4-18.87m-16.01 24.51c6.81-6.83 10.48-12.97 21-24.15m-21 24.15c8.56-9.1 17.69-19.19 21-24.15m-21.26 30.55c4.46-7.5 12.88-15.76 26.9-30.94m-26.9 30.94c7.06-8.87 14.65-16.74 26.9-30.94m-26.5 36.58c8.05-7.99 18.67-19.19 31.49-36.22m-31.49 36.22c11.65-13.66 25.13-29.52 31.49-36.22m-29.79 40.36c6.85-6.95 14.77-17.1 35.43-40.76m-35.43 40.76c9.41-10.45 18.17-21.44 35.43-40.76m-30.44 41.12c13.1-15.25 28.57-29.54 35.43-40.76m-35.43 40.76c9.63-10.66 18.28-21.18 35.43-40.76m-29.79 40.36c13.44-15.27 26.49-26.96 34.77-40m-34.77 40c9.86-11.46 19.53-23.46 34.77-40m13.12-15.09c.67-1.16 1.25-1.36 2.63-3.02m-2.63 3.02c.66-.44 1.14-1.41 2.63-3.02m-45.53 58.47c12.71-12.93 22.59-26.01 35.43-40.75m-35.43 40.75c11.41-14.19 24.81-28.84 35.43-40.75m7.87-9.06c.85-1.46 3.54-3.05 5.9-6.79m-5.9 6.79c2.13-2.91 4.56-5.29 5.9-6.79m-43.56 56.21c12.55-16.53 27.91-32.49 34.77-40m-34.77 40c9.14-9.35 15.58-17.72 34.77-40m2.63-3.02c2.2-3.66 4.82-5.68 9.18-10.56m-9.18 10.56c3.81-3.57 6.13-7.96 9.18-10.56m-41.59 53.94c16.96-19 31.91-36.07 45.27-52.08m-45.27 52.08c11.7-14.16 24.29-27.72 45.27-52.08m-39.63 51.68c8.43-12.29 20.41-19.81 42.65-49.05m-42.65 49.05c16.22-19.26 32.99-38.05 42.65-49.05m-37.66 49.42c7.8-10.42 19.88-24.32 41.33-47.55m-41.33 47.55c16.51-18.12 32.41-37.24 41.33-47.55m-35.69 47.15c7.04-10.77 16.9-16.61 38.71-44.53m-38.71 44.53c7.73-10.2 15.43-18.35 38.71-44.53m-33.72 44.89c10.09-8.83 17.42-17.37 37.4-43.02m-37.4 43.02c9.09-10.94 18.59-22.01 37.4-43.02m-31.76 42.63c8.82-8.35 16.07-17.03 34.77-40m-34.77 40c6.6-8.98 14.86-16.01 34.77-40m-29.78 40.36c8.02-10.01 19.32-20.74 33.46-38.49m-33.46 38.49c13.17-12.54 24.01-26.41 33.46-38.49m-32.41 43.37c7.37-10.4 15.79-17.96 35.43-40.75m-35.43 40.75c9.6-10.02 19.87-20.73 35.43-40.75m-35.03 46.4c13.91-14.7 25.42-30.3 38.7-44.53m-38.7 44.53c12.73-14.09 24.26-27.84 38.7-44.53m-38.97 50.93c10.51-12.68 20.43-23.31 41.99-48.31m-41.99 48.31c14.29-14.61 26.78-30.71 41.99-48.31m-35.69 47.16c11.6-13.35 25.71-29.08 39.37-45.29m-39.37 45.29c13.67-14.23 25.34-29.74 39.37-45.29m-26.51 36.59c8.18-11.16 15.21-19.36 29.53-33.96m-29.53 33.96c11.21-12.84 22.92-25.88 29.53-33.96m-16.67 25.26c6.64-6.06 11.53-14.29 20.34-23.39m-20.34 23.39c7.53-8.32 16.33-18.24 20.34-23.39m-7.48 14.7c3.38-3.69 6.34-9.91 10.5-12.08m-10.5 12.08c4.43-4.28 8.22-8.06 10.5-12.08"})),(0,n.yg)("path",p({parentName:"g"},{fill:"none",stroke:"#1e1e1e",d:"M290.816 149.23c17.5 1.95 31.66-.06 60.73 0m-60.73 0c14.44 1.16 30.91.19 60.73 0m0 0c-1.8 5.23-.91 9.8 0 20m0-20c-.05 5.26.21 8.26 0 20m0 0c16.08-9.43 31.99-24.43 59.27-40m-59.27 40c16.04-9.79 30.23-19.67 59.27-40m0 0c-20.41-11.22-39.51-24.17-60-40m60 40c-13.21-9.4-27.23-19.41-60-40m0 0c1.64 6.14.47 12.79 0 20m0-20c-.66 4.7.6 8.24 0 20m0 0c-16.84 2.04-36.98-.02-60 0m60 0c-22.09-.8-46.17 0-60 0m0 0c.63 12.75-.97 24.61 0 40m0-40c.38 12.41-.9 26.82 0 40m0 0s0 0 0 0m0 0s0 0 0 0"}))),(0,n.yg)("g",p({parentName:"svg"},{strokeLineCap:"round"}),(0,n.yg)("path",p({parentName:"g"},{fill:"none",stroke:"#e9ecef",strokeWidth:".5",d:"M10 109.23s0 0 0 0m0 0s0 0 0 0m-.26 6.4c1.66-1.43 3.16-4.73 5.25-6.04m-5.25 6.04c2.23-2.26 3.98-5.02 5.25-6.04m-4.86 11.68c2.53-3.68 6.67-8.21 10.5-12.07m-10.5 12.07c4.49-4.22 7.78-8.62 10.5-12.07M9.87 127.67c5.84-5.53 10.38-10.73 15.75-18.11M9.87 127.67c2.53-4.62 6.22-7.72 15.75-18.11m-15.35 23.75c5.18-6.78 15.76-16.7 20.99-24.15m-20.99 24.15c8.02-8.2 15-15.96 20.99-24.15M10 139.71c9.04-8.91 13.44-18.02 26.25-30.19M10 139.71c7.8-10.26 16.81-19.86 26.25-30.19M9.74 146.11c10.95-11.63 20.78-25.29 32.15-36.98M9.74 146.11c12.91-14.77 24.22-26.87 32.15-36.98m-29.78 40.36c9.54-8.58 18.26-21.35 34.77-40m-34.77 40c10.05-12.73 20.62-23.97 34.77-40m-29.79 40.36c7.69-9.96 20.21-23.1 35.43-40.76m-35.43 40.76c13.25-14.44 24.34-28.26 35.43-40.76m-29.78 40.36c12.83-14.96 22.4-26.67 34.77-40m-34.77 40c13.27-14.83 25.26-29.31 34.77-40m-29.79 40.36c11.32-11.06 21.07-22.95 35.43-40.75m-35.43 40.75c14.22-16.74 26.62-30.71 35.43-40.75m-29.78 40.36c12.62-14.3 24.08-28.09 34.77-40m-34.77 40c8.1-10.05 16.82-18 34.77-40m-29.79 40.36c10.95-9.13 17.16-22.85 35.43-40.76m-35.43 40.76c11.96-14.3 24.07-27.47 35.43-40.76M44 149.38c12.43-10.95 21.79-24.18 34.77-40m-34.77 40c9.6-11.86 19.35-22.73 34.77-40m-29.79 40.36c9.74-10.45 19.57-24.98 35.43-40.75m-35.43 40.75c8.79-11.26 17.73-19.88 35.43-40.75M53.97 150.1c8.26-9.72 19.3-19.35 35.43-40.75M53.97 150.1c13.38-14.81 26.33-29.44 35.43-40.75m-29.79 40.36c10.11-9.04 20.81-20.17 35.43-40.76m-35.43 40.76c12.33-13.8 25.04-27.31 35.43-40.76M64.6 150.07c11.87-13.57 20.42-24.69 35.43-40.76M64.6 150.07c6.4-7.83 14.32-17.37 35.43-40.76m-29.79 40.36c14.23-16.15 28.51-29.94 35.43-40.75m-35.43 40.75c13.11-16.69 28.18-33.3 35.43-40.75m-30.44 41.11c8.16-9.49 17.29-20.91 35.43-40.75m-35.43 40.75c7.57-8.5 15.18-17.47 35.43-40.75m-29.79 40.36c10.11-7.44 18.48-18.91 29.53-33.96m-29.53 33.96c10.85-12.2 21.42-24.37 29.53-33.96M85.86 150c10.31-12.36 20.74-20.87 24.27-27.92M85.86 150c6.75-7.91 11.06-14.22 24.27-27.92M91.5 149.6c7.93-5.9 11.24-13.97 19.03-21.88M91.5 149.6c7.29-8.24 14.36-17.25 19.03-21.88m-14.04 22.24c4.38-2.68 6.41-8.89 13.78-15.84m-13.78 15.84c2.73-3.92 6.36-7.48 13.78-15.84m-8.14 15.45c3.15-2.51 4.63-6.18 8.53-9.81m-8.53 9.81c3.72-3.16 6.28-7.63 8.53-9.81m-3.54 10.17c1.34-1.18 2.47-2.8 3.28-3.77m-3.28 3.77c.7-.69 1.32-1.79 3.28-3.77"})),(0,n.yg)("path",p({parentName:"g"},{fill:"none",stroke:"#1e1e1e",d:"M10 109.23c19.68-1.31 40.88.24 100 0m-100 0c26.18-.97 51.13-.25 100 0m0 0c-1.42 10.43-1.87 21.59 0 40m0-40c.36 14.89-.13 30.77 0 40m0 0c-28.46-1.07-53.94 2.65-100 0m100 0c-21.58 1.01-41.9.81-100 0m0 0c-1.47-9.63-1-22.93 0-40m0 40c.51-15.67.09-28.93 0-40"}))),(0,n.yg)("g",p({parentName:"svg"},{fillRule:"evenodd",strokeLineCap:"round"}),(0,n.yg)("path",p({parentName:"g"},{fill:"none",stroke:"#e9ecef",strokeWidth:".5",d:"M448.151 72.552s0 0 0 0m0 0s0 0 0 0m-.26 6.4c1.84-2.73 4.95-8.33 8.53-9.81m-8.53 9.81c1.77-2.62 4.38-4.58 8.53-9.81m-8.79 16.21c4.57-3.97 7.92-6.88 14.43-16.61m-14.43 16.61c2.99-4.47 7.88-9.13 14.43-16.61m-14.69 23c4.85-3.83 7.28-9.22 20.99-24.15m-20.99 24.15c4.94-6.57 10.81-12.8 20.99-24.15m-21.26 30.55c10.4-12.88 20.27-23.35 26.9-30.94m-26.9 30.94c9.39-10.52 17.83-21.1 26.9-30.94m-27.16 37.34c12.95-14.24 24.91-30.24 33.46-38.49m-33.46 38.49c8.56-9.27 18.13-21.45 33.46-38.49m-33.72 44.89c9.99-11.84 19.55-20.43 40.02-46.04m-40.02 46.04c8.81-9.9 17.86-20.53 40.02-46.04m-39.62 51.68c15.71-19.49 35.75-40.38 45.92-52.83m-45.92 52.83c14.34-17.24 28.79-33.73 45.92-52.83m-46.19 59.23c20.38-23.17 40.26-44.12 51.83-59.62m-51.83 59.62c18.46-21.36 37.16-42.43 51.83-59.62m-52.09 66.02c14.07-18.03 28.5-32.71 57.74-66.42m-57.74 66.42c19.05-20.91 35.59-41.85 57.74-66.42m-57.34 72.06c21.11-25.7 44.34-48.39 62.98-72.45m-62.98 72.45c16.86-19.76 34.84-39.73 62.98-72.45m-62.59 78.09c21.56-25.3 43.52-47.53 68.23-78.49m-68.23 78.49c17.72-19.7 33.83-39.34 68.23-78.49m-67.83 84.13c17.98-22.5 39.83-46.53 72.82-83.77m-72.82 83.77c25.96-29.82 50.2-57.62 72.82-83.77m-72.43 89.42c23.52-29.35 51.39-60.01 78.07-89.81m-78.07 89.81c30.54-34.87 62.45-69.34 78.07-89.81m-78.33 96.21c20.55-21.55 41.05-43.91 83.98-96.61m-83.98 96.61c25.69-29.6 48.92-57.5 83.98-96.61m-83.59 102.25c33.87-37.19 65.25-76.65 88.57-101.89m-88.57 101.89c25.24-28.49 49.45-57.25 88.57-101.89m-88.17 107.53c31.68-38.42 66.28-76.31 93.82-107.92m-93.82 107.92c19.69-24.59 41.13-48.28 93.82-107.92m-93.43 113.56c19.26-24.13 39.16-43.98 99.07-113.96m-99.07 113.96c28.81-35.48 59.44-70.66 99.07-113.96m-98.67 119.61c23.2-29.87 53.08-61.01 103.66-119.25m-103.66 119.25c40.25-44.91 79.7-90.98 103.66-119.25m-103.92 125.65c25.27-29.28 47.81-55.6 109.56-126.04m-109.56 126.04c39.2-46.16 80.36-92.79 109.56-126.04m-111.14 133.94c43.58-52.23 89.12-99.68 116.13-133.58m-116.13 133.58c24.86-30.22 50.29-59.29 116.13-133.58m-114.42 137.72c40.82-46.33 82.29-97.96 120.06-138.12m-120.06 138.12c48-53.7 94.27-108.78 120.06-138.12m-117.04 140.74c40.48-46.94 82.86-95.4 122.68-141.13m-122.68 141.13c44.63-48.55 87.11-98.18 122.68-141.13m-118.35 142.25c44.17-49.14 86.33-97.62 123.34-141.89m-123.34 141.89c25.56-31.38 52.64-61.4 123.34-141.89m-118.35 142.25c38.59-47.03 83.3-96.22 123.99-142.64m-123.99 142.64c44.78-49.66 87.79-98.86 123.99-142.64m-119.66 143.75c36.94-39.82 68.48-80.16 124.65-143.39m-124.65 143.39c40.23-48.65 81.99-95.93 124.65-143.39m-119.67 143.75c40.87-46.54 80.51-94.49 124.66-143.39m-124.66 143.39c47.93-54.63 93.98-106.69 124.66-143.39m-120.32 144.51c34.38-35.32 67.11-75.7 125.3-144.15m-125.3 144.15c36.69-44.46 74.77-87.33 125.3-144.15m-120.32 144.51c30.72-36.99 66.77-77.2 125.97-144.91m-125.97 144.91c45.36-51.9 88.5-102.59 125.97-144.91m-120.98 145.27c43.54-49.27 83.13-95.53 125.96-144.91m-125.96 144.91c46.84-52.85 92.33-105.88 125.96-144.91m-120.97 145.27c35.99-39.93 70.19-79.93 125.96-144.91m-125.96 144.91c49.78-57.41 96.89-111.32 125.96-144.91m-121.63 146.02c45.68-53 90.03-104.63 126.62-145.66m-126.62 145.66c28.99-34.47 59.14-67.07 126.62-145.66m-121.64 146.02c34.58-36.27 64.34-77.08 127.28-146.41m-127.28 146.41c42.19-49.21 84.99-97.69 127.28-146.41m-122.29 146.77c41.55-44.54 80.48-91.79 127.28-146.41m-127.28 146.41c35.6-41.88 71.49-82.81 127.28-146.41m-122.29 146.77c37.59-41.55 75.11-87.92 127.27-146.41m-127.27 146.41c31.08-38.3 62.82-73.15 127.27-146.41m-121.63 146.02c31.35-37.23 66.11-74.14 126.62-145.66m-126.62 145.66c47.8-53.94 94.33-107.2 126.62-145.66m-121.63 146.02c35.42-37.56 70.48-76.71 127.27-146.42m-127.27 146.42c43.71-49.13 87.64-98.56 127.27-146.42m-122.28 146.78c40.23-45.21 76.67-88.41 127.27-146.42m-127.27 146.42c25.22-30.41 52.92-62.7 127.27-146.42m-121.63 146.02c49.42-55.98 98.9-110.26 126.62-145.66m-126.62 145.66c48.23-58.49 99.31-116.54 126.62-145.66m-121.63 146.02c30.98-35.67 63.16-73.59 126.62-145.66m-126.62 145.66c28.53-31.4 56.27-63.52 126.62-145.66m-121.64 146.02c37.98-38.22 73.75-81.22 127.28-146.41m-127.28 146.41c47.56-54.04 94.39-107.93 127.28-146.41m-121.63 146.02c50.94-58.65 101.06-112.82 126.62-145.66m-126.62 145.66c31.65-37.68 61.86-73.78 126.62-145.66m-121.64 146.02c45.28-47.44 85.47-97.93 126.62-145.66m-126.62 145.66c50.12-56.76 99.99-115 126.62-145.66m-121.63 146.02c33.41-37.76 65.63-78.71 126.62-145.66m-126.62 145.66c32.13-36.77 64.29-73.14 126.62-145.66m-120.98 145.26c43.18-49.31 84.5-99.86 125.97-144.9m-125.97 144.9c48.72-53.25 95.18-109.04 125.97-144.9m-120.98 145.26c43.28-47.72 84.88-96.89 125.96-144.9m-125.96 144.9c27.74-34.07 56.49-68.66 125.96-144.9m-120.97 145.26c30.27-33.4 60.57-70.33 125.96-144.9m-125.96 144.9c48.99-55.52 96.35-112.52 125.96-144.9m-120.32 144.51c34.94-42.32 71.38-81.46 125.31-144.15m-125.31 144.15c33.73-39.67 67.22-79.77 125.31-144.15m-120.32 144.51c45.72-52.14 88.86-103.46 125.3-144.15m-125.3 144.15c31.09-37.87 63.98-75.3 125.3-144.15m-119.66 143.75c42.97-48.86 83.81-94.91 124-142.64m-124 142.64c40.68-49.51 82.98-97.74 124-142.64m-119.01 143c48.7-56.66 100.6-112.34 123.99-142.64m-123.99 142.64c27.61-31.24 55.32-63.36 123.99-142.64m-118.35 142.25c40.29-48.33 85.16-97.43 122.68-141.13m-122.68 141.13c32.35-37 63.26-72.76 122.68-141.13m-117.69 141.49c30.01-37.95 63.62-70.43 121.37-139.62m-121.37 139.62c31.31-35.7 61.57-73.2 121.37-139.62m-115.73 139.23c29.18-35.17 59.58-71.88 120.72-138.87m-120.72 138.87c37.37-44.4 75.2-89.43 120.72-138.87m-115.08 138.47c47.11-51.33 87.87-101.36 114.81-132.07m-114.81 132.07c38.1-44.85 77.63-88.7 114.81-132.07m-109.82 132.43c33-38.87 69.55-78.13 110.22-126.79m-110.22 126.79c33.22-36.92 64.74-75.07 110.22-126.79m-104.58 126.4c23.34-27.59 50.46-55.36 104.32-120m-104.32 120c40.08-46.97 81.15-92.64 104.32-120m-98.67 119.6c21.81-23.84 42.24-48.6 99.06-113.96m-99.06 113.96c23.03-28.81 47.61-56.14 99.06-113.96m-93.42 113.57c21.69-25.71 40.51-48.45 93.16-107.17m-93.16 107.17c29.15-34.43 60.05-68.59 93.16-107.17m-88.17 107.53c27.84-33.88 59.29-65.88 88.56-101.89m-88.56 101.89c23.33-27.79 46.83-54.86 88.56-101.89m-82.92 101.49c28.15-34.42 58.74-66.94 82.66-95.09m-82.66 95.09c32.13-36.83 62.72-74.06 82.66-95.09m-77.02 94.7c28.08-31.86 51.53-61.06 76.76-88.3m-76.76 88.3c26.98-30.67 54.82-63.24 76.76-88.3m-71.11 87.9c26.8-31.42 53.44-61.1 71.51-82.26m-71.51 82.26c17.43-21.68 38.21-44.87 71.51-82.26m-66.53 82.62c25-27.67 49.31-57.45 66.27-76.22m-66.27 76.22c25.23-29.46 50.89-57.97 66.27-76.22m-60.62 75.83c15.72-18.25 34.26-39.61 61.01-70.19m-61.01 70.19c21.13-25.28 43.33-51.18 61.01-70.19m-55.37 69.79c16.59-17.64 30.98-33.54 55.11-63.39m-55.11 63.39c13.69-16.99 28.34-33.52 55.11-63.39m-49.47 63c17.71-20.04 37.59-43.8 49.86-57.36m-49.86 57.36c13.65-15.4 27.75-32.05 49.86-57.36m-44.87 57.72c11.18-17.31 25.5-31.78 44.61-51.32m-44.61 51.32c17.5-20.99 36.02-41.03 44.61-51.32m-38.97 50.92c12.74-17.32 28.87-32.53 38.71-44.52m-38.71 44.52c13.48-17.11 28.74-32.66 38.71-44.52m-33.06 44.13c9.8-10.59 17.35-17.13 33.45-38.49m-33.45 38.49c9.17-11.58 17.62-20.08 33.45-38.49m-27.16 37.34c8.06-13.2 21.7-23.55 26.9-30.94m-26.9 30.94c10.58-11.77 20.06-22.4 26.9-30.94m-20.6 29.79c7.02-8.99 15.27-15.99 21-24.15m-21 24.15c5.65-5.92 9.3-9.73 21-24.15m-14.7 23c3.4-4.64 5.08-6.32 14.44-16.6m-14.44 16.6c4.6-5.92 10.24-11.67 14.44-16.6m-8.79 16.21c3.66-2.51 7.5-7.63 8.52-9.81m-8.52 9.81c2.74-2.58 4.51-5.62 8.52-9.81"})),(0,n.yg)("path",p({parentName:"g"},{fill:"none",stroke:"#000",d:"M448.861 72.292c-.32 9.38-3.14 37.44-2.93 56.16.2 18.72 3.76 44.6 4.13 56.16.38 11.57-4.05 9.83-1.89 13.23 2.17 3.4 3.96 5.31 14.87 7.17 10.91 1.86 28.2 3.12 50.57 3.99 22.36.88 55.99 1.36 83.61 1.26 27.63-.09 61.01-.47 82.15-1.83 21.14-1.35 36.17-4.35 44.67-6.29 8.5-1.93 5.13-2.65 6.33-5.31 1.19-2.65.92 8.33.85-10.63-.06-18.97-.82-84.21-1.23-103.15-.4-18.95 2.37-7.72-1.2-10.52-3.57-2.79-10.51-4.74-20.23-6.26-9.71-1.52-17.41-1.82-38.06-2.84-20.65-1.03-60.01-3.17-85.83-3.29-25.82-.13-48.26 1.15-69.08 2.53s-44.43 4.29-55.83 5.76c-11.41 1.46-10.84 2.36-12.6 3.01-1.76.66 1.94.72 2.03.93m-1.42-1.26c-.48 9.59-3.31 39.67-2.97 58.7.34 19.04 4.41 44.07 5.01 55.52.61 11.45-3.39 9.78-1.4 13.19 1.99 3.42 2.82 5.72 13.35 7.3s27.27 1.67 49.86 2.18c22.58.5 57.9.8 85.65.84 27.75.05 59.91.21 80.84-.55 20.93-.77 36.43-1.97 44.76-4.03 8.33-2.07 4.28-5.4 5.22-8.35.94-2.95.27 9.46.41-9.33.13-18.8.23-84.33.4-103.43.17-19.11 3.61-8.34.61-11.21-3-2.87-8.74-4.5-18.61-6-9.88-1.5-19.79-2.21-40.66-3.02-20.87-.8-58.62-1.9-84.55-1.78-25.94.12-50.42 1.17-71.06 2.51-20.63 1.34-41.8 4.27-52.74 5.52-10.94 1.25-10.34 1.16-12.89 1.99-2.56.83-2 2.92-2.44 2.99"}))),(0,n.yg)("g",p({parentName:"svg"},{strokeLineCap:"round"}),(0,n.yg)("path",p({parentName:"g"},{fill:"none",stroke:"#e9ecef",strokeWidth:".5",d:"M445.528 72.9s0 0 0 0m0 0s0 0 0 0m1.71 4.13c1.4-1.47 2.98-3.8 5.9-6.79m-5.9 6.79c1.78-1.62 2.95-3.43 5.9-6.79m-2.23 8.66c1.65-3.54 6.66-5.76 9.84-11.32m-9.84 11.32c2.61-2.05 3.76-4.21 9.84-11.32m-5.51 12.44c4.15-5.21 9.02-9.85 11.81-13.59m-11.81 13.59c3.63-5.84 8.89-9.78 11.81-13.59m-6.82 13.95c3.96-4.55 5.46-8.12 12.46-14.34m-12.46 14.34c3.81-3.04 5.7-6.19 12.46-14.34m-8.13 15.45c4.15-4.95 7.57-8.84 14.43-16.6m-14.43 16.6c2.98-4.08 6.08-8.02 14.43-16.6m-10.1 17.72c6.34-4.12 9.53-12.08 15.75-18.12m-15.75 18.12c3.87-4.83 7.42-8.54 15.75-18.12m-10.76 18.48c6.69-6.64 11.85-11.42 17.05-19.63m-17.05 19.63c6.25-5.7 10.01-11.03 17.05-19.63m-12.07 19.99c6.56-5.76 11.03-13.49 17.06-19.63m-17.06 19.63c5.55-6.12 9.66-10.28 17.06-19.63m-12.07 19.99c3.2-3.43 5.4-9.66 17.71-20.38m-17.71 20.38c6.98-7.71 12.17-13.26 17.71-20.38m-13.38 21.49c2.26-6.07 7.41-8.17 19.03-21.89m-19.03 21.89c5.51-7.36 13.34-14.57 19.03-21.89m-14.04 22.25c8.89-7.05 14.66-19.38 19.02-21.89m-19.02 21.89c7.07-7.37 14.37-16.27 19.02-21.89m-14.03 22.25c5.86-4.98 10.84-12.02 19.68-22.64m-19.68 22.64c3.37-5.18 7.62-9.15 19.68-22.64m-14.7 23c6.34-6.34 10.04-10.92 20.34-23.4m-20.34 23.4c5.51-7.13 11.07-13.92 20.34-23.4m-15.35 23.76c8.61-10.84 15.58-19.57 20.34-23.4m-20.34 23.4c4.59-7.36 10.56-11.72 20.34-23.4m-15.35 23.76c3.08-3.46 8.87-8.95 20.99-24.15m-20.99 24.15c4.89-6.08 10.73-13.83 20.99-24.15m-16.01 24.51c9.33-10.99 16.46-17.23 21.65-24.9m-21.65 24.9c5.13-6.12 9.25-11.14 21.65-24.9m-16.66 25.26c9.23-10.25 16.31-20.24 22.31-25.66m-22.31 25.66c7.22-9.51 16.6-19.1 22.31-25.66m-17.32 26.02c4.94-5.44 11.17-13.26 22.96-26.41m-22.96 26.41c4.71-6.64 10.57-12.28 22.96-26.41m-17.97 26.77c5.11-5.84 13.28-14.63 22.96-26.41m-22.96 26.41c6.37-6.87 12.67-14.47 22.96-26.41m-17.98 26.77c9.38-12.59 17.68-22.91 23.62-27.17m-23.62 27.17c8.25-9.46 15.42-16.16 23.62-27.17m-18.63 27.53c6.55-6.46 13.71-14.87 24.27-27.92m-24.27 27.92c9.29-10.02 18.82-22.42 24.27-27.92m-19.28 28.28c7.01-8.31 11.19-14.28 24.93-28.68m-24.93 28.68c9.14-9.54 17.28-19.64 24.93-28.68m-19.95 29.04c5.51-5.29 9.84-13.65 24.93-28.68m-24.93 28.68c8.79-10.9 20.26-22.26 24.93-28.68m-19.94 29.04c7.29-8.71 13.07-16.82 25.59-29.43m-25.59 29.43c8.7-10.7 17.68-18.96 25.59-29.43m-20.6 29.79c6.5-4.77 10.96-13.81 26.24-30.19m-26.24 30.19c9.69-10.81 19.05-23.31 26.24-30.19m-20.6 29.8c5.78-7.24 13.4-17.01 25.59-29.44m-25.59 29.44c8.28-7.58 14.92-15.94 25.59-29.44m-20.6 29.8c8.39-7.26 12.12-17.69 26.24-30.19m-26.24 30.19c10.8-11.45 20.07-23.49 26.24-30.19m-20.6 29.79c8.52-9.86 16.22-18.78 25.59-29.43m-25.59 29.43c9.36-9.61 19.14-21.6 25.59-29.43m-20.6 29.79c4.25-5.5 8.65-10.95 25.58-29.43m-25.58 29.43c6.17-7.06 14.16-15.63 25.58-29.43m-19.94 29.04c8.96-10.74 16.92-21.25 24.93-28.68m-24.93 28.68c6.3-8.66 15.01-17.27 24.93-28.68m-19.94 29.04c8.66-7.55 12.03-15.06 25.58-29.44m-25.58 29.44c9.75-11.31 19.37-21.19 25.58-29.44m-19.94 29.04c10.78-11.16 20.36-22.72 24.93-28.68m-24.93 28.68c10.04-10.41 19.87-20.56 24.93-28.68m-19.94 29.04c8.12-10.46 18.58-20.08 24.93-28.67m-24.93 28.67c7.41-8.51 15.12-18.71 24.93-28.67m-19.29 28.28c6.99-10.17 16.29-17.82 24.27-27.92m-24.27 27.92c6.6-8.44 14.56-16.84 24.27-27.92m-18.63 27.52c9.15-11.13 15.99-18.83 23.62-27.16m-23.62 27.16c4.56-5.91 10.05-11.33 23.62-27.16m-18.63 27.52c6.39-8.71 14.48-16.87 24.28-27.92m-24.28 27.92c7.61-8.6 17.59-18.11 24.28-27.92m-18.64 27.53c7.06-8.41 14.64-17.2 23.62-27.17m-23.62 27.17c9.51-9.98 17.33-19.96 23.62-27.17m-17.97 26.78c8.05-7.68 14.35-20.5 22.96-26.42m-22.96 26.42c5.73-6.94 13.96-16.23 22.96-26.42m-17.98 26.78c6.29-9.65 16.17-19.69 22.97-26.42m-22.97 26.42c7.33-7.78 14.78-16.6 22.97-26.42m-17.32 26.02c6.43-8.78 12.84-15.71 22.3-25.66m-22.3 25.66c8.25-9 16.36-19.2 22.3-25.66m-16.66 25.27c6.46-7.2 16.49-17.93 21.65-24.91m-21.65 24.91c5.76-5.78 11.18-12.09 21.65-24.91m-16.66 25.27c7.27-6.39 12.18-13.41 21.65-24.91m-21.65 24.91c6.02-7.66 13.41-15.08 21.65-24.91m-16.01 24.51c6.76-3.78 11.75-10.89 20.99-24.15m-20.99 24.15c4.75-5.75 9.04-10.97 20.99-24.15m-15.35 23.76c6.63-7.7 14.05-18.28 20.34-23.4m-20.34 23.4c4.23-5.27 9.5-12.13 20.34-23.4m-14.69 23c5.3-5.66 7.88-8.75 19.02-21.88m-19.02 21.88c5.4-5.19 9.62-11.24 19.02-21.88m-13.38 21.49c7.67-7.9 12.52-15.01 18.37-21.13m-18.37 21.13c5.47-7.82 12.48-14.15 18.37-21.13m-12.73 20.73c6.46-6.93 12.83-12.89 17.72-20.37m-17.72 20.37c5.8-6.64 10.55-11.04 17.72-20.37m-12.07 19.98c5.95-3.99 8.8-10.12 17.05-19.62m-17.05 19.62c4.87-5.78 8.12-9.65 17.05-19.62m-11.41 19.22c6.09-5.26 13.43-14.73 15.74-18.11m-15.74 18.11c4.31-5.94 9.53-11.72 15.74-18.11m-9.44 16.97c5.57-4 8.68-8.95 14.43-16.61m-14.43 16.61c3.18-2.99 6.64-8.85 14.43-16.61m-7.48 14.7c3.11-5.85 7.11-9.6 11.81-13.58m-11.81 13.58c3.6-5.2 8.37-9.06 11.81-13.58m-5.51 12.43c2.52-2.63 6.6-7.85 9.19-10.56m-9.19 10.56c2.93-3.84 6.12-6.32 9.19-10.56m-2.89 9.41c2.57-3.04 4.83-5.46 6.56-7.54m-6.56 7.54c2.92-2.8 5.38-5.85 6.56-7.54"})),(0,n.yg)("path",p({parentName:"g"},{fill:"none",stroke:"#000",d:"M641.718 61.52c16 .53 32.18 2.09 44.43 3.13 12.25 1.03 22.2 1.59 29.05 3.07 6.85 1.48 11.11 3.76 12.04 5.82.93 2.05-1.11 4.6-6.45 6.51-5.35 1.9-14.63 3.51-25.62 4.91-10.99 1.4-25.35 2.68-40.31 3.47s-32.84 1.06-49.45 1.28c-16.61.22-33.79.69-50.19.05-16.4-.65-33.89-2.64-48.19-3.92-14.29-1.27-27.82-2.44-37.59-3.73-9.76-1.29-16.95-2.53-20.98-4.02-4.03-1.48-5.5-3.07-3.2-4.88s8.63-4.24 17-5.98c8.38-1.75 20.39-3.56 33.23-4.48 12.85-.93 27.83-.57 43.84-1.09 16-.52 33.86-1.92 52.19-2.04 18.33-.12 47.44 1.03 57.8 1.31 10.36.29 5.29.15 4.34.39m-117.7-1.1c14.38-.89 33.02-.29 49.92-.13 16.91.15 35.36.27 51.49 1.05 16.13.78 32.59 2.44 45.27 3.61 12.68 1.18 23.62 1.85 30.79 3.44 7.16 1.59 10.98 4.6 12.19 6.11 1.21 1.51-.29 1.29-4.94 2.97-4.64 1.68-12.88 5.52-22.94 7.09-10.06 1.57-22.92 1.4-37.39 2.32-14.47.92-32.69 3-49.45 3.22-16.76.22-34.35-1.58-51.12-1.9-16.76-.32-35.12.73-49.48-.04s-26.75-3.11-36.69-4.57c-9.95-1.46-18.08-2.65-22.97-4.19-4.89-1.55-7.88-3.1-6.35-5.08 1.52-1.98 7.8-5.27 15.5-6.78 7.71-1.52 18.35-1.08 30.72-2.33 12.38-1.25 35.72-4.32 43.54-5.17 7.83-.84 2.34-.51 3.44.08"}))),(0,n.yg)("text",p({parentName:"svg"},{x:"63.182",fill:"#1e1e1e",dominantBaseline:"text-before-edge",fontFamily:"Virgil, Segoe UI Emoji",fontSize:"28",style:{whiteSpace:"pre"},textAnchor:"middle",transform:"translate(524.408 115)"}),"Historical"),(0,n.yg)("text",p({parentName:"svg"},{x:"63.182",y:"35",fill:"#1e1e1e",dominantBaseline:"text-before-edge",fontFamily:"Virgil, Segoe UI Emoji",fontSize:"28",style:{whiteSpace:"pre"},textAnchor:"middle",transform:"translate(524.408 115)"}),"Data"),(0,n.yg)("path",p({parentName:"svg"},{fill:"none",stroke:"#1e1e1e",strokeLineCap:"round",d:"M864.408 80c61.23-.33 125.63.41 180 0m-180 0c46.39-1.62 92.88-1.31 180 0m0 0c-2 30.57-.66 57.42 0 100m0-100c.88 30.22.29 59.79 0 100m0 0c-48 2.7-95.28-.29-180 0m180 0c-58.04-2.27-118.28-.72-180 0m0 0c.65-35.08-1.9-68.23 0-100m0 100c.65-26.45.39-53.73 0-100"})),(0,n.yg)("text",p({parentName:"svg"},{x:"39.004",fill:"#1e1e1e",dominantBaseline:"text-before-edge",fontFamily:"Virgil, Segoe UI Emoji",fontSize:"28",style:{whiteSpace:"pre"},textAnchor:"middle",transform:"translate(915.404 112.5)"}),"Enrich"),(0,n.yg)("g",p({parentName:"svg"},{fillRule:"evenodd",strokeLineCap:"round"}),(0,n.yg)("path",p({parentName:"g"},{fill:"none",stroke:"#e9ecef",strokeWidth:".5",d:"M1045.105 109.37s0 0 0 0m0 0s0 0 0 0m.39 5.65c.46-.72 2.26-2.83 5.25-6.04m-5.25 6.04c1.8-2.32 3.7-4.06 5.25-6.04m-5.51 12.43c3.74-4.96 7.11-9.33 10.5-12.07m-10.5 12.07c4.31-5.14 7.85-9.34 10.5-12.07m-10.76 18.47c4.81-5.04 8.49-6.4 16.4-18.87m-16.4 18.87c4.37-4.62 7.25-8.5 16.4-18.87m-16.01 24.51c7.21-8.42 14.46-17.53 21-24.15m-21 24.15c3.71-4.91 10.03-10.36 21-24.15m-21.26 30.55c8.13-9.3 14.92-16.95 26.9-30.94m-26.9 30.94c7.85-9.52 14.8-18.66 26.9-30.94m-26.5 36.58c11.52-13.17 20.73-24.93 31.49-36.22m-31.49 36.22c11.24-12.87 21.62-25.52 31.49-36.22m-30.44 41.11c11.84-14.35 23.21-24.24 36.08-41.51m-36.08 41.51c10.03-10.61 17.93-22.3 36.08-41.51m-31.1 41.87c9.55-12.08 19.28-21.21 36.09-41.51m-36.09 41.51c7.68-7.57 15.16-16.65 36.09-41.51m-30.44 41.12c7.92-6.64 14.04-14.62 35.42-40.76m-35.42 40.76c8.09-8.01 16.33-17.65 35.42-40.76m15.75-18.11s0 0 0 0m0 0s0 0 0 0m-46.19 59.23c7.76-12.31 20.33-22.37 36.09-41.51m-36.09 41.51c8.86-10.06 16.21-18.91 36.09-41.51m9.84-11.32c1.22-.93 1.86-2.62 3.28-3.77m-3.28 3.77c1.07-1.2 2.45-2.78 3.28-3.77m-43.56 56.2c7.58-11.67 19.41-20.15 35.42-40.75m-35.42 40.75c9.65-11.56 20.79-24.62 35.42-40.75m4.6-5.28c1.04-1.33 2.83-4.22 7.21-8.3m-7.21 8.3c2.54-2.72 5.11-6.41 7.21-8.3m-42.25 54.69c13.15-13.49 25.59-26.55 45.27-52.07m-45.27 52.07c10.81-12.05 20.89-23.89 45.27-52.07m-39.62 51.68c13.33-15.2 25.27-26.83 43.3-49.81m-43.3 49.81c14.47-16.12 28.63-33.61 43.3-49.81m-38.32 50.17c14.49-19.44 33.31-35.98 41.34-47.55m-41.34 47.55c8.63-11.35 19.14-22.78 41.34-47.55m-35.69 47.16c16.78-16.57 28.49-36.03 39.36-45.29m-39.36 45.29c11.88-14.56 24.17-28.03 39.36-45.29m-34.38 45.65c10.73-12.04 20.31-20.13 37.4-43.02m-37.4 43.02c9.6-11.46 18.56-21.88 37.4-43.02m-31.75 42.62c7.81-9.68 16.74-20.69 35.42-40.75m-35.42 40.75c7.48-9.48 15.58-16.4 35.42-40.75m-30.44 41.11c11.2-12.11 20.35-23.65 33.46-38.49m-33.46 38.49c7.36-8.9 16.09-18.41 33.46-38.49m-29.13 39.61c10.61-14.03 23.47-24.59 32.81-37.74m-32.81 37.74c7.28-10.34 16.5-18.68 32.81-37.74m-33.07 44.13c10.5-12.77 23.61-26.48 36.09-41.51m-36.09 41.51c11.1-12.64 21.39-24.45 36.09-41.51m-35.69 47.16c9.12-9.71 19.04-20.94 39.36-45.29m-39.36 45.29c12.86-14.52 23.34-28.57 39.36-45.29m-40.28 52.44c9.96-14.47 20.62-26.78 43.3-49.81m-43.3 49.81c15.1-17.59 30.87-34.31 43.3-49.81m-30.44 41.11c11.28-9.19 19.72-20.21 34.12-39.24m-34.12 39.24c11.94-13.95 24.41-27.18 34.12-39.24m-21.26 30.55c7.47-5.95 11.76-15.52 24.27-27.93m-24.27 27.93c5.16-6 12.5-13.97 24.27-27.93m-11.41 19.23c2.02-4.8 6.98-10.29 15.09-17.36m-15.09 17.36c3.58-3.3 7.25-8.73 15.09-17.36"})),(0,n.yg)("path",p({parentName:"g"},{fill:"none",stroke:"#1e1e1e",d:"M1045.225 149.23c15.61 1.49 34.09-.55 60.73 0m-60.73 0c15.08-.79 30.17-.42 60.73 0m0 0c-.02 7.32.25 15.62 0 20m0-20c-.37 7.55.86 13.18 0 20m0 0c22.24-13.13 41.47-26.79 59.27-40m-59.27 40c13.51-8.93 25.72-17.42 59.27-40m0 0c-13.15-10.42-26.43-17.73-60-40m60 40c-22.86-14.24-44.34-30.09-60-40m0 0c.22 8.13-.25 15.49 0 20m0-20c.8 5.47-.64 10.59 0 20m0 0c-23.6-1.55-46.15-.79-60 0m60 0c-21.59.05-42.23-.23-60 0m0 0c-1.21 10.25 1.88 23.63 0 40m0-40c.97 15.2.42 31.35 0 40m0 0s0 0 0 0m0 0s0 0 0 0"}))),(0,n.yg)("g",p({parentName:"svg"},{strokeLineCap:"round"}),(0,n.yg)("path",p({parentName:"g"},{fill:"none",stroke:"#e9ecef",strokeWidth:".5",d:"M764.408 109.23s0 0 0 0m0 0s0 0 0 0m-.26 6.4c1.03-1.31 2.55-2.9 5.25-6.04m-5.25 6.04c.95-1.32 2.37-2.38 5.25-6.04m-4.86 11.68c2.56-1.65 5.54-5.47 10.5-12.07m-10.5 12.07c4.67-5.06 8.49-9.19 10.5-12.07m-10.76 18.47c6.08-5.26 8.12-10.62 15.75-18.11m-15.75 18.11c4.25-4.9 8.75-10.17 15.75-18.11m-15.35 23.75c7.87-11.64 15.78-19.1 20.99-24.15m-20.99 24.15c8.04-7.68 14.25-18.15 20.99-24.15m-21.26 30.55c7.84-9.65 16.92-18.1 26.25-30.19m-26.25 30.19c4.93-5.11 11.19-11.23 26.25-30.19m-26.51 36.59c11.33-14.15 24.74-24.19 32.15-36.98m-32.15 36.98c7.01-8.32 14.21-17.78 32.15-36.98m-30.44 41.11c14.46-13.37 24.89-28.77 35.43-40.75m-35.43 40.75c11.73-13.69 23.83-27.03 35.43-40.75m-30.44 41.11c12.02-14.6 23.98-27.37 36.08-41.51m-36.08 41.51c13.21-13.52 24.62-28.12 36.08-41.51m-30.44 41.12c10.1-11.4 17.83-21.86 35.43-40.76m-35.43 40.76c13.11-16.51 27.55-31.97 35.43-40.76m-30.44 41.12c10.2-13.13 21.75-25.04 36.08-41.51m-36.08 41.51c13.15-15.81 27.43-31.72 36.08-41.51m-30.44 41.11c8.11-7.12 13.83-15.78 35.43-40.75m-35.43 40.75c10.57-14.02 22.58-27.11 35.43-40.75m-30.44 41.11c12.49-13.15 24.06-29.72 36.08-41.51m-36.08 41.51c8.67-9.83 15.69-19.65 36.08-41.51m-30.44 41.12c8.66-9.04 17-19.75 35.43-40.76m-35.43 40.76c7.78-8.23 13.23-17.12 35.43-40.76m-30.44 41.12c6.64-7.64 15.63-17.94 36.08-41.51m-36.08 41.51c14.16-14.8 25.9-29.5 36.08-41.51m-30.44 41.11c10.31-10.34 15.78-20.32 35.43-40.75m-35.43 40.75c11.44-13.6 23.72-27.4 35.43-40.75m-30.44 41.11c12.76-16.89 26.97-31.78 36.08-41.51m-36.08 41.51c7.71-8.89 14.41-16.4 36.08-41.51m-30.44 41.12c12.8-11.73 22.98-24.76 35.43-40.76m-35.43 40.76c12.36-14.44 23.78-26.87 35.43-40.76m-30.44 41.12c6.32-8.9 17.27-20.13 36.08-41.51m-36.08 41.51c13.02-16.09 26.66-31.18 36.08-41.51m-30.44 41.11c11.19-10.42 17.52-21.37 35.43-40.75m-35.43 40.75c9.45-10.85 19.19-22.64 35.43-40.75m-30.44 41.11c8.86-8.24 15-17.39 30.18-34.71m-30.18 34.71c7.51-9.74 17.17-18.5 30.18-34.71m-25.2 35.07c6.66-5.15 9.46-10.59 24.93-28.67m-24.93 28.67c8.29-9.57 16.84-18.86 24.93-28.67m-19.28 28.28c5.64-10.08 14.84-15.98 19.68-22.64m-19.68 22.64c5.48-6.21 9.68-12.02 19.68-22.64m-14.7 23c5.16-3.1 6.19-6.33 14.44-16.6m-14.44 16.6c4.18-4.9 8.02-9.3 14.44-16.6m-8.79 16.21c1.46-2.65 3.17-5.13 9.18-10.57m-9.18 10.57c3.32-2.68 5.54-6.73 9.18-10.57m-4.2 10.93c.93-1.28 1.64-1.87 3.94-4.53m-3.94 4.53c1.46-1.52 2.69-2.76 3.94-4.53"})),(0,n.yg)("path",p({parentName:"g"},{fill:"none",stroke:"#1e1e1e",d:"M764.408 109.23c32.01-1.27 60.55-1.57 100 0m-100 0c27.86.38 56.42 1.05 100 0m0 0c.22 10.3.88 17.95 0 40m0-40c.67 12.33.45 25.02 0 40m0 0c-22.7 1.91-43.84-.95-100 0m100 0c-37.59.64-75.32-.63-100 0m0 0c-.82-9.15 1.52-18.75 0-40m0 40c.3-15.05.74-28.64 0-40"}))),(0,n.yg)("text",p({parentName:"svg"},{x:"86.65",fill:"#e03131",dominantBaseline:"text-before-edge",fontFamily:"Virgil, Segoe UI Emoji",fontSize:"20",style:{whiteSpace:"pre"},textAnchor:"middle",transform:"translate(113.35 10)"}),"Ingest-Time"),(0,n.yg)("text",p({parentName:"svg"},{x:"86.65",y:"25",fill:"#e03131",dominantBaseline:"text-before-edge",fontFamily:"Virgil, Segoe UI Emoji",fontSize:"20",style:{whiteSpace:"pre"},textAnchor:"middle",transform:"translate(113.35 10)"}),"Contextualization"),(0,n.yg)("text",p({parentName:"svg"},{x:"86.65",fill:"#e03131",dominantBaseline:"text-before-edge",fontFamily:"Virgil, Segoe UI Emoji",fontSize:"20",style:{whiteSpace:"pre"},textAnchor:"middle",transform:"translate(867.758 10)"}),"Search-Time"),(0,n.yg)("text",p({parentName:"svg"},{x:"86.65",y:"25",fill:"#e03131",dominantBaseline:"text-before-edge",fontFamily:"Virgil, Segoe UI Emoji",fontSize:"20",style:{whiteSpace:"pre"},textAnchor:"middle",transform:"translate(867.758 10)"}),"Contextualization")))),(0,n.yg)("p",null,'When we refer to "enrichment" we typically mean performing an API call, joining\nthe data at hand with another table/index in a SIEM, or a doing a lookup with\nstatic data in CSV file. As shown above, we can do this either at ',(0,n.yg)("em",{parentName:"p"},"ingest-time"),"\nbefore persisting the data, or at ",(0,n.yg)("em",{parentName:"p"},"search-time")," when we retrieve historical\ndata. There are also streaming-only use cases without historical data, but\nthese can often be modeled as ingest-time enrichment with a different sink."),(0,n.yg)("h2",p({},{id:"existing-solutions"}),"Existing Solutions"),(0,n.yg)("p",null,"Let's see how Splunk, Elastic, and Azure Data Explorer handle enrichment."),(0,n.yg)("h3",p({},{id:"splunk"}),"Splunk"),(0,n.yg)("p",null,(0,n.yg)("a",p({parentName:"p"},{href:"https://www.linkedin.com/in/inode/"}),"Alex Teixeira")," wrote a great article on\n",(0,n.yg)("a",p({parentName:"p"},{href:"https://detect.fyi/the-salamander-method-how-to-maintain-dynamic-splunk-lookups-4fdae5868e7e"}),"maintaining dynamic lookups in\nSplunk"),". Here's the visual summary of his approach:"),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"Salamander Method",src:a(62112).A,width:"611",height:"580"})),(0,n.yg)("p",null,"Suppose we have a Splunk index called ",(0,n.yg)("inlineCode",{parentName:"p"},"web_access_logs")," where we log web access\nevents, and we want to maintain a weekly updated lookup table of unique visitor\nIP addresses and their last visit date. Let's create an initial lookup table,\nnamed ",(0,n.yg)("inlineCode",{parentName:"p"},"weekly_visitors.csv"),", with fields like ",(0,n.yg)("inlineCode",{parentName:"p"},"ip_address")," and\n",(0,n.yg)("inlineCode",{parentName:"p"},"last_visit_date"),". Then we'll set up a scheduled search to run weekly. The\nsearch should:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Extract the latest week's unique IP addresses and their last visit date\nfrom ",(0,n.yg)("inlineCode",{parentName:"li"},"web_access_logs"),"."),(0,n.yg)("li",{parentName:"ul"},"Load the existing ",(0,n.yg)("inlineCode",{parentName:"li"},"weekly_visitors.csv")," using ",(0,n.yg)("inlineCode",{parentName:"li"},"inputlookup"),"."),(0,n.yg)("li",{parentName:"ul"},"Merge and update the data, discarding IPs older than 7 days."),(0,n.yg)("li",{parentName:"ul"},"Output the updated table using ",(0,n.yg)("inlineCode",{parentName:"li"},"outputlookup"),".")),(0,n.yg)("p",null,"Here's the SPL for for the scheduled search:"),(0,n.yg)("figure",p({},{"data-rehype-pretty-code-figure":""}),(0,n.yg)("pre",p({parentName:"figure"},{tabIndex:0,"data-language":"spl","data-theme":"github-dark-default"}),(0,n.yg)("code",p({parentName:"pre"},{"data-language":"spl","data-theme":"github-dark-default",style:{display:"grid"}}),(0,n.yg)("span",p({parentName:"code"},{"data-line":""}),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#FFA657"}}),"index"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#FF7B72"}}),"="),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#A5D6FF"}}),'"web_access_logs"'),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#79C0FF"}})," earliest"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#FF7B72"}}),"="),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}}),"-7d@d "),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#79C0FF"}}),"latest"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#FF7B72"}}),"="),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}}),"@d")),"\n",(0,n.yg)("span",p({parentName:"code"},{"data-line":""}),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}}),"|"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#79C0FF"}})," stats"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#79C0FF"}})," latest"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}}),"("),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#FFA657"}}),"_time"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}}),") "),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#79C0FF"}}),"as"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}})," last_visit "),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#79C0FF"}}),"by"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}})," ip_address")),"\n",(0,n.yg)("span",p({parentName:"code"},{"data-line":""}),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}}),"|"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#79C0FF"}})," eval"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#FFA657"}})," last_visit_date"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#FF7B72"}}),"="),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#79C0FF"}}),"strftime"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}}),"("),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#FFA657"}}),"last_visit"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}}),", "),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#A5D6FF"}}),'"%F"'),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}}),")")),"\n",(0,n.yg)("span",p({parentName:"code"},{"data-line":""}),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}}),"|"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#79C0FF"}})," inputlookup"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#FFA657"}})," append"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#FF7B72"}}),"="),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#79C0FF"}}),"true"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}})," weekly_visitors.csv")),"\n",(0,n.yg)("span",p({parentName:"code"},{"data-line":""}),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}}),"|"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#79C0FF"}})," dedup"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}})," ip_address sortby -last_visit")),"\n",(0,n.yg)("span",p({parentName:"code"},{"data-line":""}),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}}),"|"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#79C0FF"}})," where"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}})," last_visit >"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#FF7B72"}}),"="),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#79C0FF"}})," relative_time"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}}),"("),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#79C0FF"}}),"now"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}}),"(), "),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#A5D6FF"}}),'"-7d@d"'),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}}),")")),"\n",(0,n.yg)("span",p({parentName:"code"},{"data-line":""}),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}}),"|"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#79C0FF"}})," outputlookup"),(0,n.yg)("span",p({parentName:"span"},{style:{color:"#E6EDF3"}})," weekly_visitors.csv"))),(0,n.yg)("button",p({parentName:"pre"},{type:"button",data:'index="web_access_logs" earliest=-7d@d latest=@d\n| stats latest(_time) as last_visit by ip_address\n| eval last_visit_date=strftime(last_visit, "%F")\n| inputlookup append=true weekly_visitors.csv\n| dedup ip_address sortby -last_visit\n| where last_visit >= relative_time(now(), "-7d@d")\n| outputlookup weekly_visitors.csv',title:"Copy code","aria-label":"Copy code",className:"rehype-pretty-copy","data-feedback-duration":"3000","data-name":"rehype-pretty-copy-button"}),(0,n.yg)("span",p({parentName:"button"},{className:"ready"})),(0,n.yg)("span",p({parentName:"button"},{className:"success"}))),(0,n.yg)("style",{parentName:"pre"},'\n    :root {\n      --copy-icon: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgdmlld0JveD0iMCAwIDM2IDM2Ij48cmVjdCB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIGZpbGw9Im5vbmUiLz48cGF0aCBmaWxsPSIjYmZjN2Q1IiBkPSJNMjkuNSA3aC0xOUExLjUgMS41IDAgMCAwIDkgOC41djI0YTEuNSAxLjUgMCAwIDAgMS41IDEuNWgxOWExLjUgMS41IDAgMCAwIDEuNS0xLjV2LTI0QTEuNSAxLjUgMCAwIDAgMjkuNSA3TTI5IDMySDExVjloMThaIiBjbGFzcz0iY2xyLWktb3V0bGluZSBjbHItaS1vdXRsaW5lLXBhdGgtMSIvPjxwYXRoIGZpbGw9IiNiZmM3ZDUiIGQ9Ik0yNiAzLjVBMS41IDEuNSAwIDAgMCAyNC41IDJoLTE5QTEuNSAxLjUgMCAwIDAgNCAzLjV2MjRBMS41IDEuNSAwIDAgMCA1LjUgMjlINlY0aDIwWiIgY2xhc3M9ImNsci1pLW91dGxpbmUgY2xyLWktb3V0bGluZS1wYXRoLTIiLz48cGF0aCBmaWxsPSJub25lIiBkPSJNMCAwaDM2djM2SDB6Ii8+PC9zdmc+");\n      --success-icon: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cmVjdCB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIGZpbGw9Im5vbmUiLz48cGF0aCBmaWxsPSIjMDBkNjAwIiBkPSJNMjEgN0w5IDE5bC01LjUtNS41bDEuNDEtMS40MUw5IDE2LjE3TDE5LjU5IDUuNTl6Ii8+PC9zdmc+");\n    }\n\n    pre:has(code) {\n      position: relative;\n    }\n\n    button[data=\'<span>\'] {\n      width: 0;\n      height: 0;\n      display: none;\n      visibility: hidden;\n    }\n\n    pre button.rehype-pretty-copy {\n      top: 1px;\n      right: 1px;\n      padding: 0;\n      width: 24px;\n      height: 24px;\n      display: flex;\n      cursor: pointer;\n      margin-top: 8px;\n      margin-right: 8px;\n      position: absolute;\n      border-radius: 25%;\n      & span {\n        width: 100%;\n        aspect-ratio: 1 / 1;\n        background-repeat: no-repeat;\n      }\n      & .ready {\n        background-image: var(--copy-icon);\n      }\n      & .success {\n        display: none;\n        background-image: var(--success-icon);\n      }\n    }\n\n    &.rehype-pretty-copied { \n      & .success { \n        display: block;\n      } & .ready {\n        display: none;\n      }\n    }\n\n    pre button.rehype-pretty-copy.rehype-pretty-copied {\n      opacity: 1;\n      cursor: default;\n      & .ready { display: none; }\n      & .success { display: block; }\n    }\n\n      pre button.rehype-pretty-copy { opacity: 0; }\n      button[data-name="rehype-pretty-copy-button"]:hover {\n        opacity: 1;\n      }\n    '))),(0,n.yg)("p",null,"In detail:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},'index="web_access_logs" earliest=-7d@d latest=@d'),": Fetches the last week's\nweb access logs."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"stats latest(_time) as last_visit by ip_address"),": Aggregates the latest visit\ntime for each IP."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},'eval last_visit_date=strftime(last_visit, "%F")'),": Formats the last visit\ndate."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"inputlookup append=true weekly_visitors.csv"),": Appends current lookup data for\ncomparison."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"dedup ip_address sortby -last_visit"),": Removes duplicate IPs, keeping the most\nrecent."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},'where last_visit >= relative_time(now(), "-7d@d")'),": Filters out IPs older\nthan 7 days."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"outputlookup weekly_visitors.csv"),": Updates the lookup table with the new\ndata.")),(0,n.yg)("p",null,'This query demonstrates Alex\' "Salamander Method" by regularly updating the\nlookup table with recent data while discarding outdated records, maintaining an\nup-to-date context for data enrichment.'),(0,n.yg)("p",null,"You'd use it as follows:"),(0,n.yg)("pre",null,(0,n.yg)("code",p({parentName:"pre"},{}),'index="network_security_events"\n| lookup weekly_visitors.csv ip_address as source_ip OUTPUT last_visit_date\n')),(0,n.yg)("p",null,"The ",(0,n.yg)("inlineCode",{parentName:"p"},"lookup")," command enriches each event with the ",(0,n.yg)("inlineCode",{parentName:"p"},"last_visit_date")," from\n",(0,n.yg)("inlineCode",{parentName:"p"},"weekly_visitors.csv")," based on the matching ",(0,n.yg)("inlineCode",{parentName:"p"},"ip_address"),". In this scenario,\nyou're adding a temporal context to the security events by identifying when each\nIP address involved in these events last visited your network. This can be\nparticularly useful for quickly assessing whether a security event is related to\na new or returning visitor, potentially aiding in the rapid assessment of the\nevent's nature and severity."),(0,n.yg)("h3",p({},{id:"elastic"}),"Elastic"),(0,n.yg)("p",null,"Elastic's ",(0,n.yg)("a",p({parentName:"p"},{href:"/archive/a-first-look-at-esql"}),"new ES|QL language")," also\n",(0,n.yg)("a",p({parentName:"p"},{href:"https://www.elastic.co/guide/en/elasticsearch/reference/master/esql-enrich-data.html"}),"supports\nenrichment"),"\nusing the ",(0,n.yg)("a",p({parentName:"p"},{href:"https://www.elastic.co/guide/en/elasticsearch/reference/master/esql-commands.html#esql-enrich"}),(0,n.yg)("inlineCode",{parentName:"a"},"ENRICH"),"\ncommand"),".\nEnrichment is a key-based lookup using special index type. The diagram below\nshows how it works."),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"ES|QL Enrichment",src:a(57593).A,width:"2038",height:"1260"})),(0,n.yg)("p",null,"Assume you have an index ",(0,n.yg)("inlineCode",{parentName:"p"},"network_security_logs")," with fields like ",(0,n.yg)("inlineCode",{parentName:"p"},"source_ip"),"\nand an enrich policy ",(0,n.yg)("inlineCode",{parentName:"p"},"threat_intel_policy")," with data based on IP addresses and a\nfield ",(0,n.yg)("inlineCode",{parentName:"p"},"threat_level"),"."),(0,n.yg)("pre",null,(0,n.yg)("code",p({parentName:"pre"},{}),"SELECT e.*, threat.threat_level\nFROM network_security_logs AS e\nENRICH threat_intel_policy\nON e.source_ip\nWITH threat_level\n")),(0,n.yg)("p",null,"This query enriches each record in ",(0,n.yg)("inlineCode",{parentName:"p"},"network_security_logs")," with the\n",(0,n.yg)("inlineCode",{parentName:"p"},"threat_level")," field from the threat intelligence data, providing an additional\nlayer of context."),(0,n.yg)("h3",p({},{id:"sentinel"}),"Sentinel"),(0,n.yg)("p",null,"In Sentinel or Azure Data Explorer, you have a more data-centric view on the\nproblem, using a combination of the Kusto operators\n",(0,n.yg)("a",p({parentName:"p"},{href:"https://docs.microsoft.com/azure/data-explorer/kusto/query/lookupoperator"}),(0,n.yg)("inlineCode",{parentName:"a"},"lookup")),"\nand\n",(0,n.yg)("a",p({parentName:"p"},{href:"https://docs.microsoft.com/azure/data-explorer/kusto/query/joinoperator"}),(0,n.yg)("inlineCode",{parentName:"a"},"join")),":"),(0,n.yg)("pre",null,(0,n.yg)("code",p({parentName:"pre"},{}),"SecurityEvent\n| lookup kind=leftouter GeoIPTable on $left.IPAddress == $right.GeoIP\n| join kind=leftouter ThreatIntelTable on $left.IPAddress == $right.ThreatIP\n")),(0,n.yg)("p",null,"This query takes a security event, enriches it with the ",(0,n.yg)("inlineCode",{parentName:"p"},"GeoIPTable")," data based\non the source IP, and then joins it with threat intelligence data from the\n",(0,n.yg)("inlineCode",{parentName:"p"},"ThreatIntelTable"),"."),(0,n.yg)("h2",p({},{id:"search-vs-ingest-time-enrichment"}),"Search vs. Ingest Time Enrichment"),(0,n.yg)("p",null,"We've now seen three examples for ",(0,n.yg)("em",{parentName:"p"},"search-time")," enrichment. For ",(0,n.yg)("em",{parentName:"p"},"ingest-time"),"\nenrichments, Splunk users need to adapt a config file ",(0,n.yg)("inlineCode",{parentName:"p"},"transforms.conf"),".\nElastic users can either use a separate tool\n",(0,n.yg)("a",p({parentName:"p"},{href:"https://www.elastic.co/logstash"}),"Logstash")," or resort to ",(0,n.yg)("a",p({parentName:"p"},{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/ingest.html"}),"Node Ingest\nPipelines"),".\nAzure users can user to ",(0,n.yg)("a",p({parentName:"p"},{href:"https://docs.microsoft.com/azure/event-hubs/"}),"Event\nHubs"),", ",(0,n.yg)("a",p({parentName:"p"},{href:"https://docs.microsoft.com/azure/stream-analytics/"}),"Azure Stream\nAnalytics"),", or ",(0,n.yg)("a",p({parentName:"p"},{href:"https://docs.microsoft.com/azure/azure-functions/"}),"Azure\nFunctions"),". As a Sentinel\nusers, you can use Data Collection Rules (DCRs) to apply KQL transformations to\nincoming data before it's stored in your workspace. Here's an example of how\nthis can be done:"),(0,n.yg)("pre",null,(0,n.yg)("code",p({parentName:"pre"},{}),"let GeoIP = externaldata(country:string, city:string, [ip_range:string])\n@\"https://example.com/geoipdata.csv\" \nwith (format='csv', ignoreFirstRecord=True);\nSecurityEvent\n| extend parsedIP = parse_ipv4(ip_address)\n| lookup kind=leftouter GeoIP on $left.parsedIP between $right.ip_range\n")),(0,n.yg)("p",null,"What's left is taking this transformation and adding it to the data collection\nrule. Here's a diagram from the\n",(0,n.yg)("a",p({parentName:"p"},{href:"https://learn.microsoft.com/en-us/azure/sentinel/data-transformation"}),"documentation"),"\non how the Azure pieces fit together:"),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"Data Transformation Architecture",src:a(22066).A,width:"1831",height:"850"})),(0,n.yg)("h2",p({},{id:"conclusion"}),"Conclusion"),(0,n.yg)("p",null,"We reviewed three existing approaches to enrichment by looking at Splunk,\nElastic, and Sentinel. Common among all systems is the idea of first building a\ndataset for contextualization, and then using that in a second step. In\nparticular, the use of the context is decoupled from the management of the\ncontext."),(0,n.yg)("p",null,"We could argue a lot about syntax ergonomics and system idiosyncrasies. But that\nwouldn't move the needle much. The foundational mechanisms are the same in the\ndifferent systems. That said, we did ask ourselves: how can we make enrichment\n",(0,n.yg)("em",{parentName:"p"},"as easy, fast, and flexible as possible"),"? Our next blog will have the answer."),(0,n.yg)("p",null,"In the meantime, feel free to browse through our docs, read our blog posts, or\njoin our ",(0,n.yg)("a",p({parentName:"p"},{href:"/discord"}),"Discord server")," to talk to the power users in our\ncommunity. You can always skip everything and dive right in at\n",(0,n.yg)("a",p({parentName:"p"},{href:"https://app.tenzir.com"}),"app.tenzir.com"),"."))}D.isMDXComponent=!0},22066:(e,t,a)=>{a.d(t,{A:()=>n});const n=a.p+"assets/images/data-transformation-architecture-8220c6c7cfdcee40167ec44961e38507.png"},57593:(e,t,a)=>{a.d(t,{A:()=>n});const n=a.p+"assets/images/esql-enrich-21e4a7c907e548b048e66d1d0bad1b51.png"},62112:(e,t,a)=>{a.d(t,{A:()=>n});const n=a.p+"assets/images/salamander-method-224d3ee19d33cfdfaa491db907b64e34.png"}}]);