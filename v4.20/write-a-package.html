<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-v4.20 plugin-docs plugin-id-default docs-doc-id-write-a-package">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Write a Package | Tenzir</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.tenzir.com/v4.20/write-a-package"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="v4.20"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v4.20"><meta data-rh="true" name="docsearch:version" content="v4.20"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v4.20"><meta data-rh="true" property="og:title" content="Write a Package | Tenzir"><meta data-rh="true" name="description" content="This tutorial walks you through the creation of a package, which"><meta data-rh="true" property="og:description" content="This tutorial walks you through the creation of a package, which"><link data-rh="true" rel="icon" href="/img/tenzir-logo-adaptive.svg"><link data-rh="true" rel="canonical" href="https://docs.tenzir.com/v4.20/write-a-package"><link data-rh="true" rel="alternate" href="https://docs.tenzir.com/v4.20/write-a-package" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.tenzir.com/v4.20/write-a-package" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://BVB58VRBDH-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Tenzir RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Tenzir Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="Tenzir" href="/opensearch.xml">




<script src="https://plausible.io/js/script.js" aysnc defer="defer" data-domain="docs.tenzir.com"></script><link rel="stylesheet" href="/assets/css/styles.6879950d.css">
<link rel="preload" href="/assets/js/runtime~main.ae9005a5.js" as="script">
<link rel="preload" href="/assets/js/main.f2677746.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://tenzir.com" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/tenzir-black.svg" alt="Tenzir" class="themedImage_ToTc themedImage--light_HNdA" width="120"><img src="/img/tenzir-white.svg" alt="Tenzir" class="themedImage_ToTc themedImage--dark_i4oU" width="120"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/v4.20/overview">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/changelog">Changelog</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link header-discord-link" aria-label="Discord" href="/discord"></a><a href="https://github.com/tenzir/tenzir" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/v4.20/overview">v4.20</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/next/overview">Next</a></li><li><a class="dropdown__link" href="/write-a-package">v4.22</a></li><li><a class="dropdown__link" href="/v4.21/write-a-package">v4.21</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/v4.20/write-a-package">v4.20</a></li></ul></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v4.20/overview"><div style="width:100%;display:flex">Overview<span style="flex-grow:1"></span></div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v4.20/faqs"><div style="width:100%;display:flex">FAQs<span style="flex-grow:1"></span></div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><br><b>Tutorials<b></b></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v4.20/quickstart"><div style="width:100%;display:flex">Quickstart<span style="flex-grow:1"></span></div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v4.20/map-data-to-ocsf"><div style="width:100%;display:flex">Map Data to OCSF<span style="flex-grow:1"></span></div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/v4.20/write-a-package"><div style="width:100%;display:flex">Write a Package<span style="flex-grow:1"></span></div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><br><b>Guides<b></b></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v4.20/installation">Installation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Installation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v4.20/usage">Usage</a><button aria-label="Toggle the collapsible sidebar category &#x27;Usage&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v4.20/integrations">Integrations</a><button aria-label="Toggle the collapsible sidebar category &#x27;Integrations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v4.20/contribution">Contribution</a><button aria-label="Toggle the collapsible sidebar category &#x27;Contribution&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v4.20/development">Development</a><button aria-label="Toggle the collapsible sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v4.20/troubleshooting"><div style="width:100%;display:flex">Troubleshooting<span style="flex-grow:1"></span></div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v4.20/tql2-migration"><div style="width:100%;display:flex">TQL2 Migration<div style="display:flex;align-items:center;height:20px;margin-left:5px;margin-right:-5px" title="Experimental"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24" fill="#5f6368" style="height:100%;width:auto"><path d="M200-120q-51 0-72.5-45.5T138-250l222-270v-240h-40q-17 0-28.5-11.5T280-800q0-17 11.5-28.5T320-840h320q17 0 28.5 11.5T680-800q0 17-11.5 28.5T640-760h-40v240l222 270q32 39 10.5 84.5T760-120H200Zm80-120h400L544-400H416L280-240Zm-80 40h560L520-492v-268h-80v268L200-200Zm280-280Z"></path></svg></div><span style="flex-grow:1"></span></div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><br><b>Reference<b></b></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v4.20/language">Language</a><button aria-label="Toggle the collapsible sidebar category &#x27;Language&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v4.20/operators">Operators</a><button aria-label="Toggle the collapsible sidebar category &#x27;Operators&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v4.20/connectors">Connectors</a><button aria-label="Toggle the collapsible sidebar category &#x27;Connectors&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v4.20/formats">Formats</a><button aria-label="Toggle the collapsible sidebar category &#x27;Formats&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v4.20/contexts">Contexts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Contexts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v4.20/data-model">Data Model</a><button aria-label="Toggle the collapsible sidebar category &#x27;Data Model&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v4.20/configuration"><div style="width:100%;display:flex">Configuration<span style="flex-grow:1"></span></div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v4.20/rest-api"><div style="width:100%;display:flex">REST API<span style="flex-grow:1"></span></div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v4.20/python-library"><div style="width:100%;display:flex">Python Library<span style="flex-grow:1"></span></div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v4.20/platform-cli"><div style="width:100%;display:flex">Platform CLI<span style="flex-grow:1"></span></div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v4.20/glossary"><div style="width:100%;display:flex">Glossary<span style="flex-grow:1"></span></div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><br><b>Explanation<b></b></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v4.20/pipelines"><div style="width:100%;display:flex">Pipelines<span style="flex-grow:1"></span></div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v4.20/packages"><div style="width:100%;display:flex">Packages<span style="flex-grow:1"></span></div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v4.20/why-tenzir"><div style="width:100%;display:flex">Why Tenzir<span style="flex-grow:1"></span></div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v4.20/target-audience"><div style="width:100%;display:flex">Target Audience<span style="flex-grow:1"></span></div></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v4.20/use-cases">Use Cases</a><button aria-label="Toggle the collapsible sidebar category &#x27;Use Cases&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v4.20/architecture">Architecture</a><button aria-label="Toggle the collapsible sidebar category &#x27;Architecture&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Tenzir<!-- --> <b>v4.20</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/write-a-package">latest version</a></b> (<!-- -->v4.22<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Write a Package</span><meta itemprop="position" content="1"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v4.20</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Write a Package</h1><p>This tutorial walks you through the creation of a <a href="/v4.20/packages">package</a>, which
is a bundle of related pipelines and contexts. You can <a href="/v4.20/installation/install-a-package">install
packages</a> with a few clicks from the <a href="https://app.tenzir.com/library" target="_blank" rel="noopener noreferrer">Tenzir
Library</a> or deploy them as code.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="map-the-use-case">Map the use case<a href="#map-the-use-case" class="hash-link" aria-label="Direct link to Map the use case" title="Direct link to Map the use case">​</a></h2><p>The goal of a package is to enable a specific use case. In this tutorial, we
want to make it easy to detect malicious certificates that are on the
<a href="https://sslbl.abuse.ch/" target="_blank" rel="noopener noreferrer">SSLBL</a> from <a href="https://abuse.ch" target="_blank" rel="noopener noreferrer">abuse.ch</a>. At a glance,
the idea is as follows:</p><ol><li>We get SHA1 hashes of SSL certifcates from network monitor logs, such as
<a href="https://zeek.org" target="_blank" rel="noopener noreferrer">Zeek</a> or <a href="https://suricata.io" target="_blank" rel="noopener noreferrer">Suricata</a>.</li><li>We check each hash value against a lookup table.</li><li>We generate a detection finding when we encounter a match.</li></ol><p>Given this idea, we have to it to the building blocks we have in Tenzir:
<a href="/v4.20/pipelines">pipelines</a> and <a href="/v4.20/contexts">contexts</a>. We can model it as
follows.</p><ol><li>A lookup table that includes a copy of the SSLBL data.</li><li>A pipeline that synchronizes the SSLBL data with the lookup table.</li><li>A pipeline to enrich network telemetry and generate detection findings.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-the-scaffold">Create the scaffold<a href="#create-the-scaffold" class="hash-link" aria-label="Direct link to Create the scaffold" title="Direct link to Create the scaffold">​</a></h2><p>We begin with creating a <code>package.yaml</code> file with the following metadata:</p><figure data-rehype-pretty-code-figure=""><figcaption data-rehype-pretty-code-title="" data-language="yaml" data-theme="github-dark-default">package.yaml</figcaption><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span data-line=""><span style="color:#7EE787">id</span><span style="color:#E6EDF3">: </span><span style="color:#A5D6FF">sslbl</span></span>
<span data-line=""><span style="color:#7EE787">name</span><span style="color:#E6EDF3">: </span><span style="color:#A5D6FF">SSLBL</span></span>
<span data-line=""><span style="color:#7EE787">author</span><span style="color:#E6EDF3">: </span><span style="color:#A5D6FF">Tenzir</span></span>
<span data-line=""><span style="color:#7EE787">author_icon</span><span style="color:#E6EDF3">: </span><span style="color:#A5D6FF">https://github.com/tenzir.png</span></span>
<span data-line=""><span style="color:#7EE787">package_icon</span><span style="color:#E6EDF3">: </span><span style="color:#FF7B72">|</span></span>
<span data-line=""><span style="color:#A5D6FF">  https://raw.githubusercontent.com/tenzir/library/main/sslbl/package.svg</span></span>
<span data-line=""><span style="color:#7EE787">description</span><span style="color:#E6EDF3">: </span><span style="color:#FF7B72">|</span></span>
<span data-line=""><span style="color:#A5D6FF">  The [SSLBL](https://sslbl.abuse.ch/) package makes available a lookup table</span></span>
<span data-line=""><span style="color:#A5D6FF">  with SHA1 hashes of blacklisted certificates that can be used when monitoring</span></span>
<span data-line=""><span style="color:#A5D6FF">  SSL/TLS certificate exchanges.</span></span></code></pre></figure><h2 class="anchor anchorWithStickyNavbar_LWe7" id="add-your-pipelines-context-and-examples">Add your pipelines, context, and examples<a href="#add-your-pipelines-context-and-examples" class="hash-link" aria-label="Direct link to Add your pipelines, context, and examples" title="Direct link to Add your pipelines, context, and examples">​</a></h2><p>After providing the package metadata, we now do the heavy lift of writing pipelines, contexts, and examples.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-a-context">Add a context<a href="#add-a-context" class="hash-link" aria-label="Direct link to Add a context" title="Direct link to Add a context">​</a></h3><p>First, we need a data structure to hold the SSLBL data so that we can use it
inside the node. TO this end, we define a lookup table in the <code>contexts</code>
section:</p><figure data-rehype-pretty-code-figure=""><figcaption data-rehype-pretty-code-title="" data-language="yaml" data-theme="github-dark-default">package.yaml</figcaption><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span data-line=""><span style="color:#7EE787">contexts</span><span style="color:#E6EDF3">:</span></span>
<span data-line=""><span style="color:#7EE787">  sslbl</span><span style="color:#E6EDF3">:</span></span>
<span data-line=""><span style="color:#7EE787">    type</span><span style="color:#E6EDF3">: </span><span style="color:#A5D6FF">lookup-table</span></span>
<span data-line=""><span style="color:#7EE787">    description</span><span style="color:#E6EDF3">: </span><span style="color:#FF7B72">|</span></span>
<span data-line=""><span style="color:#A5D6FF">      A table that is keyed by SHA1 hashes of SSL certificates on the SSL</span></span>
<span data-line=""><span style="color:#A5D6FF">      blocklist.</span></span></code></pre></figure><p>Let&#x27;s figure out how to get data into the context manually. There&#x27;s a CSV file
at <a href="https://sslbl.abuse.ch/blacklist/sslblacklist.csv" target="_blank" rel="noopener noreferrer">https://sslbl.abuse.ch/blacklist/sslblacklist.csv</a>. Let&#x27;s take a look at
that in the browser:</p><figure data-rehype-pretty-code-figure=""><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span data-line=""><span style="color:#E6EDF3">################################################################</span></span>
<span data-line=""><span style="color:#E6EDF3"># abuse.ch SSLBL SSL Certificate Blacklist (SHA1 Fingerprints) #</span></span>
<span data-line=""><span style="color:#E6EDF3"># Last updated: 2024-09-02 06:17:52 UTC                        #</span></span>
<span data-line=""><span style="color:#E6EDF3">#                                                              #</span></span>
<span data-line=""><span style="color:#E6EDF3"># Terms Of Use: https://sslbl.abuse.ch/blacklist/              #</span></span>
<span data-line=""><span style="color:#E6EDF3"># For questions please contact sslbl [at] abuse.ch             #</span></span>
<span data-line=""><span style="color:#E6EDF3">################################################################</span></span>
<span data-line=""><span style="color:#E6EDF3">#</span></span>
<span data-line=""><span style="color:#E6EDF3"># Listingdate,</span><span style="color:#FF7B72">SHA1,</span><span style="color:#D2A8FF">Listingreason</span></span>
<span data-line=""><span style="color:#E6EDF3">2024-09-02 06:17:52,</span><span style="color:#FF7B72">4da14224452c1fe61f46b1112c43ecfd9f322c82,</span><span style="color:#D2A8FF">Rhadamanthys C&amp;C</span></span>
<span data-line=""><span style="color:#E6EDF3">2024-09-02 06:16:33,</span><span style="color:#FF7B72">b331526a0949f88ce218555edf1060c4a02de5a2,</span><span style="color:#D2A8FF">Rhadamanthys C&amp;C</span></span>
<span data-line=""><span style="color:#E6EDF3">2024-09-02 05:19:10,</span><span style="color:#FF7B72">b785d1a9e5784703b98a96698ad05dff5e07229a,</span><span style="color:#D2A8FF">DCRat C&amp;C</span></span>
<span data-line=""><span style="color:#E6EDF3">2024-09-02 05:18:33,</span><span style="color:#FF7B72">be4d4f077bdd90618367eb2ab88f9f3074ccb7aa,</span><span style="color:#D2A8FF">AsyncRAT C&amp;C</span></span>
<span data-line=""><span style="color:#E6EDF3">2024-08-30 13:46:12,</span><span style="color:#FF7B72">6bef207908bfad6b19580067ce770bc820d3d2ef,</span><span style="color:#D2A8FF">CobaltStrike C&amp;C</span></span>
<span data-line=""><span style="color:#E6EDF3">2024-08-29 09:02:20,</span><span style="color:#FF7B72">9a57379949f734b11f32bb8462db1f3fd8898722,</span><span style="color:#D2A8FF">DarkGate C&amp;C</span></span>
<span data-line=""><span style="color:#E6EDF3">2024-08-29 09:01:39,</span><span style="color:#FF7B72">47122f7861b7488f6711c999e40caaa5e560630b,</span><span style="color:#D2A8FF">Rhadamanthys C&amp;C</span></span>
<span data-line=""><span style="color:#E6EDF3">2024-08-29 09:01:33,</span><span style="color:#FF7B72">fb0e13607d045047c29ab44941f450950a349dd7,</span><span style="color:#D2A8FF">Rhadamanthys C&amp;C</span></span></code></pre></figure><p>Okay, a simple CSV table with comments. We can write a pipeline for reading
that:</p><figure data-rehype-pretty-code-figure=""><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span data-line=""><span style="color:#8B949E">// tql2</span></span>
<span data-line=""><span style="color:#D2A8FF">load_http</span><span style="color:#A5D6FF"> &quot;from https://sslbl.abuse.ch/blacklist/sslblacklist.csv&quot;</span></span>
<span data-line=""><span style="color:#D2A8FF">read_csv</span><span style="color:#E6EDF3"> comments</span><span style="color:#FF7B72">=</span><span style="color:#79C0FF">true</span><span style="color:#E6EDF3">, header</span><span style="color:#FF7B72">=</span><span style="color:#A5D6FF">&quot;timestamp,SHA1,reason&quot;</span></span></code></pre></figure><p>Now that we have onboarded the data into a pipeline, we just need to push it
into the context by piping it to <code>context update</code>:</p><figure data-rehype-pretty-code-figure=""><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span data-line=""><span style="color:#8B949E">// tql2</span></span>
<span data-line=""><span style="color:#D2A8FF">load_http</span><span style="color:#A5D6FF"> &quot;from https://sslbl.abuse.ch/blacklist/sslblacklist.csv&quot;</span></span>
<span data-line=""><span style="color:#D2A8FF">read_csv</span><span style="color:#E6EDF3"> comments</span><span style="color:#FF7B72">=</span><span style="color:#79C0FF">true</span><span style="color:#E6EDF3">, header</span><span style="color:#FF7B72">=</span><span style="color:#A5D6FF">&quot;timestamp,SHA1,reason&quot;</span></span>
<span data-line=""><span style="color:#D2A8FF">legacy</span><span style="color:#A5D6FF"> &quot;context update sslbl --key=SHA1&quot;</span></span></code></pre></figure><p>With <code>context inspect sslbl</code> we can list the table contents, keyed by SHA1 hash
and ready for enrichment.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="keep-the-context-synchronized">Keep the context synchronized<a href="#keep-the-context-synchronized" class="hash-link" aria-label="Direct link to Keep the context synchronized" title="Direct link to Keep the context synchronized">​</a></h3><p>So far we did a one-shot download of the SSLBL data into our lookup table. But
the fine folks at abuse.ch update the data regularly, and we want to keep our
lookup table in sync with the latest version.</p><p>To this end, we do the data onboarding periodically with <code>every</code>:</p><figure data-rehype-pretty-code-figure=""><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span data-line=""><span style="color:#8B949E">// tql2</span></span>
<span data-line=""><span style="color:#D2A8FF">every</span><span style="color:#79C0FF"> 1h</span><span style="color:#E6EDF3"> {</span></span>
<span data-line=""><span style="color:#D2A8FF">  load_http</span><span style="color:#A5D6FF"> &quot;from https://sslbl.abuse.ch/blacklist/sslblacklist.csv&quot;</span></span>
<span data-line=""><span style="color:#D2A8FF">  read_csv</span><span style="color:#E6EDF3"> comments</span><span style="color:#FF7B72">=</span><span style="color:#79C0FF">true</span><span style="color:#E6EDF3">, header</span><span style="color:#FF7B72">=</span><span style="color:#A5D6FF">&quot;timestamp,SHA1,reason&quot;</span></span>
<span data-line=""><span style="color:#E6EDF3">}</span></span>
<span data-line=""><span style="color:#D2A8FF">legacy</span><span style="color:#A5D6FF"> &quot;context update sslbl --key=SHA1&quot;</span></span></code></pre></figure><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span><mdxadmonitiontitle>Why not wrap the entire pipeline in <code>every</code>?</mdxadmonitiontitle></div><div class="admonitionContent_S0QG"><p>We could&#x27;ve also wrapped the entire pipeline in <code>every 1h {…}</code> with the same
effect. However, if we split the data acquisition from the remaining work, we
have a more local change that turns a one-shot data download into a continuous
stream. This has the effect that the other pipeline operators outside of <code>every</code>
are running continuously, and more importantly, emit metrics continuously and
could also fail earlier, leading to an overall more robust pipeline
architecture.</p></div></div><p>Now let&#x27;s copy that into the package definition:</p><figure data-rehype-pretty-code-figure=""><figcaption data-rehype-pretty-code-title="" data-language="yaml" data-theme="github-dark-default">package.yaml</figcaption><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span data-line=""><span style="color:#7EE787">pipelines</span><span style="color:#E6EDF3">:</span></span>
<span data-line=""><span style="color:#7EE787">  update-context</span><span style="color:#E6EDF3">:</span></span>
<span data-line=""><span style="color:#7EE787">    name</span><span style="color:#E6EDF3">: </span><span style="color:#A5D6FF">Update SSLBL Context</span></span>
<span data-line=""><span style="color:#7EE787">    description</span><span style="color:#E6EDF3">: </span><span style="color:#FF7B72">|</span></span>
<span data-line=""><span style="color:#A5D6FF">      A pipeline that periodically refreshes the SSLBL lookup table.</span></span>
<span data-line=""><span style="color:#7EE787">    definition</span><span style="color:#E6EDF3">: </span><span style="color:#FF7B72">|</span></span>
<span data-line=""><span style="color:#A5D6FF">      // tql2</span></span>
<span data-line=""><span style="color:#A5D6FF">      every 1h {</span></span>
<span data-line=""><span style="color:#A5D6FF">        load_http &quot;from https://sslbl.abuse.ch/blacklist/sslblacklist.csv&quot;</span></span>
<span data-line=""><span style="color:#A5D6FF">        read_csv comments=true, header=&quot;timestamp,SHA1,reason&quot;</span></span>
<span data-line=""><span style="color:#A5D6FF">      }</span></span>
<span data-line=""><span style="color:#A5D6FF">      legacy &quot;context update sslbl --key=SHA1&quot;</span></span>
<span data-line=""><span style="color:#7EE787">    restart-on-error</span><span style="color:#E6EDF3">: </span><span style="color:#A5D6FF">1 hour</span></span></code></pre></figure><p>From a developer&#x27;s perspective, we now have a complete package consisting of a
context and a pipeline that updates it. But from a user&#x27;s perspective, what do
we do now? This is where the <code>examples</code> section comes into play.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="entice-with-examples">Entice with examples<a href="#entice-with-examples" class="hash-link" aria-label="Direct link to Entice with examples" title="Direct link to Entice with examples">​</a></h3><p>After you put thought into implementing the intricate dataflows and thoughtfully
configured pipelines and context, it&#x27;s time to switch from the developer to the
user persona. As a package developer, you want to make things reusable and easy!
In the <code>examples</code> section you showcase how users can profit from the work that
the package does behind the scenes.</p><p>For our concrete scenario, we now want to use the SSLBL context that we set up
and keep up to date. Our &quot;work&quot; was allowing users to just come with a SHA1 hash
digest, and the context quickly tells us good or bad.</p><figure data-rehype-pretty-code-figure=""><figcaption data-rehype-pretty-code-title="" data-language="yaml" data-theme="github-dark-default">package.yaml</figcaption><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span data-line=""><span style="color:#7EE787">examples</span><span style="color:#E6EDF3">:</span></span>
<span data-line=""><span style="color:#E6EDF3">  - </span><span style="color:#7EE787">name</span><span style="color:#E6EDF3">: </span><span style="color:#A5D6FF">Enrich Suricata TLS logs with SSLBL domains</span></span>
<span data-line=""><span style="color:#7EE787">    description</span><span style="color:#E6EDF3">: </span><span style="color:#FF7B72">|</span></span>
<span data-line=""><span style="color:#A5D6FF">      Enriches the certificate SHA1 fingerprint from Suricata TLS logs with the</span></span>
<span data-line=""><span style="color:#A5D6FF">      SSLBL data.</span></span>
<span data-line=""><span style="color:#7EE787">    definition</span><span style="color:#E6EDF3">: </span><span style="color:#FF7B72">|</span></span>
<span data-line=""><span style="color:#A5D6FF">      // tql2</span></span>
<span data-line=""><span style="color:#A5D6FF">      subscribe &quot;suricata&quot;</span></span>
<span data-line=""><span style="color:#A5D6FF">      where @name == &quot;suricata.tls&quot;</span></span>
<span data-line=""><span style="color:#A5D6FF">      sha1 = tls.fingerprint.replace(&quot;:&quot;, &quot;&quot;)</span></span>
<span data-line=""><span style="color:#A5D6FF">      legacy &quot;enrich sha1 sslbl&quot;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#E6EDF3">  - </span><span style="color:#7EE787">name</span><span style="color:#E6EDF3">: </span><span style="color:#A5D6FF">Display top-10 listing reasons</span></span>
<span data-line=""><span style="color:#7EE787">    description</span><span style="color:#E6EDF3">: </span><span style="color:#FF7B72">|</span></span>
<span data-line=""><span style="color:#A5D6FF">      Shows a bar chart of the top-10 reasons why a certificate is in the</span></span>
<span data-line=""><span style="color:#A5D6FF">      dataset.</span></span>
<span data-line=""><span style="color:#7EE787">    definition</span><span style="color:#E6EDF3">: </span><span style="color:#FF7B72">|</span></span>
<span data-line=""><span style="color:#A5D6FF">      context inspect sslbl</span></span>
<span data-line=""><span style="color:#A5D6FF">      | yield value</span></span>
<span data-line=""><span style="color:#A5D6FF">      | top reason</span></span>
<span data-line=""><span style="color:#A5D6FF">      | head</span></span>
<span data-line=""><span style="color:#A5D6FF">      | chart bar</span></span></code></pre></figure><h2 class="anchor anchorWithStickyNavbar_LWe7" id="make-the-package-configurable">Make the package configurable<a href="#make-the-package-configurable" class="hash-link" aria-label="Direct link to Make the package configurable" title="Direct link to Make the package configurable">​</a></h2><p>After we have illustrated how the package works with examples, let&#x27;s step back
for a moment and assess how customizable the package should be:</p><ul><li>Is there anything that might differ from user to user?</li><li>Do they have to bring their API key for the package to work?</li><li>Are timeouts highly subjective and specific to the local environment?</li></ul><p>For all places where it&#x27;s difficult to offer a one-size-fits-all assumption, we
want the user to make decision on how to proceed. These customization points are
called <em>inputs</em>, and the correspondingly named section in the package definition
specifies them.</p><p>In our case, we hard-coded the refresh interval that updates the SSLBL lookup
table to exactly 1 hour. Maybe other users want to update just once a day? Or
more often? This is a typical example where policy is user-specific and where we
can turn an assumption into a decision. Let&#x27;s define the input:</p><figure data-rehype-pretty-code-figure=""><figcaption data-rehype-pretty-code-title="" data-language="yaml" data-theme="github-dark-default">package.yaml</figcaption><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span data-line=""><span style="color:#7EE787">inputs</span><span style="color:#E6EDF3">:</span></span>
<span data-line=""><span style="color:#7EE787">  refresh-interval</span><span style="color:#E6EDF3">:</span></span>
<span data-line=""><span style="color:#7EE787">    name</span><span style="color:#E6EDF3">: </span><span style="color:#A5D6FF">Time between context updates</span></span>
<span data-line=""><span style="color:#7EE787">    description</span><span style="color:#E6EDF3">: </span><span style="color:#FF7B72">|</span></span>
<span data-line=""><span style="color:#A5D6FF">      The duration between updates that fetch the SSLBL database via the API.</span></span>
<span data-line=""><span style="color:#7EE787">    default</span><span style="color:#E6EDF3">: </span><span style="color:#A5D6FF">1 hour</span></span></code></pre></figure><p>By specifying a default value, we also make it easy for users to skip the
decision making. In other words, defaults make a configuration knob optional.</p><p>After we&#x27;ve defined our configuration knobs, we now go over the pipeline
definitions and replace the hard-coded constants with a placeholder:</p><figure data-rehype-pretty-code-figure=""><figcaption data-rehype-pretty-code-title="" data-language="yaml" data-theme="github-dark-default">package.yaml</figcaption><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span data-line=""><span style="color:#7EE787">pipelines</span><span style="color:#E6EDF3">:</span></span>
<span data-line=""><span style="color:#7EE787">  update-context</span><span style="color:#E6EDF3">:</span></span>
<span data-line=""><span style="color:#7EE787">    name</span><span style="color:#E6EDF3">: </span><span style="color:#A5D6FF">Update SSLBL Context</span></span>
<span data-line=""><span style="color:#7EE787">    description</span><span style="color:#E6EDF3">: </span><span style="color:#FF7B72">|</span></span>
<span data-line=""><span style="color:#A5D6FF">      A pipeline that periodically refreshes the SSLBL lookup table.</span></span>
<span data-line=""><span style="color:#7EE787">    definition</span><span style="color:#E6EDF3">: </span><span style="color:#FF7B72">|</span></span>
<span data-line=""><span style="color:#A5D6FF">      // tql2</span></span>
<span data-line=""><span style="color:#A5D6FF">      every {{ inputs.refresh-interval }} {</span></span>
<span data-line=""><span style="color:#A5D6FF">        load_http &quot;from https://sslbl.abuse.ch/blacklist/sslblacklist.csv&quot;</span></span>
<span data-line=""><span style="color:#A5D6FF">        read_csv comments=true, header=&quot;timestamp,SHA1,reason&quot;</span></span>
<span data-line=""><span style="color:#A5D6FF">        legacy &quot;context update sslbl --key=SHA1&quot;</span></span>
<span data-line=""><span style="color:#A5D6FF">      }</span></span>
<span data-line=""><span style="color:#7EE787">    restart-on-error</span><span style="color:#E6EDF3">: </span><span style="color:#A5D6FF">1 hour</span></span></code></pre></figure><p>Note how we simply replaced <code>1h</code> with <code>{{ inputs.refresh-interval }}</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="test-your-package">Test your package<a href="#test-your-package" class="hash-link" aria-label="Direct link to Test your package" title="Direct link to Test your package">​</a></h2><p>When you think you&#x27;re done, it&#x27;s time to validate that things work as you
expect. This means effectively trying to install, configure and use it.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Testing Framework</div><div class="admonitionContent_S0QG"><p>We currently don&#x27;t offer a native testing framework for packages where you can
provide tests and baselines along the package definition. But we love the idea,
and if you do as well, please swing by our <a href="/discord">Community Discord</a> and
discuss it with us.</p></div></div><p><a href="/v4.20/installation/install-a-package">Installing a package</a> given a <code>package.yaml</code>
file is easiest with the <a href="/v4.20/operators/package"><code>package_add</code></a> operator, since
a package is just data:</p><figure data-rehype-pretty-code-figure=""><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span data-line=""><span style="color:#D2A8FF">load_file</span><span style="color:#A5D6FF"> &quot;/path/to/package.yaml&quot;</span></span>
<span data-line=""><span style="color:#D2A8FF">read_yaml</span></span>
<span data-line=""><span style="color:#D2A8FF">package_add</span></span></code></pre></figure><p>This fails with the following error:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">error: failed to add package</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> = note: with error: !! unspecified: named argument `header` does not exist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> = note: failed to add package</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Doh, we didn&#x27;t substitute the template <code>{{ inputs.refresh-interval }}</code>. We can
do this with one extra statement, though:</p><figure data-rehype-pretty-code-figure=""><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span data-line=""><span style="color:#D2A8FF">load_file</span><span style="color:#A5D6FF"> &quot;/path/to/package.yaml&quot;</span></span>
<span data-line=""><span style="color:#D2A8FF">read_yaml</span></span>
<span data-line=""><span style="color:#E6EDF3">config</span><span style="color:#FF7B72">.</span><span style="color:#E6EDF3">inputs[</span><span style="color:#A5D6FF">&quot;refresh-interval&quot;</span><span style="color:#E6EDF3">] </span><span style="color:#FF7B72">=</span><span style="color:#79C0FF"> 1h</span></span>
<span data-line=""><span style="color:#D2A8FF">package_add</span></span></code></pre></figure><p>NB: We have to access the field <code>refresh-interval</code> in <code>config.inputs</code> via <code>[]</code>
because <code>config.inputs.refresh-interval</code> would be parsed as a subtraction
between two fields.</p><p>The package should show up in the list of packages after installation:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// tql2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">packages</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">where id == &quot;sslbl&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The pipelines that came with the package also have its ID prefixed:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// tql2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pipelines</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">where id.starts_with(&quot;sslbl&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And the context is also there:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// tql2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">contexts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">where id.starts_with(&quot;sslbl&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Since we checked that everything works as expected, we now remove our package
with:</p><figure data-rehype-pretty-code-figure=""><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span data-line=""><span style="color:#8B949E">// tql2</span></span>
<span data-line=""><span style="color:#D2A8FF">package_remove</span><span style="color:#A5D6FF"> &quot;sslbl&quot;</span></span></code></pre></figure><h2 class="anchor anchorWithStickyNavbar_LWe7" id="share-and-contribute">Share and contribute<a href="#share-and-contribute" class="hash-link" aria-label="Direct link to Share and contribute" title="Direct link to Share and contribute">​</a></h2><p>🙌 Fantastic, you&#x27;ve just wrapped a use case and made it accessible to a broader
audience! Now spread the word and share it with the broader community of Tenzir
users for an even bigger impact. Here&#x27;s how:</p><ol><li>Join our <a href="/discord">Discord server</a> and showcase your package in the
show-and-tell channel. We encourage you to seek feedback to make your package
even better.</li><li>File a <a href="https://github.com/tenzir/library/pull/23" target="_blank" rel="noopener noreferrer">pull request</a> in the
official <a href="https://github.com/tenzir/library" target="_blank" rel="noopener noreferrer">Community Library</a> GitHub
repository. All packages in there will automatically show up in the <a href="https://app.tenzir.com/library" target="_blank" rel="noopener noreferrer">Tenzir
Library</a>.</li><li>Share it on social media and let us know. We&#x27;ll amplify it! 🫶</li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/tenzir/tenzir/tree/main/web/versioned_docs/version-v4.20/write-a-package.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/v4.20/map-data-to-ocsf"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Map Data to OCSF</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/v4.20/installation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Installation</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#map-the-use-case" class="table-of-contents__link toc-highlight">Map the use case</a></li><li><a href="#create-the-scaffold" class="table-of-contents__link toc-highlight">Create the scaffold</a></li><li><a href="#add-your-pipelines-context-and-examples" class="table-of-contents__link toc-highlight">Add your pipelines, context, and examples</a><ul><li><a href="#add-a-context" class="table-of-contents__link toc-highlight">Add a context</a></li><li><a href="#keep-the-context-synchronized" class="table-of-contents__link toc-highlight">Keep the context synchronized</a></li><li><a href="#entice-with-examples" class="table-of-contents__link toc-highlight">Entice with examples</a></li></ul></li><li><a href="#make-the-package-configurable" class="table-of-contents__link toc-highlight">Make the package configurable</a></li><li><a href="#test-your-package" class="table-of-contents__link toc-highlight">Test your package</a></li><li><a href="#share-and-contribute" class="table-of-contents__link toc-highlight">Share and contribute</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/">Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/api">API</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/changelog">Changelog</a></li><li class="footer__item"><a href="https://docs.google.com/presentation/d/1R59T2nuGJg43g6PVKogZbb6DjcJXRYBx3Bih8W-A-oM/present" target="_blank" rel="noopener noreferrer" class="footer__link-item">Release Notes<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/discord">Discord</a></li><li class="footer__item"><a href="https://github.com/tenzir/tenzir" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/tenzir_company" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/tenzir" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Tenzir</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://tenzir.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/newsletter">Newsletter</a></li><li class="footer__item"><a class="footer__link-item" href="/privacy-statement">Privacy Statement</a></li><li class="footer__item"><a class="footer__link-item" href="/next/tenzir-vs-cribl">Tenzir vs. Cribl</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Tenzir GmbH.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.ae9005a5.js"></script>
<script src="/assets/js/main.f2677746.js"></script>
</body>
</html>