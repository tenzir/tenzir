<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Zeek and Ye Shall Pipe | Tenzir</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.tenzir.com/blog/zeek-and-ye-shall-pipe"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Zeek and Ye Shall Pipe | Tenzir"><meta data-rh="true" name="description" content="Zeek turns packets into structured logs. By default, Zeek"><meta data-rh="true" property="og:description" content="Zeek turns packets into structured logs. By default, Zeek"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-07-13T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/mavam"><meta data-rh="true" property="article:tag" content="zeek,logs,json,pipelines"><link data-rh="true" rel="icon" href="/img/tenzir-logo-adaptive.svg"><link data-rh="true" rel="canonical" href="https://docs.tenzir.com/blog/zeek-and-ye-shall-pipe"><link data-rh="true" rel="alternate" href="https://docs.tenzir.com/blog/zeek-and-ye-shall-pipe" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.tenzir.com/blog/zeek-and-ye-shall-pipe" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://BVB58VRBDH-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Tenzir RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Tenzir Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="Tenzir" href="/opensearch.xml">




<script src="https://plausible.io/js/script.js" aysnc defer="defer" data-domain="docs.tenzir.com"></script><link rel="stylesheet" href="/assets/css/styles.e1b207ac.css">
<link rel="preload" href="/assets/js/runtime~main.236eca83.js" as="script">
<link rel="preload" href="/assets/js/main.ab17497d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://tenzir.com" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/tenzir-black.svg" alt="Tenzir" class="themedImage_ToTc themedImage--light_HNdA" width="120"><img src="/img/tenzir-white.svg" alt="Tenzir" class="themedImage_ToTc themedImage--dark_i4oU" width="120"></div></a><a class="navbar__item navbar__link" href="/get-started">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/changelog">Changelog</a><a class="navbar__item navbar__link" href="/roadmap">Roadmap</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link header-discord-link" aria-label="Discord" href="/discord"></a><a href="https://github.com/tenzir/tenzir" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/get-started">v4.18</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/next/get-started">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/get-started">v4.18</a></li><li><a class="dropdown__link" href="/v4.17/get-started">v4.17</a></li><li><a class="dropdown__link" href="/v4.16/get-started">v4.16</a></li></ul></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Blog Posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tenzir-v4.18">Tenzir v4.18</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tenzir-v4.17">Tenzir v4.17</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/an-interns-reflection">An Intern&#x27;s Reflection</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tenzir-v4.16">Tenzir v4.16</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tenzir-v4.15">Tenzir v4.15</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tenzir-v4.14">Tenzir v4.14</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tenzir-v4.13">Tenzir v4.13</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tenzir-v4.12">Tenzir v4.12</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/reduce-cost-and-noise-with-deduplication">Reduce Cost and Noise with Deduplication</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tenzir-v4.11">Tenzir v4.11</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tenzir-v4.10">Tenzir v4.10</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tenzir-v4.9">Tenzir v4.9</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/introducing-office-hours">Introducing Office Hours</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tenzir-v4.8">Tenzir v4.8</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/switching-fluentbit-from-json-to-msgpack">Switching Fluent Bit from JSON to MsgPack</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tenzir-v4.7">Tenzir v4.7</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/contextualization-made-simple">Contextualization Made Simple</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tenzir-v4.6">Tenzir v4.6</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/enrichment-complexity-in-the-wild">Enrichment Complexity in the Wild</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tenzir-v4.5">Tenzir v4.5</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">Zeek and Ye Shall Pipe</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-07-13T00:00:00.000Z" itemprop="datePublished">July 13, 2023</time> · <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/mavam" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/mavam.png" alt="Matthias Vallentin"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/mavam" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Matthias Vallentin</span></a></div><small class="avatar__subtitle" itemprop="description">Founder &amp; CEO</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p><a href="https://zeek.org" target="_blank" rel="noopener noreferrer">Zeek</a> turns packets into structured logs. By default, Zeek
generates one file per log type and per rotation timeframe. If you don&#x27;t want to
wrangle files and directly process the output, this short blog post is for you.</p><p></p><figure class="markdown-inline-svg">
  <svg viewBox="0 0 4500 340.278" role="img" aria-hidden="true"><symbol id="image-5863f0cbbaf88c6609323df7296d0f11497e91b12f3ab6109c47e4f66d7bf271494d2c77e7fcb30fb2083ecd3bf10178"><image width="100%" height="100%" href="data:image/svg+xml;base64,PHN2ZyB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgaWQ9InN2ZzIiIHdpZHRoPSIxNDQiIGhlaWdodD0iNDcuMTA2NjY3IiB2aWV3Qm94PSIwIDAgMTQ0IDQ3LjEwNjY2NyIgc29kaXBvZGk6ZG9jbmFtZT0iemVla19ibGFja19ob3Jpem9udGFsLmVwcyI+CiAgPGRlZnMgaWQ9ImRlZnM2Ii8+CiAgPHNvZGlwb2RpOm5hbWVkdmlldyBpZD0ibmFtZWR2aWV3NCIgcGFnZWNvbG9yPSIjZmZmZmZmIiBib3JkZXJjb2xvcj0iIzAwMDAwMCIgYm9yZGVyb3BhY2l0eT0iMC4yNSIgaW5rc2NhcGU6c2hvd3BhZ2VzaGFkb3c9IjIiIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiIGlua3NjYXBlOnBhZ2VjaGVja2VyYm9hcmQ9IjAiIGlua3NjYXBlOmRlc2tjb2xvcj0iI2QxZDFkMSIvPgogIDxnIGlkPSJnOCIgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIgaW5rc2NhcGU6bGFiZWw9Imlua19leHRfWFhYWFhYIiB0cmFuc2Zvcm09Im1hdHJpeCgxLjMzMzMzMzMsMCwwLC0xLjMzMzMzMzMsMCw0Ny4xMDY2NjcpIj4KICAgIDxnIGlkPSJnMTAiIHRyYW5zZm9ybT0ic2NhbGUoMC4xKSI+CiAgICAgIDxwYXRoIGQ9Im0gMjM0Ljc5NywxNjUuOTIyIGMgLTEuNjkyLDEuNjAxIC00LjE4NCwyLjA1MSAtNi4zMjgsMS4xMjUgLTIuMTQxLC0wLjkzIC0zLjUyOCwtMy4wMjcgLTMuNTI4LC01LjM2MyBsIDQuNjY4LC0zOC45NTQgLTE1Ljc2MSwxLjUyNCBjIC0wLjEyNSwwIC0wLjIzNSwwLjA2NiAtMC4zNTIsMC4wNjYgSCAxMjUuNDMgbCA5MS43MTEsMTA3LjUgYyAyLjA3LDIuNDM0IDIuNTM5LDUuODQgMS4xOTksOC43NDMgLTEuMzM2LDIuODkgLTQuMjM4LDQuNzQ2IC03LjQyMiw0Ljc0NiBIIDExMCBjIC0wLjEzNywwIC0wLjI1NCwtMC4wNzEgLTAuMzk4LC0wLjA3OSBsIC0yMS4zNzE1LC0yLjM2MyBjIC0zLjIzMDUsMCAtNS44MzYsLTIuNjA5IC01LjgzNiwtNS44NCBsIDQuNjY0MSwtMzEuODY3IC03Mi42NjQxLDY0LjI3IDcyLjE4NzUsNjMuODE2IDAuNjc1OCwwLjYzNyAtNC42Nzk3LC0zMS44NzUgYyAwLC0zLjIyMyAyLjYxNzIsLTUuODQgNS44Mzk5LC01Ljg0IGggMjAzLjg3OSBsIC0yMS4wMDgsLTI2LjIzIGMgLTIuMDE5LC0yLjUxMiAtMS42MDksLTYuMTkyIDAuOTA2LC04LjIwNCAxLjA3NSwtMC44NzEgMi4zNjgsLTEuMjg5IDMuNjQ1LC0xLjI4OSAxLjcxMSwwIDMuNDA2LDAuNzUgNC41NTgsMi4xOTYgbCAyOC42MTgsMzUuNzE0IGMgMS40MDYsMS43NTggMS42NzUsNC4xNjEgMC43MTEsNi4xOCAtMC45NzcsMi4wMjQgLTMuMDI4LDMuMzEzIC01LjI3NCwzLjMxMyBIIDk0LjI2OTUgbCA0LjY2NDEsMzkuNTkgYyAwLDIuMzMyIC0xLjM4NjcsNC40NDEgLTMuNTIzNCw1LjM3MSAtMi4xNDg1LDAuOTE4IC00LjYzNjgsMC40NjggLTYuMzI4MiwtMS4xMjUgTCAyLjAxOTUzLDI3My44MDUgQyAyLDI3My43OTMgMiwyNzMuNzczIDEuOTgwNDcsMjczLjc1NCAxLjg2MzI4LDI3My42NDggMS43MDcwMywyNzMuNjA5IDEuNjAxNTYsMjczLjQ4IC0wLjYyNSwyNzEuMTQ4IC0wLjUxOTUzMSwyNjcuNDQ1IDEuODI0MjIsMjY1LjIzIEwgODguODg2NywxODcuMzU5IGMgMS42OTkyLC0xLjYwMSA0LjE3OTcsLTIuMDUgNi4zMjgxLC0xLjEyNSAyLjE0ODUsMC45MTggMy41MzUyLDMuMDI4IDMuNTM1Miw1LjM2NCBsIC00LjY3NTgsMzguOTUzIDE1LjMzOTgsLTEuNDg1IGMgMC4yMDMsLTAuMDA3IDAuMzgzLC0wLjExNyAwLjU4NiwtMC4xMTcgaCA4My4xODQgbCAtOTEuNzA3LC0xMDcuNSBjIC0yLjA3MDcsLTIuNDI5IC0yLjU0MzQsLTUuODQgLTEuMjA0LC04LjczOCAxLjMzNiwtMi44OTEgNC4yMzksLTQuNzQ2IDcuNDIyLC00Ljc0NiBoIDEwNS44MDEgYyAwLjA3OCwwIDAuMTQ5LDAuMDM5IDAuMjI3LDAuMDQ3IHYgLTAuMDA4IGwgMjEuNzI2LDIuNDAyIGMgMy4yMzUsMCA1Ljg1MiwyLjYxNyA1Ljg1Miw1Ljg0OCBsIC00LjY4LDMxLjg2NyA3Mi42NjQsLTY0LjI2OTQgLTcyLjE4MywtNjMuODE2NCAtMC42NjQsLTAuNjM2OCA0LjY2NywzMS44NzUgYyAwLDMuMjIyNyAtMi42MjEsNS44Mzk5IC01LjgzOSw1LjgzOTkgSCAzMS4zOTg0IGwgMjEuMDAzOSwyNi4yMjI2IGMgMi4wMTE4LDIuNTE5NiAxLjYxMzMsNi4xOTkzIC0wLjkxMDEsOC4yMTEgLTEuMDgyLDAuODcxMSAtMi4zNTk0LDEuMjgxMiAtMy42NDg0LDEuMjgxMiAtMS43MTEsMCAtMy40MTAyLC0wLjc0MjIgLTQuNTYyNSwtMi4xODc1IEwgMTQuNjY4LDU0LjkyNTggYyAtMS40MDYzLC0xLjc1NzggLTEuNjc5NywtNC4xNjAyIC0wLjcwMzIsLTYuMTc5NyAwLjk2NDksLTIuMDMxMyAzLjAxNTcsLTMuMzEyNSA1LjI2MTgsLTMuMzEyNSBIIDIyOS40MjYgbCAtNC42OCwtMzkuNTg5ODUgYyAwLC0yLjMzMjAzIDEuMzg3LC00LjQ0MTQxIDMuNTM1LC01LjM3MTA5NCAyLjE0OSwtMC45MTc5NjkgNC42MjksLTAuNDY4NzQ5NzUgNi4zMjEsMS4xMjUwMDQgbCA4Ny4wNyw3Ny44NzExNCBjIDAuMDA4LDAuMDE5NSAwLjAwOCwwLjAzOSAwLjAyNywwLjA0NjggMC4xMTcsMC4xMTcyIDAuMjc0LDAuMTU2MyAwLjM5MSwwLjI4NTIgMi4yMTksMi4zMzIgMi4xMDksNi4wMzUxIC0wLjIzNSw4LjI1IGwgLTg3LjA1OCw3Ny44NzEyIiBzdHlsZT0iZmlsbDojMTEwYjA5O2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpub256ZXJvO3N0cm9rZTpub25lIiBpZD0icGF0aDEyIi8+CiAgICAgIDxwYXRoIGQ9Ik0gNTIwLjk5NiwxMDUuMDk0IEggNDA0LjE2IGwgMTE4LjgyOCwxNDEuNTIzIGMgMiwyLjM0NCAzLjAwOCw0LjM0NCAzLjAwOCw3LjAyIHYgMC4zMjQgYyAwLDMuMzQgLTMuNjYsNi42OCAtNy42NzYsNi42OCBIIDM5MC40NjkgYyAtMy45OTIsMCAtNy4zMzIsLTMuMzQgLTcuMzMyLC03LjM0NCAwLC00LjAwNCAzLjM0LC03LjM0NCA3LjMzMiwtNy4zNDQgSCA1MDIuNjM3IEwgMzgzLjgwMSwxMDQuNDMgYyAtMi4wMDQsLTIuMzQ0IC0zLjAwOCwtNC4zNDggLTMuMDA4LC03LjAxMiB2IC0wLjMzMjEgYyAwLC0zLjMzOTggMy42OCwtNi42Nzk2IDcuNjg0LC02LjY3OTYgaCAxMzIuNTE5IGMgMy45OTIsMCA3LjMzMiwzLjMzOTggNy4zMzIsNy4zNDM3IDAsNC4wMDQgLTMuMzQsNy4zNDQgLTcuMzMyLDcuMzQ0IiBzdHlsZT0iZmlsbDojMTEwYjA5O2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpub256ZXJvO3N0cm9rZTpub25lIiBpZD0icGF0aDE0Ii8+CiAgICAgIDxwYXRoIGQ9Im0gNTY2Ljk4LDE4My41MzEgYyAzLjAwOCwzNy43MjMgMjkuMDQzLDY2LjA5NCA2Mi43NjYsNjYuMDk0IDM5LjA0MywwIDU4LjczOCwtMzEuNzExIDYxLjA4MiwtNjYuMDk0IHogbSA2My40Myw4MS4xMTQgYyAtNDYuMDYyLDAgLTgwLjc4MSwtMzkuMzg3IC04MC43ODEsLTg4Ljc5IHYgLTAuNjY0IGMgMCwtNTMuMDc4IDM4LjcyMywtODguNzg4NyA4My40NTcsLTg4Ljc4ODcgMzAuNzAzLDAgNDkuNzI3LDExLjAxNTcgNjYuNDE4LDI3LjcwMjcgMiwyLjAwNCAyLjY3Niw0LjAwNCAyLjY3Niw1LjY3NiAwLDQuMzM2IC0zLjY4NCw3LjY3NiAtOC4wMiw3LjY3NiAtMi4zMzYsMCAtNC4wMDQsLTAuOTk2IC01LjM0NCwtMi4zMzYgLTEzLjY3OSwtMTMuMzQ4IC0zMC43MDMsLTIzLjM2NyAtNTUuMDY2LC0yMy4zNjcgLTMzLjM3OSwwIC02My43NjIsMjQuNzA3IC02Ni43Nyw2Ny4wOSBoIDEzMy41MjggYyA0LjAwNCwwIDguMDA4LDMuNjcyIDguMDA4LDcuNjgzIDAsNDguNzMxIC0zMC4zNzEsODguMTE4IC03OC4xMDYsODguMTE4IiBzdHlsZT0iZmlsbDojMTEwYjA5O2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpub256ZXJvO3N0cm9rZTpub25lIiBpZD0icGF0aDE2Ii8+CiAgICAgIDxwYXRoIGQ9Im0gNzYxLjkyNiwxODMuNTMxIGMgMy4wMDgsMzcuNzIzIDI5LjA0Myw2Ni4wOTQgNjIuNzYyLDY2LjA5NCAzOS4wNDIsMCA1OC43NDIsLTMxLjcxMSA2MS4wODIsLTY2LjA5NCB6IG0gNjMuNDI2LDgxLjExNCBjIC00Ni4wNjcsMCAtODAuNzgyLC0zOS4zODcgLTgwLjc4MiwtODguNzkgdiAtMC42NjQgYyAwLC01My4wNzggMzguNzExLC04OC43ODg3IDgzLjQ1LC04OC43ODg3IDMwLjcwMywwIDQ5LjczNCwxMS4wMTU3IDY2LjQyMSwyNy43MDI3IDIuMDA0LDIuMDA0IDIuNjc2LDQuMDA0IDIuNjc2LDUuNjc2IDAsNC4zMzYgLTMuNjc5LDcuNjc2IC04LjAxNSw3LjY3NiAtMi4zMzIsMCAtNC4wMDQsLTAuOTk2IC01LjM0LC0yLjMzNiAtMTMuNjg0LC0xMy4zNDggLTMwLjcwMywtMjMuMzY3IC01NS4wNzgsLTIzLjM2NyAtMzMuMzcxLDAgLTYzLjc1LDI0LjcwNyAtNjYuNzU4LDY3LjA5IGggMTMzLjUyMyBjIDQuMDA0LDAgNy45OTYsMy42NzIgNy45OTYsNy42ODMgMCw0OC43MzEgLTMwLjM3MSw4OC4xMTggLTc4LjA5Myw4OC4xMTgiIHN0eWxlPSJmaWxsOiMxMTBiMDk7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOm5vbnplcm87c3Ryb2tlOm5vbmUiIGlkPSJwYXRoMTgiLz4KICAgICAgPHBhdGggZD0ibSAxMDc3LjY3LDEwMi43NTggLTY2Ljc2LDgyLjQ0MSA2Mi40MSw2My40MyBjIDIsMiAyLjY4LDMuMzQgMi42OCw1LjY2NCAwLDQuMzQ0IC0zLjM0LDcuNjg0IC03LjY4LDcuNjg0IC0yLjM0LDAgLTQuMDEsLTAuNjcyIC01LjY4LC0yLjMzMiBMIDk1OC4xNjQsMTUxLjQ4OCB2IDE0OS4zMTcgYyAwLDQuNjc5IC0zLjY3Miw4LjM1MSAtOC4zNCw4LjM1MSAtNC42NzksMCAtOC4wMTUsLTMuNjcyIC04LjAxNSwtOC4zNTEgViA5Ny40MTggYyAwLC01LjAxMTcgMy42NzEsLTguMzUxNiA4LjM0NywtOC4zNTE2IDQuNjY4LDAgOC4wMDgsMy4zMzk5IDguMDA4LDguMzUxNiB2IDM0LjM3NSBsIDQxLjM4Nyw0MS43MjcgNjUuNDI5LC04MC43ODE3IGMgMi4zMywtMi42NjQxIDQsLTMuNjcxOSA3LjAxLC0zLjY3MTkgNC42NywwIDguMDEsMy4wMDc4IDguMDEsNy42ODc1IDAsMi4zMzIgLTAuNjYsNC4wMDQxIC0yLjMzLDYuMDA0MSIgc3R5bGU9ImZpbGw6IzExMGIwOTtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6bm9uZSIgaWQ9InBhdGgyMCIvPgogICAgPC9nPgogIDwvZz4KPC9zdmc+"></image></symbol>eyJ2ZXJzaW9uIjoiMSIsImVuY29kaW5nIjoiYnN0cmluZyIsImNvbXByZXNzZWQiOnRydWUsImVuY29kZWQiOiJ4nL1Z23bqSJJ9r684y/NY3ad0XHUwMDA1VPOEXHUwMDExxjpNXG5jwLaY1Vx1MDAwZpLAsiRuy1x1MDAxMujSU58y3zD/1F/SO1wiJcCuU7Vq1poun+WDlcpLROTeO1wik3/88OXLTV5cdTAwMWTWNz9/uVmXob+JV+9+cfNcdTAwMTdqP63fs3i/wyuNn7P98T3knm95fsh+/ukn/3D4elx1MDAxOfU13G/lyPVmvV3v8lxmff9cdTAwMGLPX778g//Hm3hF41x1MDAwM7+8N6cv/frhr7fdcDp9UHrpI1x1MDAwZuVOrUH5uswvrSWa/qp3XGbl3FJRi9a5NFx1MDAxNPEqf0OjYfQujW/rOHrLyVx1MDAwYsv82lV6WlfXzJ6hd61zXHUwMDE3f1x1MDAxN21oxcugLH/fp+vBfrN/J0v+Q+GfizGBXHUwMDFmptH7/rhbXfr45qr3+nrp81x1MDAxYW82s7zayJD54dvxfX3zaYXnxmLtU/t5XFy2R3Avo7Bk9LZbZ1x1MDAxNFr13Lo/+GGcUzhU5eJcdTAwMDPZd3BWvFx1MDAwYn+/WPXub9dcdTAwMGVtw+642VxcT7xbNVx1MDAxM394ka3X1Fk3urqldM/NV+DQ1M+t7n7HQFF7itLrdvTepUec2UBHznO++ptsfVx0KVkwvCDng1x1MDAxNcfDypeD1E7PUoyu1rWsnnF+v4l36ecxm32YfmdcdTAwMWRGXHUwMDE1XCL7z//53y/HXHUwMDAzwr32t1/+W77E52pf7GTj1U7ud/ksrsklzeh8NTTd7KiK0etYPe1Dpzt/XHUwMDFib2hcdTAwMWb0XHUwMDBmy/U3cUShulx04dv6/eY6XnlcZv6cO+T7wzXIsjVcdTAwMWPjZfXeV+X6p3PuXHUwMDE1Yl1cdTAwMWa93n+9qfv3OIp3/mb+f3eZ1r1vmaN+1a428I5cdTAwMTDk4rdcci2/+uUvXHUwMDFmmd6SON760frmO7jpdIzfxI2uaabVMXTzXHUwMDBm4EZKSrHaO6l1eFxc9V/uulx1MDAwZnZiXHUwMDFllHjxXHUwMDFiXFz8xKmPTFT/XHJM/LW+sJipve6FUFLMjN+UoPzd32VcdTAwMDf/XHUwMDFkXGL6fVx1MDAxOXp99S3jytBWXHUwMDE0Le07mqgrylete/3zmfhaT9H0jq5f1PL/R1c+0/1qql+T3bJcZs28xuZcdTAwMWYle5b7+THj7fNP69VcdTAwMDdASGtvzF5Hf1XCIPBfe72w01EsXdNXr1i0s1JeVdWwumtLXHJU7VX3XHUwMDAz0N5cbo3u2njtdFbd4FXr4r2x0sJud919XHJcdTAwMDNdeVxyNKWnr8OVXHUwMDFlvKqK2u1dXHUwMDAxXHJMX59zXCL9nIGDP5u//i7ZhP85IDfIsTM4QeMkt25O8bq4/e7G08/NXHUwMDBmXHJcdTAwMTfZxewy7N/u589cdTAwMTfyb+Pten4tXHUwMDAwP2Wn6Mdyu7n5RNs/L/iAlL94XHUwMDFj06L0589cdTAwMWbM+k+SWujRw72rLatbI3guj2F9OFx1MDAwNNu89rS7YjlXYv/+UVx07f1prK/0VWVe3s3MU7hcck/B9i5fvriF9+xuwsq6eu9E65GaXHUwMDA1O9FcdDUr9V9uT8tRajnbN2V13++MK6tcdTAwMGW0x0M4wruZWVx1MDAwN/pT5WlP20D/tsPcx+XL9PR49zhcdTAwMWPrLsZtXG7qO573j8v7x9SJW1t/ZZ8uKmmXSPqFXHUwMDE4WPVqXHUwMDFixs79W1x1MDAxZYzMerKDn394zHJcdTAwMTPu3EOgXHUwMDE5lpNcZo9cdTAwMDL++M9Ty+E5XHUwMDFjvF9cdTAwMWRgy/5h5pSuPY2d0dvGf17tV7ZcdTAwMTK7dnhcdTAwMTTzvuYmnlx1MDAwZVs1//lJn24tXHUwMDAzfVx1MDAwYsfuR2I+VVx1MDAxY3uqj5NhgT6aWznRVYw6y5GVcFxcXHUwMDEx//X2aeOrVlx1MDAxY4zuXHUwMDEyfO5cdTAwMTGfw3prXHUwMDFkV6O7bLx9KsLK+XFcdTAwMTD3o4fR42a5XHUwMDEz0sYt/605cU++u7/EcLI134Lnp3S13WxW1e1hXHR7ea3nR7bTXHUwMDFkwJbR3W757J6CkVXB5mS5lf/gS4z10+XLtyTQylOYKLFTI2Y2xc2JvK1VLUdPVaDfvnnaRlnDfjEwKpdjZ76HmvtcdTAwMTaOXHUwMDE2wMPbaYU+S+2p9kd3aaCHiDFiOtpcdTAwMWN9XHUwMDFkXHUwMDExebndTHb8/lx1MDAxNJLfL48mxW6c9L/XJ/FH+NWAn631XHUwMDE2buH/536IR6jlXHUwMDE3m7VpubTvUuzp6SHaR45d7tA/fZh9201cdTAwMDZcdTAwMWZtXerfTquX21x1MDAxY7Hb4H3mvWw2QMeHPtibePlcXCDuWFO1Nuv7x9fnuzePflx1MDAxMTMl3N5cdTAwMWRDbVx0jCnoo76t7rGHg6hcdTAwMWMnom7+ZWJQXHUwMDE044HyuU1xK6NcdTAwMTQ2MJKEXHUwMDA3JzH+5lxm+lx1MDAxZuxcdTAwMDXOgMXHyns26yXiXHUwMDFmIOZkVzBa7Fx1MDAxMfvybzOJj2ZcXOG9PO6dXHUwMDExYUSJRFwilHFcdTAwMTKablWUbrI4TuZO5YxENJ5cdTAwMGaPbpJWY5s++6UzUNBvaLiDosJcdTAwMWWoYtbP3dioRVx1MDAxMmViXHUwMDA2+5JcdTAwMDXGOMD8tIRcdTAwMGbYp7TGmHqcLKrJoMhFZVx1MDAxNFwiXHTRR1x1MDAxY925Y6CPXG4/NVHdZuBcdTAwMDHW8KitnlxmXGbTnU9pfbxcdTAwMGY1MStKmsNcdTAwMWTcJlx1MDAwZc87XHUwMDA0lopC/u3U9Dfs0dy4n8PXXHUwMDFhcyNmXHUwMDA2cSqaXHL6ZNfRtUVcdTAwMTRcZvom7NTFfJghXuDdXCLyqj75oo9th/qAj/icXHUwMDBic2wjXHUwMDBl9jRcIr8m8zSDTTrNQTHBnmjUf2KneJ5cdTAwMWVcdTAwMTE/Y0z211NccjZh3mkl4oJiqrjxrePYw1JcXGyvXHUwMDEx59Z21aW4kK31MFwiXVx1MDAxM3VqyNj19clcZnFcdTAwMTkoXHUwMDE1bKjxXkV71cQrkXF1amEv4Cv2YWZcdTAwMTii9jKKP/bKdDi2Ue3GXHUwMDA1v0Ps2lx1MDAxOCuIZy7qIeyHLsFeXHUwMDExXHUwMDFiwFx1MDAxNfbM9mCzozt2WPE+14vMTVx1MDAwNPpccjXoXHUwMDE1xobqhPCZePBcdTAwMDFrXHUwMDBlMK5OddozQWvUXHUwMDFjT8Iv2VZcdI6tV7q1XHUwMDAzu2Q8pZ2pKfc+UpxRXHUwMDA0/PXRP7r2XHUwMDE3Wlx1MDAxMpEvXHUwMDFh+SixXGJcXNlDU8ZgUVxu2uuZoVx0O0U/XHUwMDBmmEsrsnFcdTAwMDK9RVx1MDAxZlx1MDAwM+Ncblx1MDAxN3tPcXRnXHUwMDFjY4NiXGZfazehubGPSWQ6NrCYTFXJOceYzGhMWFxuwlx1MDAxN72zMVx1MDAxZvlcdTAwMGXf4K/qzoH1mDDhXHUwMDExnoBr2EBtNTBWXHUwMDBmXHUwMDE1slx1MDAxNXYp4CpxQkd/etY4luChm8CGgcSgS/NcZlx1MDAxOLOmW4c0L/gxZX5cYlx1MDAxYvzA+tinWu6lXHUwMDAzTS5cdTAwMTAnUWL/gamU9kqbzFx1MDAxN2RcdTAwMDf+hjbYwHWdXHUwMDAyv6ncXHUwMDA3YFx1MDAxNFitXHUwMDFjqSdcdTAwMDb2j2xQ0K/lYI05iYM6cZn8cu1IXHUwMDFkc1x1MDAxY4eG5LvH8Vx1MDAxMjQuiVwijnXtXHUwMDE4wHfecn4+YFx1MDAwZSEmi1x1MDAxYWtcIo9ij+1FNKX9l8/6ZI64xEXl1li3XHUwMDBla3BcdTAwMDJrRFx1MDAwNXJkXHUwMDA2TYBfoSr3K9Jo/mZcdTAwMWN84vjpwlx1MDAwZVx1MDAwYlE141x0340muXOvXHUwMDE5PzUkpzzSXHUwMDA29Fx1MDAxYpJcdTAwMGU1bVx1MDAwYrZNUHtcdTAwMTJiT6cqr287ikigXHUwMDE1iacyzoZFNLEjtEdcdTAwMWFp4YTyd70wmz1FrKGFXHUwMDFjS69AvEhcdTAwMGLhV5hJbFx1MDAwMlx1MDAxZlJcdTAwMGJL2Yc0iuIyVCbMUcNcdTAwMTSEhcpQMWfFe4s9ZozNhYrYsFx1MDAxNjJPZdx1xlpccntgO+yl9zVixtilfWK7kFeFLTLWXHUwMDBlu69cdTAwMTNcdTAwMDcwppZcdTAwMWEyLF3CQbIwSFx1MDAwNyhcdTAwMGaIeVx1MDAxOPmDvlx1MDAwMTtK4iOwk09ovrpPPEaOQXxmrC+si3iWmmI7pmxbKKKenvkseYRYMOdCaHefc1x1MDAxN69cdTAwMTdcdTAwMWJcdTAwMDbmJt5UwGVGWslcdTAwMWFJa9hcdTAwMGXFstXIPfwrWFx1MDAxYoBNxi7p34A42Kd9NFx0k/DT5GdwQT5Pdefei1x1MDAxYd9ccmdUQEvIXHUwMDE3R5N63uc8XHUwMDA2X7E+6yRpXHUwMDBlxVrqUnV+Zi2aXFxiT9xjLKJPq4+kM1xy58hvqZHAZN5qpCu53PQlvVx1MDAxNNqk5WZVfNRI2n9oJOkozVx1MDAwZruzVlx1MDAxYlvtnsxcbvlcdD4jj9F42n+l9Vx1MDAxMz5Tn1xuuKswl8a+koaAu+z/fGhcIidcdTAwMTJeS6ojWG/mnJMpN2Ovh5TXKvSX+2hHXHUwMDE1c98m/WO7kEuhMzZrpdRcXMnJj21tTlx1MDAxZPB7XHUwMDA1ubWS+Fx1MDAwYolfnCPB04p1mGywQ5W4JuZNzrdcdTAwMTeIUVqRVnpcdTAwMTXPR/pZS1x1MDAxZUFcdTAwMTfqqKlFuEbJpY72K+lcdTAwMDd0gfNcdTAwMGLlXHUwMDAwek/YSWFj2vCS9JLyXHUwMDBiaVx1MDAwNWGZNZW4SZxn7b60ka461YTWT1jfOcdx7cK6XHUwMDFhmeBym+MqrtGQu0hLwDld4nmqUP3T8rqpcVx1MDAxMJ++6Vx1MDAwZVx1MDAxYT2Q+chke5OU+IH9TyVmbFx1MDAwZlx1MDAxOJmanG9YT4ZtbYWcyHw1UFx1MDAwYlx1MDAxNoiDjk/KaSXXRbbkgORcdTAwMDX2fcZcdTAwMWMqZL4mnPBzRbVcdTAwMDc+WctcdTAwMWI9yJrPSnIrVHiO+Vx1MDAwMnVcdTAwMDaNXHUwMDExpuD6yjGQL1xiX8BLSrlcbrUpP5eUg13CXb0or2oyysEqYXU8R2xQL8KW1uZcbvVwvbrfZHS2WW43WWDvXHUwMDEzYKjwoO1cdTAwMTNteVxiRkV+OT/sy7Yt3D1hzOFcdTAwMThoZlx1MDAwN+eP00R3UVdb703bXHUwMDA28/JZXHUwMDA251x1MDAwNcW3aZ3e9+veVIngXHUwMDBmYVx1MDAwNVx1MDAxYyngw1x1MDAwMnFLXHUwMDE1Z1x1MDAxOEXQXHLSdo15RlxcSlwiql+RXHUwMDFih5wzJc9IQ4SCPa2bOCufnsnnivSJalLK62fe1zLHXHUwMDAz+1x1MDAxNDfSiNwlXtXtM+FcdTAwMTBx55ybSk5Uhjnhupb71lx1MDAxMvPtXFwh5/kx155sQyGx2C+kPUK5eqczbqkuxDzIhaQtqiC9XHUwMDAwTpmXlD+SqKC6W1DNiLrXkzpFXHUwMDE4lLyqcXblOo99JZ7UlKtl7dI35HqovXHulZggrlxmr+pDzmWkzcwv8lx1MDAxYrWkzFxy0GL00ShcdTAwMDdSneVTXHJfSz1r9LyNRevLeb42NtI3QfmQalx1MDAxZeZOXHUwMDEzr6z1+1x1MDAxYzfO8/Dnz8Gk8puY3Fx1MDAxMiY9+I0zgE25hWpcdTAwMDWOWVx1MDAxYmfU3dDaXHUwMDA0MUhSyn+ot6g/a4uG/dFcdTAwMTlTiSexXGZcZlx1MDAxMddcdTAwMDWdN+xFk59l7U+64dhcdTAwMWXVx1xcy53H3O+jYIa5SMerwmDtmTN2c2hcdTAwMTP6eJQjiNOkvYY8S6Ssf9hng2pb5EJgJKL1zDY/07lD1itYizFcdTAwMTJS7UN9KsqhVHdB56FtXFybKFKreVx1MDAwZVx1MDAwM/lcdTAwMDKYpFx1MDAxYVx1MDAxY3HA2tB2yvGoXHUwMDAxhmWj61x1MDAxMdlcdTAwMGZ+ct3IOVx1MDAwMedMyVHmQMX1XHUwMDE0n8k+PKvyk3g55XOdxLRHZ1xcvXmXT1xiP/HlWWqfJ7k4aDlBNXOqydxNPCvafpS7asYyxUpikOrSms9cdTAwMDFcXLs5Ndd+XHUwMDE04znpkEdnXHUwMDE4xIXOKnxepvc0ns6NtDfYZ6pbp1xct1GbS3tfXHUwMDE1XHUwMDFh5Vx1MDAwNpyjqJ6qXHUwMDE5P1x059TGb8JB1ORcdNJcdTAwMWbS/PaZeVczX3gvRNnYSGfPjPZHyDNcdTAwMDHqMr6LuLT9ObzRfpc3NWFcdTAwMTk1REx1O+festFcbj5LijokzMA/p+VcdTAwMDTFrKBaXHUwMDBlscQ7wvWZS8iXyLE2a4wqz/6st83ZXHUwMDEw/MD7XHS3tWNuO85cYnYkdGak+pPudZrcXGYtprXo/EWYmfB5Mqr4roNqOju88CluuZBGq/hcXE+2uqmSP1RcdTAwMGbRuYA4THX3hDlcdTAwMDf+2aTbfJa9alx1MDAxM7JGYlxyQFx1MDAxZFxyXHJcdTAwMDBcdTAwMGVKPmPPXHUwMDE3eE/2Tys+XHUwMDFikbbYdP6nulx0mGk++U4kXHQ15siH51x1MDAwNX82XHUwMDFh22CdcWVKPIXEXHUwMDA3gzk6+8xcdTAwMWbnd/nT1lfcn+fknFAyJ2Seaf3KoYfgXHUwMDE032Wo7ozj84FT4DXeh6XULY/PmvCNzlx1MDAxZVx1MDAwNXOOtKOGPtpcdTAwMWXlLJPvJJhzi4rvWlx1MDAxYb9Zezj3gPucr53zM+Vv4I70TaHYXHUwMDBivs8hXHUwMDFi6WxdXHUwMDE4zJk52Vx1MDAxZFI8TNLWpi127l1l/Vxc0r3i1n8us0mMmnV+XHUwMDFiQ4+7zKeBer7/nCTDtq1aYcxka56C3WFcdTAwMTNue91Qf6xcdTAwMDItl23bRdzcXHIyT2idcd3cXHUwMDFiXHUwMDBl6C749m1cdTAwMDU/+d531qdzXHUwMDFm71x1MDAwZjS14DzCtlx1MDAxMjZon4FVqmtnnGPo/qjJXHUwMDBmXHUwMDE0XHUwMDFi7GPMemq0tY3gXHUwMDFhhrVV41qEtbWtXHUwMDE3sLdNjpd3ZZ5x9Vxcyfd9ea/GeaQvdYpxwfeDsu6Ob4Vjp8TNks5bwHJJd1x1MDAwMKidgEeqsYEx5Fx1MDAwNVlzTVx1MDAxOZONtuM8R7Wp4PvLXHTp2+Dy3NxpSZ5cdTAwMGWYI1mD6epcbstyXHUwMDFjzk1PMbjPZ57ozFGue7C2xFxi50K6RyiBZYNzQ3VcdTAwMWWvne894TOvR1rFNVxmzoFnbW7Hk290Vyt0d8b3efJepypcdTAwMTQ+gyWUXHUwMDA3XHUwMDE3fFZcdTAwMWZfcrHenFx1MDAwYmvmSnPX5zDn2K9cdTAwMTJnXHUwMDAzrtXGbXzm8kzC95RswzCTOko5Wz5LvONcdTAwMWNcdTAwMDfut2eBJs+39VbZ7CfVKMxcdTAwMWb67lx1MDAwNFx1MDAxODWD0Vx1MDAwMprNOaDjQMPEyIFcdTAwMGXnjP3xs0XfIVx1MDAxZFb3aUe0bS/f1IDu17fWcb19qoI6R775dvI12bY8fyfDmK7EoLnPJ5xcdTAwMGasnbzbL05L4P9Bfq/z4+WrsfB9ffm+tddRu6apmWrn/EXkLz/88i9cdFx1MDAxMVW6In0=<defs><style>@font-face{font-family:&quot;Virgil&quot;;src:url(https://excalidraw.com/Virgil.woff2)}@font-face{font-family:&quot;Cascadia&quot;;src:url(https://excalidraw.com/Cascadia.woff2)}</style></defs><text x="2240" dominant-baseline="text-before-edge" font-family="Cascadia, Segoe UI Emoji" font-size="246.424" style="white-space:pre" text-anchor="middle" transform="translate(10 10)">❯ upstream |       | downstream</text><use width="920" height="300" href="#image-5863f0cbbaf88c6609323df7296d0f11497e91b12f3ab6109c47e4f66d7bf271494d2c77e7fcb30fb2083ecd3bf10178" transform="translate(1773 30)"></use></svg></figure><p></p><p>Zeek requires a bit of adaptation to fit in the Unix pipeline model, by which we
mean <em>take your input on stdin and produce your output to stdout</em>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;upstream&gt; | zeek | &lt;downstream&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In this example, <code>&lt;upstream&gt;</code> produces packets in PCAP format and <code>&lt;downstream&gt;</code>
processes the Zeek logs. Let&#x27;s work towards this.</p><p>Solving the upstream part is easy: just use <code>zeek -r -</code> to read from stdin. So
let&#x27;s focus on the logs downstream. <a href="/blog/mobilizing-zeek-logs">Our last blog</a>
introduced the various logging formats, such as tab-separated values (TSV),
JSON, and Streaming JSON with an extra <code>_path</code> discriminator field. The only
format conducive to multiplexing different log types is Streaming JSON.</p><p>Let&#x27;s see what we get:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">zcat </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> trace.pcap </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> zeek -r - json-streaming-logs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">❯ ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">json_streaming_analyzer.1.log       json_streaming_packet_filter.1.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">json_streaming_conn.1.log           json_streaming_pe.1.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">json_streaming_dce_rpc.1.log        json_streaming_reporter.1.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">json_streaming_dhcp.1.log           json_streaming_sip.1.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">json_streaming_dns.1.log            json_streaming_smb_files.1.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">json_streaming_dpd.1.log            json_streaming_smb_mapping.1.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">json_streaming_files.1.log          json_streaming_snmp.1.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">json_streaming_http.1.log           json_streaming_ssl.1.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">json_streaming_kerberos.1.log       json_streaming_tunnel.1.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">json_streaming_ntlm.1.log           json_streaming_weird.1.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">json_streaming_ntp.1.log            json_streaming_x509.1.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">json_streaming_ocsp.1.log</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>json-streaming-package</code> prepends a distinguishing prefix to the filename.
The <code>*.N.log</code> suffix counts the rotations, e.g., <code>*.1.log</code> means the logs from
the first batch.</p><p>Let&#x27;s try to avoid the files altogether and send the contents of these file to
stdout. This requires a bit of option fiddling to achieve the desired result:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">zcat </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> trace.pcap </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  zeek -r - </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LogAscii::output_to_stdout</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">T </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    JSONStreaming::disable_default_logs</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">T </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    JSONStreaming::enable_log_rotation</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">F </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    json-streaming-logs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This requires a bit explanation:</p><ul><li><code>LogAscii::output_to_stdout=T</code> redirects the log output to stdout.</li><li><code>JSONStreaming::disable_default_logs=T</code> disables the default TSV logs.
Without this option, Zeek will print <em>both</em> TSV and NDJSON to stdout.</li><li><code>JSONStreaming::enable_log_rotation=F</code> disables log rotation. This is needed
because the option <code>output_to_stdout=T</code> sets the internal filenames to
<code>/dev/stdout</code>, which Zeek then tries to rotate away. Better not.</li></ul><p>Here&#x27;s the result you&#x27;d expect, which is basically a <code>cat *.log</code>:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;_path&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;files&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;_write_ts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;2021-11-17T13:32:43.250616Z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;ts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;2021-11-17T13:32:43.250616Z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;fuid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;FhEFqzHx1hVpkhWci&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;uid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;CHhfpE1dTbPgBTR24&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;id.orig_h&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;128.14.134.170&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;id.orig_p&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">57468</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;id.resp_h&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;198.71.247.91&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;id.resp_p&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">80</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;source&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;HTTP&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;depth&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;analyzers&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;mime_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;text/html&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;duration&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;is_orig&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;seen_bytes&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">51</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;total_bytes&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">51</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;missing_bytes&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;overflow_bytes&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;timedout&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;_path&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;http&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;_write_ts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;2021-11-17T13:32:43.250616Z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;ts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;2021-11-17T13:32:43.249475Z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;uid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;CHhfpE1dTbPgBTR24&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;id.orig_h&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;128.14.134.170&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;id.orig_p&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">57468</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;id.resp_h&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;198.71.247.91&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;id.resp_p&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">80</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;trans_depth&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;method&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;GET&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;host&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;198.71.247.91&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;uri&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;/&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;version&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;1.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;user_agent&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36 &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;request_body_len&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;response_body_len&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">51</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;status_code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">200</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;status_msg&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;OK&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;tags&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;resp_fuids&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;FhEFqzHx1hVpkhWci&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;resp_mime_types&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;text/html&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;_path&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;packet_filter&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;_write_ts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;1970-01-01T00:00:00.000000Z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;ts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;2023-07-11T03:30:17.189787Z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;node&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;zeek&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;filter&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;ip or not ip&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;init&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;success&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;_path&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;conn&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;_write_ts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;2021-11-17T13:33:01.457108Z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;ts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;2021-11-17T13:32:46.565338Z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;uid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;CD868huwhDP636oT&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;id.orig_h&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;89.248.165.145&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;id.orig_p&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">43831</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;id.resp_h&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;198.71.247.91&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;id.resp_p&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">52806</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;proto&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;tcp&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;conn_state&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;S0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;missed_bytes&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;history&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;S&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;orig_pkts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;orig_ip_bytes&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;resp_pkts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;resp_ip_bytes&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;_path&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;tunnel&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;_write_ts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;2021-11-17T13:40:34.891453Z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;ts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;2021-11-17T13:40:34.891453Z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;uid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;CsqzCG2F8VDR4gM3a8&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;id.orig_h&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;49.213.162.198&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;id.orig_p&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;id.resp_h&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;198.71.247.91&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;id.resp_p&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;tunnel_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;Tunnel::GRE&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;action&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;Tunnel::DISCOVER&quot;</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Nobody can remember this invocation. Especially during firefighting when you
quickly need to plow through a trace to understand it. So we want to wrap this
somehow:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">zeekify</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token shebang important">#!/bin/sh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zeek -r - </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  LogAscii::output_to_stdout</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">T </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  JSONStreaming::disable_default_logs</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">T </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  JSONStreaming::enable_log_rotation</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">F </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  json-streaming-logs </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$@</span><span class="token string" style="color:#e3116c">&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now we&#x27;re in pipeline land:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">zcat pcap.gz </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> zeekify </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">head</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> jq -r ._path</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">packet_filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ntp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tunnel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">conn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ntp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">conn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ntp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">conn</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Okay, we got Zeek as a Unix pipe. But now you have to wrangle the JSON with
<code>jq</code>. Unless you&#x27;re a die-hard fan, even simple analytics, like filtering or
aggregating, have a steep learning curve. In the next blog post, we&#x27;ll double
down on the elegant principle of pipelines and show how you can take do easy
in-situ analytics with Tenzir.</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/zeek">zeek</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/logs">logs</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/json">json</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/pipelines">pipelines</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/shell-yeah-supercharging-zeek-and-suricata-with-tenzir"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Shell Yeah! Supercharging Zeek and Suricata with Tenzir</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/mobilizing-zeek-logs"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Mobilizing Zeek Logs</div></a></nav></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/">Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/api">API</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/changelog">Changelog</a></li><li class="footer__item"><a href="https://docs.google.com/presentation/d/1R59T2nuGJg43g6PVKogZbb6DjcJXRYBx3Bih8W-A-oM/present" target="_blank" rel="noopener noreferrer" class="footer__link-item">Release Notes<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/discord">Discord</a></li><li class="footer__item"><a href="https://github.com/tenzir/tenzir" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/tenzir_company" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/tenzir" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Tenzir</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://tenzir.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/newsletter">Newsletter</a></li><li class="footer__item"><a class="footer__link-item" href="/privacy-statement">Privacy Statement</a></li><li class="footer__item"><a class="footer__link-item" href="/next/tenzir-vs-cribl">Tenzir vs. Cribl</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Tenzir GmbH.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.236eca83.js"></script>
<script src="/assets/js/main.ab17497d.js"></script>
</body>
</html>